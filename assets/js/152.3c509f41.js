(window.webpackJsonp=window.webpackJsonp||[]).push([[152],{372:function(e,s,n){"use strict";n.r(s);var a=n(25),r=Object(a.a)({},(function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("p"),n("div",{staticClass:"table-of-contents"},[n("ul",[n("li",[n("a",{attrs:{href:"#å‚è€ƒå’Œå‡†åˆ™-ğŸ”—-reference-and-guidelines"}},[e._v("å‚è€ƒå’Œå‡†åˆ™ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#æ’°å†™å’Œdockerå…¼å®¹æ€§çŸ©é˜µ-ğŸ”—-compose-and-docker-compatibility-matrix"}},[e._v("æ’°å†™å’ŒDockerå…¼å®¹æ€§çŸ©é˜µ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#æ’°å†™æ–‡ä»¶ç»“æ„å’Œç¤ºä¾‹-ğŸ”—-compose-file-structure-and-examples"}},[e._v("æ’°å†™æ–‡ä»¶ç»“æ„å’Œç¤ºä¾‹ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#æœåŠ¡é…ç½®å‚è€ƒ-ğŸ”—-service-configuration-reference"}},[e._v("æœåŠ¡é…ç½®å‚è€ƒ ğŸ”—")]),n("ul",[n("li",[n("a",{attrs:{href:"#å»ºç«‹-ğŸ”—-build"}},[e._v("å»ºç«‹ ğŸ”—")]),n("ul",[n("li",[n("a",{attrs:{href:"#è¯­å¢ƒ"}},[e._v("è¯­å¢ƒ")])]),n("li",[n("a",{attrs:{href:"#dockeræ–‡ä»¶"}},[e._v("dockeræ–‡ä»¶")])]),n("li",[n("a",{attrs:{href:"#args"}},[e._v("args")])]),n("li",[n("a",{attrs:{href:"#cache-from"}},[e._v("cache_from")])]),n("li",[n("a",{attrs:{href:"#æ ‡ç­¾"}},[e._v("æ ‡ç­¾")])]),n("li",[n("a",{attrs:{href:"#ç½‘ç»œ"}},[e._v("ç½‘ç»œ")])]),n("li",[n("a",{attrs:{href:"#shm-size"}},[e._v("shm_size")])]),n("li",[n("a",{attrs:{href:"#ç›®æ ‡"}},[e._v("ç›®æ ‡")])])])]),n("li",[n("a",{attrs:{href:"#cap-addï¼Œ-cap-dropğŸ”—-cap-add-cap-drop"}},[e._v("cap_addï¼Œ cap_dropğŸ”—")])]),n("li",[n("a",{attrs:{href:"#cgroup-parent-ğŸ”—-cgroup-parent"}},[e._v("cgroup_parent ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#å‘½ä»¤-ğŸ”—-command"}},[e._v("å‘½ä»¤ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#é…ç½®-ğŸ”—-configs"}},[e._v("é…ç½® ğŸ”—")]),n("ul",[n("li",[n("a",{attrs:{href:"#çŸ­è¯­æ³•"}},[e._v("çŸ­è¯­æ³•")])]),n("li",[n("a",{attrs:{href:"#é•¿è¯­æ³•"}},[e._v("é•¿è¯­æ³•")])])])]),n("li",[n("a",{attrs:{href:"#container-name-ğŸ”—-container-name"}},[e._v("CONTAINER_NAME ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#credential-spec-ğŸ”—-credential-spec"}},[e._v("credential_spec ğŸ”—")]),n("ul",[n("li",[n("a",{attrs:{href:"#gmsaé…ç½®ç¤ºä¾‹"}},[e._v("gMSAé…ç½®ç¤ºä¾‹")])])])]),n("li",[n("a",{attrs:{href:"#å–å†³äº-ğŸ”—-depends-on"}},[e._v("å–å†³äº _ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#éƒ¨ç½²-ğŸ”—-deploy"}},[e._v("éƒ¨ç½² ğŸ”—")]),n("ul",[n("li",[n("a",{attrs:{href:"#ç«¯ç‚¹æ¨¡å¼"}},[e._v("ç«¯ç‚¹æ¨¡å¼")])]),n("li",[n("a",{attrs:{href:"#æ ‡ç­¾"}},[e._v("æ ‡ç­¾")])]),n("li",[n("a",{attrs:{href:"#æ¨¡å¼"}},[e._v("æ¨¡å¼")])]),n("li",[n("a",{attrs:{href:"#æ”¾ç½®"}},[e._v("æ”¾ç½®")])]),n("li",[n("a",{attrs:{href:"#max-replicas-per-node"}},[e._v("max_replicas_per_node")])]),n("li",[n("a",{attrs:{href:"#å¤åˆ¶å“"}},[e._v("å¤åˆ¶å“")])]),n("li",[n("a",{attrs:{href:"#èµ„æº"}},[e._v("èµ„æº")])]),n("li",[n("a",{attrs:{href:"#restart-policy"}},[e._v("restart_policy")])]),n("li",[n("a",{attrs:{href:"#rollback-config"}},[e._v("rollback_config")])]),n("li",[n("a",{attrs:{href:"#update-config"}},[e._v("update_config")])]),n("li",[n("a",{attrs:{href:"#ä¸æ”¯æŒ-docker-stack-deploy"}},[e._v("ä¸æ”¯æŒ docker stack deploy")])])])]),n("li",[n("a",{attrs:{href:"#è®¾å¤‡-ğŸ”—-devices"}},[e._v("è®¾å¤‡ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#dns-ğŸ”—-dns"}},[e._v("DNS ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#dns-search-ğŸ”—-dns-search"}},[e._v("dns_search ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#å…¥å£ç‚¹-ğŸ”—-entrypoint"}},[e._v("å…¥å£ç‚¹ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#env-file-ğŸ”—-env-file"}},[e._v("env_file ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#ç¯å¢ƒ-ğŸ”—-environment"}},[e._v("ç¯å¢ƒ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#æš´éœ²-ğŸ”—-expose"}},[e._v("æš´éœ² ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#external-links-ğŸ”—-external-links"}},[e._v("external_links ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#extra-hosts-ğŸ”—-extra-hosts"}},[e._v("extra_hosts ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#å¥åº·-æ£€æŸ¥ğŸ”—-healthcheck"}},[e._v("å¥åº· æ£€æŸ¥ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#å›¾ç‰‡-ğŸ”—-image"}},[e._v("å›¾ç‰‡ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#åˆå§‹åŒ–-ğŸ”—-init"}},[e._v("åˆå§‹åŒ– ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#éš”ç¦»-ğŸ”—-isolation"}},[e._v("éš”ç¦» ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#æ ‡ç­¾-ğŸ”—-labels-2"}},[e._v("æ ‡ç­¾ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#é“¾æ¥-ğŸ”—-links"}},[e._v("é“¾æ¥ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#è®°å½•-ğŸ”—-logging"}},[e._v("è®°å½• ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#network-mode-ğŸ”—-network-mode"}},[e._v("network_mode ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#ç½‘ç»œ-ğŸ”—-networks"}},[e._v("ç½‘ç»œ ğŸ”—")]),n("ul",[n("li",[n("a",{attrs:{href:"#åˆ«å"}},[e._v("åˆ«å")])]),n("li",[n("a",{attrs:{href:"#ipv4-addressï¼Œipv6-address"}},[e._v("ipv4_addressï¼Œipv6_address")])])])]),n("li",[n("a",{attrs:{href:"#pid-ğŸ”—-pid"}},[e._v("PID ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#æ¸¯å£-ğŸ”—-ports"}},[e._v("æ¸¯å£ ğŸ”—")]),n("ul",[n("li",[n("a",{attrs:{href:"#çŸ­è¯­æ³•"}},[e._v("çŸ­è¯­æ³•")])]),n("li",[n("a",{attrs:{href:"#é•¿è¯­æ³•"}},[e._v("é•¿è¯­æ³•")])])])]),n("li",[n("a",{attrs:{href:"#é‡æ–°å¯åŠ¨-ğŸ”—-restart"}},[e._v("é‡æ–°å¯åŠ¨ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#ç§˜å¯†-ğŸ”—-secrets"}},[e._v("ç§˜å¯† ğŸ”—")]),n("ul",[n("li",[n("a",{attrs:{href:"#çŸ­è¯­æ³•"}},[e._v("çŸ­è¯­æ³•")])]),n("li",[n("a",{attrs:{href:"#é•¿è¯­æ³•"}},[e._v("é•¿è¯­æ³•")])])])]),n("li",[n("a",{attrs:{href:"#security-opt-ğŸ”—-security-opt"}},[e._v("security_opt ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#stop-grace-period-ğŸ”—-stop-grace-period"}},[e._v("stop_grace_period ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#stop-signal-ğŸ”—-stop-signal"}},[e._v("stop_signal ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#çš„sysctl-ğŸ”—-sysctls"}},[e._v("çš„sysctl ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#tmpfsçš„-ğŸ”—-tmpfs"}},[e._v("tmpfsçš„ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#ulimits-ğŸ”—-ulimits"}},[e._v("ulimits ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#userns-mode-ğŸ”—-userns-mode"}},[e._v("userns_mode ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#å·-ğŸ”—-volumes"}},[e._v("å· ğŸ”—")]),n("ul",[n("li",[n("a",{attrs:{href:"#çŸ­è¯­æ³•"}},[e._v("çŸ­è¯­æ³•")])]),n("li",[n("a",{attrs:{href:"#é•¿è¯­æ³•"}},[e._v("é•¿è¯­æ³•")])]),n("li",[n("a",{attrs:{href:"#æœåŠ¡ï¼Œç¾¤é›†å’Œå †æ ˆæ–‡ä»¶çš„å·"}},[e._v("æœåŠ¡ï¼Œç¾¤é›†å’Œå †æ ˆæ–‡ä»¶çš„å·")])]),n("li",[n("a",{attrs:{href:"#å·è£…è½½çš„ç¼“å­˜é€‰é¡¹ï¼ˆé€‚ç”¨äºmacçš„dockeræ¡Œé¢ï¼‰"}},[e._v("å·è£…è½½çš„ç¼“å­˜é€‰é¡¹ï¼ˆé€‚ç”¨äºMacçš„Dockeræ¡Œé¢ï¼‰")])])])]),n("li",[n("a",{attrs:{href:"#åŸŸåï¼Œä¸»æœºåï¼Œipcï¼Œmac-addressï¼Œç‰¹æƒï¼Œread-onlyï¼Œshm-sizeï¼Œstdin-openï¼Œttyç”¨æˆ·ï¼Œworking-dir-ğŸ”—-domainname-hostname-ipc-mac-address-privileged-read-only-shm-size-stdin-open-tty-user-working-dir"}},[e._v("åŸŸåï¼Œä¸»æœºåï¼ŒIPCï¼ŒMAC_ADDRESSï¼Œç‰¹æƒï¼ŒREAD_ONLYï¼Œshm_sizeï¼Œstdin_openï¼ŒTTYç”¨æˆ·ï¼Œworking_dir ğŸ”—")])])])]),n("li",[n("a",{attrs:{href:"#æŒ‡å®šæŒç»­æ—¶é—´-ğŸ”—-specifying-durations"}},[e._v("æŒ‡å®šæŒç»­æ—¶é—´ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#æŒ‡å®šå­—èŠ‚å€¼-ğŸ”—-specifying-byte-values"}},[e._v("æŒ‡å®šå­—èŠ‚å€¼ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#å·é…ç½®å‚è€ƒ-ğŸ”—-volume-configuration-reference"}},[e._v("å·é…ç½®å‚è€ƒ ğŸ”—")]),n("ul",[n("li",[n("a",{attrs:{href:"#å¸æœº-ğŸ”—-driver"}},[e._v("å¸æœº ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#driver-opts-ğŸ”—-driver-opts"}},[e._v("driver_opts ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#å¤–éƒ¨-ğŸ”—-external"}},[e._v("å¤–éƒ¨ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#æ ‡ç­¾-ğŸ”—-labels-3"}},[e._v("æ ‡ç­¾ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#å‘½å-ğŸ”—-name"}},[e._v("å‘½å ğŸ”—")])])])]),n("li",[n("a",{attrs:{href:"#ç½‘ç»œé…ç½®å‚è€ƒ-ğŸ”—-network-configuration-reference"}},[e._v("ç½‘ç»œé…ç½®å‚è€ƒ ğŸ”—")]),n("ul",[n("li",[n("a",{attrs:{href:"#å¸æœº-ğŸ”—-driver-1"}},[e._v("å¸æœº ğŸ”—")]),n("ul",[n("li",[n("a",{attrs:{href:"#æ¡¥"}},[e._v("æ¡¥")])]),n("li",[n("a",{attrs:{href:"#è¦†ç›–"}},[e._v("è¦†ç›–")])]),n("li",[n("a",{attrs:{href:"#ä¸»æœºæˆ–æ— "}},[e._v("ä¸»æœºæˆ–æ— ")])])])]),n("li",[n("a",{attrs:{href:"#driver-opts-ğŸ”—-driver-opts-1"}},[e._v("driver_opts ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#é™„-ğŸ”—-attachable"}},[e._v("é™„ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#enable-ipv6-ğŸ”—-enable-ipv6"}},[e._v("enable_ipv6 ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#ä¼Šå¸•å§†-ğŸ”—-ipam"}},[e._v("ä¼Šå¸•å§† ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#å†…éƒ¨-ğŸ”—-internal"}},[e._v("å†…éƒ¨ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#æ ‡ç­¾-ğŸ”—-labels-4"}},[e._v("æ ‡ç­¾ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#å¤–éƒ¨-ğŸ”—-external-1"}},[e._v("å¤–éƒ¨ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#å‘½å-ğŸ”—-name-1"}},[e._v("å‘½å ğŸ”—")])])])]),n("li",[n("a",{attrs:{href:"#configsé…ç½®å‚è€ƒ-ğŸ”—-configs-configuration-reference"}},[e._v("configsé…ç½®å‚è€ƒ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#æœºå¯†é…ç½®å‚è€ƒ-ğŸ”—-secrets-configuration-reference"}},[e._v("æœºå¯†é…ç½®å‚è€ƒ ğŸ”—")]),n("ul",[n("li",[n("a",{attrs:{href:"#æ’°å†™æ–‡ä»¶v3-5åŠæ›´é«˜ç‰ˆæœ¬-ğŸ”—-compose-file-v35-and-above"}},[e._v("æ’°å†™æ–‡ä»¶v3.5åŠæ›´é«˜ç‰ˆæœ¬ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#æ’°å†™æ–‡ä»¶v3-4å’Œ-ğŸ”—ä¸‹-compose-file-v34-and-under"}},[e._v("æ’°å†™æ–‡ä»¶v3.4å’Œ ğŸ”—ä¸‹")])])])]),n("li",[n("a",{attrs:{href:"#å˜é‡æ›¿ä»£-ğŸ”—-variable-substitution"}},[e._v("å˜é‡æ›¿ä»£ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#æ‰©å±•å­—æ®µ-ğŸ”—-extension-fields"}},[e._v("æ‰©å±•å­—æ®µ ğŸ”—")])]),n("li",[n("a",{attrs:{href:"#æ’°å†™æ–‡æ¡£-ğŸ”—-compose-documentation"}},[e._v("æ’°å†™æ–‡æ¡£ ğŸ”—")])])])]),n("p"),e._v(" "),n("h2",{attrs:{id:"å‚è€ƒå’Œå‡†åˆ™-ğŸ”—"}},[e._v("å‚è€ƒå’Œå‡†åˆ™ "),n("a",{attrs:{href:"#reference-and-guidelines"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("è¿™äº›ä¸»é¢˜æè¿°äº†Composeæ–‡ä»¶æ ¼å¼çš„ç‰ˆæœ¬3ã€‚ è¿™æ˜¯æœ€æ–°ç‰ˆæœ¬ã€‚")]),e._v(" "),n("h2",{attrs:{id:"æ’°å†™å’Œdockerå…¼å®¹æ€§çŸ©é˜µ-ğŸ”—"}},[e._v("æ’°å†™å’ŒDockerå…¼å®¹æ€§çŸ©é˜µ "),n("a",{attrs:{href:"#compose-and-docker-compatibility-matrix"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æœ‰å¤šç§ç‰ˆæœ¬çš„Composeæ–‡ä»¶æ ¼å¼â€“ 1ï¼Œ2ï¼Œ2.xå’Œ3.xã€‚ ä¸‹è¡¨æ˜¯å¿«é€Ÿæµè§ˆã€‚ æœ‰å…³æ¯ä¸ªç‰ˆæœ¬åŒ…æ‹¬ä»€ä¹ˆä»¥åŠå¦‚ä½•å‡çº§çš„å®Œæ•´è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… "),n("strong",[n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å…³äºç‰ˆæœ¬å’Œå‡çº§"),n("OutboundLink")],1)]),e._v(" ã€‚")]),e._v(" "),n("p",[e._v("ä¸‹è¡¨æ˜¾ç¤ºäº†å“ªäº›Composeæ–‡ä»¶ç‰ˆæœ¬æ”¯æŒç‰¹å®šçš„Dockerç‰ˆæœ¬ã€‚")]),e._v(" "),n("table",[n("thead",[n("tr",[n("th",[n("strong",[e._v("æ’°å†™æ¡£æ¡ˆæ ¼å¼")])]),e._v(" "),n("th",[n("strong",[e._v("Docker Engineç‰ˆæœ¬")])])])]),e._v(" "),n("tbody",[n("tr",[n("td",[e._v("3.8")]),e._v(" "),n("td",[e._v("19.03.0+")])]),e._v(" "),n("tr",[n("td",[e._v("3.7")]),e._v(" "),n("td",[e._v("18.06.0+")])]),e._v(" "),n("tr",[n("td",[e._v("3.6")]),e._v(" "),n("td",[e._v("18.02.0+")])]),e._v(" "),n("tr",[n("td",[e._v("3.5")]),e._v(" "),n("td",[e._v("17.12.0+")])]),e._v(" "),n("tr",[n("td",[e._v("3.4")]),e._v(" "),n("td",[e._v("17.09.0+")])]),e._v(" "),n("tr",[n("td",[e._v("3.3")]),e._v(" "),n("td",[e._v("17.06.0+")])]),e._v(" "),n("tr",[n("td",[e._v("3.2")]),e._v(" "),n("td",[e._v("17.04.0+")])]),e._v(" "),n("tr",[n("td",[e._v("3.1")]),e._v(" "),n("td",[e._v("1.13.1+")])]),e._v(" "),n("tr",[n("td",[e._v("3.0")]),e._v(" "),n("td",[e._v("1.13.0+")])]),e._v(" "),n("tr",[n("td",[e._v("2.4")]),e._v(" "),n("td",[e._v("17.12.0+")])]),e._v(" "),n("tr",[n("td",[e._v("2.3")]),e._v(" "),n("td",[e._v("17.06.0+")])]),e._v(" "),n("tr",[n("td",[e._v("2.2")]),e._v(" "),n("td",[e._v("1.13.0+")])]),e._v(" "),n("tr",[n("td",[e._v("2.1")]),e._v(" "),n("td",[e._v("1.12.0+")])]),e._v(" "),n("tr",[n("td",[e._v("2.0")]),e._v(" "),n("td",[e._v("1.10.0+")])]),e._v(" "),n("tr",[n("td",[e._v("1.0")]),e._v(" "),n("td",[e._v("1.9.1ã€‚+")])])])]),e._v(" "),n("p",[e._v("é™¤äº†è¡¨ä¸­æ˜¾ç¤ºçš„Composeæ–‡ä»¶æ ¼å¼ç‰ˆæœ¬å¤–ï¼ŒComposeæœ¬èº«ä¹Ÿå¤„äºå‘å¸ƒè®¡åˆ’ä¸­ï¼Œå¦‚ "),n("a",{attrs:{href:"https://github.com/docker/compose/releases/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Compose releasesä¸­"),n("OutboundLink")],1),e._v(" æ‰€ç¤º ï¼Œä½†æ˜¯æ–‡ä»¶æ ¼å¼ç‰ˆæœ¬ä¸ä¸€å®šéšæ¯ä¸ªå‘è¡Œç‰ˆå¢åŠ ã€‚ ä¾‹å¦‚ï¼ŒComposeæ–‡ä»¶æ ¼å¼3.0æœ€åˆæ˜¯åœ¨ "),n("a",{attrs:{href:"https://github.com/docker/compose/releases/tag/1.10.0",target:"_blank",rel:"noopener noreferrer"}},[e._v("Composeç‰ˆæœ¬1.10.0ä¸­"),n("OutboundLink")],1),e._v(" å¼•å…¥çš„ ï¼Œå¹¶åœ¨éšåçš„ç‰ˆæœ¬ä¸­é€æ¸ç‰ˆæœ¬åŒ–ã€‚")]),e._v(" "),n("h2",{attrs:{id:"æ’°å†™æ–‡ä»¶ç»“æ„å’Œç¤ºä¾‹-ğŸ”—"}},[e._v("æ’°å†™æ–‡ä»¶ç»“æ„å’Œç¤ºä¾‹ "),n("a",{attrs:{href:"#compose-file-structure-and-examples"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("è¿™æ˜¯ "),n("a",{attrs:{href:"https://github.com/docker/labs/tree/master/beginner/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker for Beginnerså®éªŒ"),n("OutboundLink")],1),e._v(" ä¸»é¢˜ä¸­ ä½¿ç”¨çš„æŠ•ç¥¨åº”ç”¨ç¨‹åºç¤ºä¾‹çš„Composeæ–‡ä»¶ç¤ºä¾‹ï¼Œè¯¥ ä¸»é¢˜æ¶‰åŠ "),n("a",{attrs:{href:"https://github.com/docker/labs/blob/master/beginner/chapters/votingapp.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("å°†åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°Swarm"),n("OutboundLink")],1),e._v(" ï¼š")]),e._v(" "),n("p",[e._v("ç¤ºä¾‹æ’°å†™æ–‡ä»¶ç‰ˆæœ¬3")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('\nversion: "3.8"\nservices:\n\n  redis:\n    image: redis:alpine\n    ports:\n      - "6379"\n    networks:\n      - frontend\n    deploy:\n      replicas: 2\n      update_config:\n        parallelism: 2\n        delay: 10s\n      restart_policy:\n        condition: on-failure\n\n  db:\n    image: postgres:9.4\n    volumes:\n      - db-data:/var/lib/postgresql/data\n    networks:\n      - backend\n    deploy:\n      placement:\n        max_replicas_per_node: 1\n        constraints:\n          - "node.role==manager"\n\n  vote:\n    image: dockersamples/examplevotingapp_vote:before\n    ports:\n      - "5000:80"\n    networks:\n      - frontend\n    depends_on:\n      - redis\n    deploy:\n      replicas: 2\n      update_config:\n        parallelism: 2\n      restart_policy:\n        condition: on-failure\n\n  result:\n    image: dockersamples/examplevotingapp_result:before\n    ports:\n      - "5001:80"\n    networks:\n      - backend\n    depends_on:\n      - db\n    deploy:\n      replicas: 1\n      update_config:\n        parallelism: 2\n        delay: 10s\n      restart_policy:\n        condition: on-failure\n\n  worker:\n    image: dockersamples/examplevotingapp_worker\n    networks:\n      - frontend\n      - backend\n    deploy:\n      mode: replicated\n      replicas: 1\n      labels: [APP=VOTING]\n      restart_policy:\n        condition: on-failure\n        delay: 10s\n        max_attempts: 3\n        window: 120s\n      placement:\n        constraints:\n          - "node.role==manager"\n\n  visualizer:\n    image: dockersamples/visualizer:stable\n    ports:\n      - "8080:8080"\n    stop_grace_period: 1m30s\n    volumes:\n      - "/var/run/docker.sock:/var/run/docker.sock"\n    deploy:\n      placement:\n        constraints:\n          - "node.role==manager"\n\nnetworks:\n  frontend:\n  backend:\n\nvolumes:\n  db-data:\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br"),n("span",{staticClass:"line-number"},[e._v("23")]),n("br"),n("span",{staticClass:"line-number"},[e._v("24")]),n("br"),n("span",{staticClass:"line-number"},[e._v("25")]),n("br"),n("span",{staticClass:"line-number"},[e._v("26")]),n("br"),n("span",{staticClass:"line-number"},[e._v("27")]),n("br"),n("span",{staticClass:"line-number"},[e._v("28")]),n("br"),n("span",{staticClass:"line-number"},[e._v("29")]),n("br"),n("span",{staticClass:"line-number"},[e._v("30")]),n("br"),n("span",{staticClass:"line-number"},[e._v("31")]),n("br"),n("span",{staticClass:"line-number"},[e._v("32")]),n("br"),n("span",{staticClass:"line-number"},[e._v("33")]),n("br"),n("span",{staticClass:"line-number"},[e._v("34")]),n("br"),n("span",{staticClass:"line-number"},[e._v("35")]),n("br"),n("span",{staticClass:"line-number"},[e._v("36")]),n("br"),n("span",{staticClass:"line-number"},[e._v("37")]),n("br"),n("span",{staticClass:"line-number"},[e._v("38")]),n("br"),n("span",{staticClass:"line-number"},[e._v("39")]),n("br"),n("span",{staticClass:"line-number"},[e._v("40")]),n("br"),n("span",{staticClass:"line-number"},[e._v("41")]),n("br"),n("span",{staticClass:"line-number"},[e._v("42")]),n("br"),n("span",{staticClass:"line-number"},[e._v("43")]),n("br"),n("span",{staticClass:"line-number"},[e._v("44")]),n("br"),n("span",{staticClass:"line-number"},[e._v("45")]),n("br"),n("span",{staticClass:"line-number"},[e._v("46")]),n("br"),n("span",{staticClass:"line-number"},[e._v("47")]),n("br"),n("span",{staticClass:"line-number"},[e._v("48")]),n("br"),n("span",{staticClass:"line-number"},[e._v("49")]),n("br"),n("span",{staticClass:"line-number"},[e._v("50")]),n("br"),n("span",{staticClass:"line-number"},[e._v("51")]),n("br"),n("span",{staticClass:"line-number"},[e._v("52")]),n("br"),n("span",{staticClass:"line-number"},[e._v("53")]),n("br"),n("span",{staticClass:"line-number"},[e._v("54")]),n("br"),n("span",{staticClass:"line-number"},[e._v("55")]),n("br"),n("span",{staticClass:"line-number"},[e._v("56")]),n("br"),n("span",{staticClass:"line-number"},[e._v("57")]),n("br"),n("span",{staticClass:"line-number"},[e._v("58")]),n("br"),n("span",{staticClass:"line-number"},[e._v("59")]),n("br"),n("span",{staticClass:"line-number"},[e._v("60")]),n("br"),n("span",{staticClass:"line-number"},[e._v("61")]),n("br"),n("span",{staticClass:"line-number"},[e._v("62")]),n("br"),n("span",{staticClass:"line-number"},[e._v("63")]),n("br"),n("span",{staticClass:"line-number"},[e._v("64")]),n("br"),n("span",{staticClass:"line-number"},[e._v("65")]),n("br"),n("span",{staticClass:"line-number"},[e._v("66")]),n("br"),n("span",{staticClass:"line-number"},[e._v("67")]),n("br"),n("span",{staticClass:"line-number"},[e._v("68")]),n("br"),n("span",{staticClass:"line-number"},[e._v("69")]),n("br"),n("span",{staticClass:"line-number"},[e._v("70")]),n("br"),n("span",{staticClass:"line-number"},[e._v("71")]),n("br"),n("span",{staticClass:"line-number"},[e._v("72")]),n("br"),n("span",{staticClass:"line-number"},[e._v("73")]),n("br"),n("span",{staticClass:"line-number"},[e._v("74")]),n("br"),n("span",{staticClass:"line-number"},[e._v("75")]),n("br"),n("span",{staticClass:"line-number"},[e._v("76")]),n("br"),n("span",{staticClass:"line-number"},[e._v("77")]),n("br"),n("span",{staticClass:"line-number"},[e._v("78")]),n("br"),n("span",{staticClass:"line-number"},[e._v("79")]),n("br"),n("span",{staticClass:"line-number"},[e._v("80")]),n("br"),n("span",{staticClass:"line-number"},[e._v("81")]),n("br"),n("span",{staticClass:"line-number"},[e._v("82")]),n("br"),n("span",{staticClass:"line-number"},[e._v("83")]),n("br"),n("span",{staticClass:"line-number"},[e._v("84")]),n("br"),n("span",{staticClass:"line-number"},[e._v("85")]),n("br"),n("span",{staticClass:"line-number"},[e._v("86")]),n("br"),n("span",{staticClass:"line-number"},[e._v("87")]),n("br"),n("span",{staticClass:"line-number"},[e._v("88")]),n("br"),n("span",{staticClass:"line-number"},[e._v("89")]),n("br"),n("span",{staticClass:"line-number"},[e._v("90")]),n("br"),n("span",{staticClass:"line-number"},[e._v("91")]),n("br"),n("span",{staticClass:"line-number"},[e._v("92")]),n("br"),n("span",{staticClass:"line-number"},[e._v("93")]),n("br"),n("span",{staticClass:"line-number"},[e._v("94")]),n("br"),n("span",{staticClass:"line-number"},[e._v("95")]),n("br"),n("span",{staticClass:"line-number"},[e._v("96")]),n("br"),n("span",{staticClass:"line-number"},[e._v("97")]),n("br"),n("span",{staticClass:"line-number"},[e._v("98")]),n("br")])]),n("p",[e._v("æ­¤å‚è€ƒé¡µä¸Šçš„ä¸»é¢˜æŒ‰é¡¶çº§é”®æŒ‰å­—æ¯é¡ºåºç»„ç»‡ï¼Œä»¥åæ˜ Composeæ–‡ä»¶æœ¬èº«çš„ç»“æ„ã€‚ è¯¥é…ç½®æ–‡ä»¶ï¼Œå¦‚åœ¨å®šä¹‰éƒ¨åˆ†é¡¶çº§é”® "),n("code",[e._v("build")]),e._v(" ï¼Œ "),n("code",[e._v("deploy")]),e._v(" ï¼Œ "),n("code",[e._v("depends_on")]),e._v(" ï¼Œ "),n("code",[e._v("networks")]),e._v(" ï¼Œç­‰ç­‰ï¼Œéƒ½åˆ—å‡ºäº†æ”¯æŒå®ƒä»¬ä½œä¸ºå­è¯¾é¢˜çš„é€‰é¡¹ã€‚ è¿™æ˜ å°„åˆ° "),n("code",[e._v("<key>: <option>: <value>")]),e._v(" Composeæ–‡ä»¶ çš„ ç¼©è¿›ç»“æ„ã€‚")]),e._v(" "),n("h2",{attrs:{id:"æœåŠ¡é…ç½®å‚è€ƒ-ğŸ”—"}},[e._v("æœåŠ¡é…ç½®å‚è€ƒ "),n("a",{attrs:{href:"#service-configuration-reference"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("Composeæ–‡ä»¶æ˜¯ä¸€ä¸ª "),n("a",{attrs:{href:"http://yaml.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("YAML"),n("OutboundLink")],1),e._v(" æ–‡ä»¶ï¼Œç”¨äºå®šä¹‰ "),n("a",{attrs:{href:"#service-configuration-reference"}},[e._v("æœåŠ¡")]),e._v(" ï¼Œ "),n("a",{attrs:{href:"#network-configuration-reference"}},[e._v("ç½‘ç»œ")]),e._v(" å’Œ "),n("a",{attrs:{href:"#volume-configuration-reference"}},[e._v("å·")]),e._v(" ã€‚ æ’°å†™æ–‡ä»¶çš„é»˜è®¤è·¯å¾„ä¸º "),n("code",[e._v("./docker-compose.yml")]),e._v(" ã€‚")]),e._v(" "),n("blockquote",[n("p",[n("strong",[e._v("æç¤º")]),e._v(" ï¼šæ‚¨å¯ä»¥ ä¸ºæ­¤æ–‡ä»¶ ä½¿ç”¨a "),n("code",[e._v(".yml")]),e._v(" æˆ– "),n("code",[e._v(".yaml")]),e._v(" æ‰©å±•åã€‚ ä»–ä»¬ä¿©éƒ½å·¥ä½œã€‚")])]),e._v(" "),n("p",[e._v("æœåŠ¡å®šä¹‰åŒ…å«åº”ç”¨äºè¯¥æœåŠ¡å¯åŠ¨çš„æ¯ä¸ªå®¹å™¨çš„é…ç½®ï¼Œå°±åƒå°†å‘½ä»¤è¡Œå‚æ•°ä¼ é€’ç»™ä¸€æ · "),n("code",[e._v("docker run")]),e._v(" ã€‚ åŒæ ·ï¼Œç½‘ç»œå’Œå·å®šä¹‰ç±»ä¼¼äº "),n("code",[e._v("docker network create")]),e._v(" å’Œ "),n("code",[e._v("docker volume create")]),e._v(" ã€‚")]),e._v(" "),n("p",[e._v("å¦‚ "),n("code",[e._v("docker run")]),e._v(" ï¼Œåœ¨DockerfileæŒ‡å®šçš„é€‰é¡¹ï¼Œå¦‚ "),n("code",[e._v("CMD")]),e._v(" ï¼Œ "),n("code",[e._v("EXPOSE")]),e._v(" ï¼Œ "),n("code",[e._v("VOLUME")]),e._v(" ï¼Œ "),n("code",[e._v("ENV")]),e._v(" ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹å°Šé‡-ä½ ä¸éœ€è¦å†æ¬¡æŒ‡å®šå®ƒä»¬ "),n("code",[e._v("docker-compose.yml")]),e._v(" ã€‚")]),e._v(" "),n("p",[e._v("æ‚¨å¯ä»¥ä½¿ç”¨ç±»ä¼¼Bashçš„ "),n("code",[e._v("${VARIABLE}")]),e._v(" è¯­æ³• åœ¨é…ç½®å€¼ä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡ - æœ‰å…³å®Œæ•´è¯¦ç»†ä¿¡æ¯ï¼Œ è¯·å‚è§ "),n("a",{attrs:{href:"#variable-substitution"}},[e._v("å˜é‡æ›¿æ¢")]),e._v(" ã€‚")]),e._v(" "),n("p",[e._v("æœ¬èŠ‚åŒ…å«ç‰ˆæœ¬3ä¸­çš„æœåŠ¡å®šä¹‰æ”¯æŒçš„æ‰€æœ‰é…ç½®é€‰é¡¹çš„åˆ—è¡¨ã€‚")]),e._v(" "),n("h3",{attrs:{id:"å»ºç«‹-ğŸ”—"}},[e._v("å»ºç«‹ "),n("a",{attrs:{href:"#build"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("åœ¨æ„å»ºæ—¶åº”ç”¨çš„é…ç½®é€‰é¡¹ã€‚")]),e._v(" "),n("p",[n("code",[e._v("build")]),e._v(" å¯ä»¥æŒ‡å®šä¸ºåŒ…å«æ„å»ºä¸Šä¸‹æ–‡è·¯å¾„çš„å­—ç¬¦ä¸²ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  webapp:\n    build: ./dir\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("p",[e._v("æˆ–è€…ï¼Œä½œä¸ºå…·æœ‰ "),n("a",{attrs:{href:"#context"}},[e._v("ä¸Šä¸‹æ–‡")]),e._v(" å’Œï¼ˆå¯é€‰ï¼‰ "),n("a",{attrs:{href:"#dockerfile"}},[e._v("Dockerfile")]),e._v(" å’Œ "),n("a",{attrs:{href:"#args"}},[e._v("args")]),e._v(" ä¸‹æŒ‡å®šçš„è·¯å¾„çš„å¯¹è±¡ ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  webapp:\n    build:\n      context: ./dir\n      dockerfile: Dockerfile-alternate\n      args:\n        buildno: 1\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br")])]),n("p",[e._v("å¦‚æœæ‚¨æŒ‡å®š "),n("code",[e._v("image")]),e._v(" ä»¥åŠ "),n("code",[e._v("build")]),e._v(" ï¼Œåˆ™Composeä¼šä½¿ç”¨ä¸­ æŒ‡å®š çš„ "),n("code",[e._v("webapp")]),e._v(" å’Œå¯é€‰ åç§°æ¥å‘½åæ„å»ºçš„å›¾åƒ ï¼š "),n("code",[e._v("tag")]),e._v(" "),n("code",[e._v("image")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("build: ./dir\nimage: webapp:tag\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("p",[e._v("è¿™å°†äº§ç”Ÿä¸€ä¸ªåä¸º "),n("code",[e._v("webapp")]),e._v(" å¹¶æ ‡è®° ä¸ºçš„å›¾åƒï¼Œè¯¥å›¾åƒ "),n("code",[e._v("tag")]),e._v(" æ˜¯ä»æ„å»ºçš„ "),n("code",[e._v("./dir")]),e._v(" ã€‚")]),e._v(" "),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨ä»¥ç¾¤é›†æ¨¡å¼éƒ¨ç½²å †æ ˆ"),n("OutboundLink")],1),e._v(" "),n("code",[e._v("build")]),e._v(" æ—¶ï¼Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å°†"),n("OutboundLink")],1),e._v(" å¿½ç•¥ è¯¥ é€‰é¡¹ã€‚ è¯¥ "),n("code",[e._v("docker stack")]),e._v(" å‘½ä»¤ä¸ä¼šåœ¨éƒ¨ç½²ä¹‹å‰ç”Ÿæˆæ˜ åƒã€‚")])]),e._v(" "),n("h4",{attrs:{id:"è¯­å¢ƒ"}},[e._v("è¯­å¢ƒ")]),e._v(" "),n("p",[e._v("åŒ…å«Dockerfileçš„ç›®å½•çš„è·¯å¾„ï¼Œæˆ–è€…gitå­˜å‚¨åº“çš„URLã€‚")]),e._v(" "),n("p",[e._v("å½“æä¾›çš„å€¼æ˜¯ç›¸å¯¹è·¯å¾„æ—¶ï¼Œå®ƒå°†è¢«è§£é‡Šä¸ºç›¸å¯¹äºComposeæ–‡ä»¶çš„ä½ç½®ã€‚ æ­¤ç›®å½•ä¹Ÿæ˜¯å‘é€åˆ°Dockerå®ˆæŠ¤ç¨‹åºçš„æ„å»ºä¸Šä¸‹æ–‡ã€‚")]),e._v(" "),n("p",[e._v("Composeç”¨ç”Ÿæˆçš„åç§°æ„å»ºå¹¶æ ‡è®°å®ƒï¼Œç„¶åä½¿ç”¨è¯¥å›¾åƒã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("build:\n  context: ./dir\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("h4",{attrs:{id:"dockeræ–‡ä»¶"}},[e._v("dockeræ–‡ä»¶")]),e._v(" "),n("p",[e._v("å¤‡ç”¨Dockerfileã€‚")]),e._v(" "),n("p",[e._v("Composeä½¿ç”¨æ›¿ä»£æ–‡ä»¶è¿›è¡Œæ„å»ºã€‚ è¿˜å¿…é¡»æŒ‡å®šä¸€ä¸ªæ„å»ºè·¯å¾„ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("build:\n  context: .\n  dockerfile: Dockerfile-alternate\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("h4",{attrs:{id:"args"}},[e._v("args")]),e._v(" "),n("p",[e._v("æ·»åŠ æ„å»ºå‚æ•°ï¼Œè¿™æ˜¯åªèƒ½åœ¨æ„å»ºè¿‡ç¨‹ä¸­è®¿é—®çš„ç¯å¢ƒå˜é‡ã€‚")]),e._v(" "),n("p",[e._v("é¦–å…ˆï¼Œåœ¨Dockerfileä¸­æŒ‡å®šå‚æ•°ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('ARG buildno\nARG gitcommithash\n\nRUN echo "Build number: $buildno"\nRUN echo "Based on commit: $gitcommithash"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("p",[e._v("ç„¶ååœ¨ "),n("code",[e._v("build")]),e._v(" é”® ä¸‹æŒ‡å®šå‚æ•° ã€‚ æ‚¨å¯ä»¥ä¼ é€’æ˜ å°„æˆ–åˆ—è¡¨ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("build:\n  context: .\n  args:\n    buildno: 1\n    gitcommithash: cdc3b19\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("build:\n  context: .\n  args:\n    - buildno=1\n    - gitcommithash=cdc3b19\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("blockquote",[n("p",[e._v("build-argsçš„èŒƒå›´")]),e._v(" "),n("p",[e._v("åœ¨Dockerfileä¸­ï¼Œå¦‚æœæ‚¨ "),n("code",[e._v("ARG")]),e._v(" åœ¨ "),n("code",[e._v("FROM")]),e._v(" æŒ‡ä»¤ å‰ æŒ‡å®š ï¼Œ "),n("code",[e._v("ARG")]),e._v(" åˆ™åœ¨ä¸‹æ–¹çš„æ„å»ºæŒ‡ä»¤ä¸­ä¸å¯ç”¨ "),n("code",[e._v("FROM")]),e._v(" ã€‚ å¦‚æœæ‚¨éœ€è¦ä¸€ä¸ªå‚æ•°åœ¨ä¸¤ä¸ªåœ°æ–¹éƒ½å¯ç”¨ï¼Œè¯·åœ¨ "),n("code",[e._v("FROM")]),e._v(" è¯´æ˜ä¸­ ä¹ŸæŒ‡å®šå®ƒ ã€‚ æœ‰å…³ç”¨æ³•çš„è¯¦ç»†ä¿¡æ¯ï¼Œ è¯·å‚é˜… æ–‡æ¡£ä¸­ çš„â€œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/builder/#understand-how-arg-and-from-interact",target:"_blank",rel:"noopener noreferrer"}},[e._v("äº†è§£ARGSå’ŒFROMä¹‹é—´çš„äº¤äº’æ–¹å¼â€"),n("OutboundLink")],1),e._v(" éƒ¨åˆ†ã€‚")])]),e._v(" "),n("p",[e._v("æ‚¨å¯ä»¥åœ¨æŒ‡å®šæ„å»ºå‚æ•°æ—¶çœç•¥è¯¥å€¼ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ„å»ºæ—¶çš„å€¼å°±æ˜¯è¿è¡ŒComposeçš„ç¯å¢ƒä¸­çš„å€¼ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("args:\n  - buildno\n  - gitcommithash\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("blockquote",[n("p",[e._v("ä½¿ç”¨å¸ƒå°”å€¼æ—¶çš„æç¤º")]),e._v(" "),n("p",[e._v("YAMLå¸ƒå°”å€¼ï¼ˆ "),n("code",[e._v('"true"')]),e._v(" ï¼Œ "),n("code",[e._v('"false"')]),e._v(" ï¼Œ "),n("code",[e._v('"yes"')]),e._v(" ï¼Œ "),n("code",[e._v('"no"')]),e._v(" ï¼Œ "),n("code",[e._v('"on"')]),e._v(" ï¼Œ "),n("code",[e._v('"off"')]),e._v(" ï¼‰å¿…é¡»ç”¨å¼•å·æ‹¬èµ·æ¥ï¼Œè¿™æ ·åˆ†æå™¨ä¼šå°†å®ƒä»¬è§£é‡Šä¸ºå­—ç¬¦ä¸²ã€‚")])]),e._v(" "),n("h4",{attrs:{id:"cache-from"}},[e._v("cache_from")]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-32",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.2ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼æ·»åŠ ")])]),e._v(" "),n("p",[e._v("å¼•æ“ç”¨äºç¼“å­˜è§£æçš„å›¾åƒåˆ—è¡¨ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("build:\n  context: .\n  cache_from:\n    - alpine:latest\n    - corp/web_app:3.14\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("h4",{attrs:{id:"æ ‡ç­¾"}},[e._v("æ ‡ç­¾")]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-33",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç‰ˆæœ¬3.3"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼æ·»åŠ ")])]),e._v(" "),n("p",[e._v("ä½¿ç”¨ "),n("a",{attrs:{href:"https://docs.docker.com/config/labels-custom-metadata/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Dockeræ ‡ç­¾"),n("OutboundLink")],1),e._v(" å°†å…ƒæ•°æ®æ·»åŠ åˆ°ç”Ÿæˆçš„å›¾åƒä¸­ ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨æ•°ç»„æˆ–å­—å…¸ã€‚")]),e._v(" "),n("p",[e._v("å»ºè®®æ‚¨ä½¿ç”¨åå‘DNSè¡¨ç¤ºæ³•ï¼Œä»¥é˜²æ­¢æ ‡ç­¾ä¸å…¶ä»–è½¯ä»¶ä½¿ç”¨çš„æ ‡ç­¾å†²çªã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('build:\n  context: .\n  labels:\n    com.example.description: "Accounting webapp"\n    com.example.department: "Finance"\n    com.example.label-with-empty-value: ""\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('build:\n  context: .\n  labels:\n    - "com.example.description=Accounting webapp"\n    - "com.example.department=Finance"\n    - "com.example.label-with-empty-value"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br")])]),n("h4",{attrs:{id:"ç½‘ç»œ"}},[e._v("ç½‘ç»œ")]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-34",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.4ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼æ·»åŠ ")])]),e._v(" "),n("p",[e._v("è®¾ç½®ç½‘ç»œå®¹å™¨çš„è¿æ¥ä»¥ "),n("code",[e._v("RUN")]),e._v(" åœ¨æ„å»ºè¿‡ç¨‹ä¸­ è¿›è¡Œ è¯´æ˜ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("build:\n  context: .\n  network: host\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("build:\n  context: .\n  network: custom_network_1\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("p",[e._v("ç”¨äº "),n("code",[e._v("none")]),e._v(" åœ¨æ„å»ºæœŸé—´ç¦ç”¨è”ç½‘ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("build:\n  context: .\n  network: none\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("h4",{attrs:{id:"shm-size"}},[e._v("shm_size")]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-35",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.5ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼æ·»åŠ ")])]),e._v(" "),n("p",[e._v("è®¾ç½® "),n("code",[e._v("/dev/shm")]),e._v(" æ­¤æ„å»ºå®¹å™¨ çš„ åˆ†åŒº å¤§å° ã€‚ æŒ‡å®šä¸ºè¡¨ç¤ºå­—èŠ‚æ•°çš„æ•´æ•°å€¼æˆ–è¡¨ç¤º "),n("a",{attrs:{href:"#specifying-byte-values"}},[e._v("å­—èŠ‚å€¼")]),e._v(" çš„å­—ç¬¦ä¸² ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("build:\n  context: .\n  shm_size: '2gb'\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("build:\n  context: .\n  shm_size: 10000000\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("h4",{attrs:{id:"ç›®æ ‡"}},[e._v("ç›®æ ‡")]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-34",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.4ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼æ·»åŠ ")])]),e._v(" "),n("p",[e._v("å»ºç«‹å†…å®šä¹‰çš„æŒ‡å®šé˜¶æ®µ "),n("code",[e._v("Dockerfile")]),e._v(" ã€‚ æœ‰å…³ è¯¦ç»†ä¿¡æ¯ï¼Œ è¯·å‚è§ "),n("a",{attrs:{href:"https://docs.docker.com/develop/develop-images/multistage-build/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å¤šé˜¶æ®µæ„å»ºæ–‡æ¡£"),n("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("build:\n  context: .\n  target: prod\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("h3",{attrs:{id:"cap-addï¼Œ-cap-dropğŸ”—"}},[e._v("cap_addï¼Œ "),n("a",{attrs:{href:"#cap_add-cap_drop"}},[e._v("cap_dropğŸ”—")])]),e._v(" "),n("p",[e._v("æ·»åŠ æˆ–åˆ é™¤å®¹å™¨åŠŸèƒ½ã€‚ è¯·å‚é˜… "),n("code",[e._v("man 7 capabilities")]),e._v(" ä»¥è·å–å®Œæ•´åˆ—è¡¨ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("cap_add:\n  - ALL\n\ncap_drop:\n  - NET_ADMIN\n  - SYS_ADMIN\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br")])]),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨ç¾¤æ¨¡å¼ä¸‹éƒ¨ç½²å †æ ˆ"),n("OutboundLink")],1),e._v(" æ—¶ ï¼Œ "),n("code",[e._v("cap_add")]),e._v(" å’Œ "),n("code",[e._v("cap_drop")]),e._v(" é€‰é¡¹å°†è¢«å¿½ç•¥"),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[n("OutboundLink")],1)])]),e._v(" "),n("h3",{attrs:{id:"cgroup-parent-ğŸ”—"}},[e._v("cgroup_parent "),n("a",{attrs:{href:"#cgroup_parent"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªå¯é€‰çš„çˆ¶cgroupã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("cgroup_parent: m-executor-abcd\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨é›†ç¾¤æ¨¡å¼ä¸‹éƒ¨ç½²å †æ ˆ"),n("OutboundLink")],1),e._v(" "),n("code",[e._v("cgroup_parent")]),e._v(" æ—¶ï¼Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å°†"),n("OutboundLink")],1),e._v(" å¿½ç•¥ è¯¥ é€‰é¡¹"),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[n("OutboundLink")],1)])]),e._v(" "),n("h3",{attrs:{id:"å‘½ä»¤-ğŸ”—"}},[e._v("å‘½ä»¤ "),n("a",{attrs:{href:"#command"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("è¦†ç›–é»˜è®¤å‘½ä»¤ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("command: bundle exec thin -p 3000\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("p",[e._v("è¯¥å‘½ä»¤ä¹Ÿå¯ä»¥æ˜¯åˆ—è¡¨ï¼Œç±»ä¼¼äº "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/builder/#cmd",target:"_blank",rel:"noopener noreferrer"}},[e._v("dockerfile"),n("OutboundLink")],1),e._v(" ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('command: ["bundle", "exec", "thin", "-p", "3000"]\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("h3",{attrs:{id:"é…ç½®-ğŸ”—"}},[e._v("é…ç½® "),n("a",{attrs:{href:"#configs"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("ä½¿ç”¨æŒ‰æœåŠ¡ "),n("code",[e._v("configs")]),e._v(" é…ç½® ï¼ŒæŒ‰æœåŠ¡æˆäºˆå¯¹é…ç½®çš„è®¿é—®æƒé™ ã€‚ æ”¯æŒä¸¤ç§ä¸åŒçš„è¯­æ³•å˜ä½“ã€‚")]),e._v(" "),n("blockquote",[n("p",[n("strong",[e._v("æ³¨æ„")]),e._v(" ï¼šè¯¥é…ç½®å¿…é¡»å·²ç»å­˜åœ¨æˆ–å·² "),n("a",{attrs:{href:"#configs-configuration-reference"}},[e._v("åœ¨ "),n("code",[e._v("configs")])]),e._v(" æ­¤å †æ ˆæ–‡ä»¶ "),n("a",{attrs:{href:"#configs-configuration-reference"}},[e._v("çš„é¡¶çº§")]),e._v(" "),n("a",{attrs:{href:"#configs-configuration-reference"}},[e._v("é…ç½®")]),e._v(" ä¸­ "),n("a",{attrs:{href:"#configs-configuration-reference"}},[e._v("å®šä¹‰")]),e._v(" ï¼Œå¦åˆ™å †æ ˆéƒ¨ç½²å¤±è´¥ã€‚")])]),e._v(" "),n("p",[e._v("æœ‰å…³é…ç½®çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§ "),n("a",{attrs:{href:"https://docs.docker.com/engine/swarm/configs/",target:"_blank",rel:"noopener noreferrer"}},[e._v("configs"),n("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),n("h4",{attrs:{id:"çŸ­è¯­æ³•"}},[e._v("çŸ­è¯­æ³•")]),e._v(" "),n("p",[e._v("ç®€çŸ­çš„è¯­æ³•å˜ä½“ä»…æŒ‡å®šé…ç½®åç§°ã€‚ è¿™å°†æˆäºˆå®¹å™¨è®¿é—®é…ç½®çš„æƒé™ï¼Œå¹¶å°†å…¶å®‰è£…åœ¨ "),n("code",[e._v("/<config_name>")]),e._v(" å®¹å™¨å†…ã€‚ æºåç§°å’Œç›®æ ‡å®‰è£…ç‚¹éƒ½è®¾ç½®ä¸ºé…ç½®åç§°ã€‚")]),e._v(" "),n("p",[e._v("ä»¥ä¸‹ç¤ºä¾‹ä½¿ç”¨çŸ­è¯­æ³•æ¥æˆäºˆ "),n("code",[e._v("redis")]),e._v(" æœåŠ¡å¯¹ "),n("code",[e._v("my_config")]),e._v(" å’Œ "),n("code",[e._v("my_other_config")]),e._v(" é…ç½®çš„ è®¿é—®æƒé™ ã€‚ çš„å€¼ "),n("code",[e._v("my_config")]),e._v(" è®¾ç½®ä¸ºfileçš„å†…å®¹ "),n("code",[e._v("./my_config.txt")]),e._v(" ï¼Œå¹¶ "),n("code",[e._v("my_other_config")]),e._v(" å®šä¹‰ä¸ºå¤–éƒ¨èµ„æºï¼Œè¿™æ„å‘³ç€å®ƒå·²ç»åœ¨Dockerä¸­å®šä¹‰ï¼Œå¯ä»¥é€šè¿‡è¿è¡Œ "),n("code",[e._v("docker config create")]),e._v(" å‘½ä»¤æˆ–é€šè¿‡å…¶ä»–å †æ ˆéƒ¨ç½²è¿›è¡Œå®šä¹‰ã€‚ å¦‚æœå¤–éƒ¨é…ç½®ä¸å­˜åœ¨ï¼Œåˆ™å †æ ˆéƒ¨ç½²å¤±è´¥å¹¶æ˜¾ç¤º "),n("code",[e._v("config not found")]),e._v(" é”™è¯¯ã€‚")]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-33",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç‰ˆæœ¬3.3"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")]),e._v(" "),n("p",[n("code",[e._v("config")]),e._v(" ç‰ˆæœ¬3.3å’Œæ›´é«˜ç‰ˆæœ¬çš„æ’°å†™æ–‡ä»¶æ ¼å¼ä»…æ”¯æŒå®šä¹‰ã€‚")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  redis:\n    image: redis:latest\n    deploy:\n      replicas: 1\n    configs:\n      - my_config\n      - my_other_config\nconfigs:\n  my_config:\n    file: ./my_config.txt\n  my_other_config:\n    external: true\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br")])]),n("h4",{attrs:{id:"é•¿è¯­æ³•"}},[e._v("é•¿è¯­æ³•")]),e._v(" "),n("p",[e._v("é•¿è¯­æ³•æä¾›äº†åœ¨æœåŠ¡çš„ä»»åŠ¡å®¹å™¨ä¸­å¦‚ä½•åˆ›å»ºé…ç½®çš„æ›´å¤šç²’åº¦ã€‚")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("source")]),e._v(" ï¼šDockerä¸­å­˜åœ¨çš„é…ç½®åç§°ã€‚")]),e._v(" "),n("li",[n("code",[e._v("target")]),e._v(" ï¼šè¦åœ¨æœåŠ¡çš„ä»»åŠ¡å®¹å™¨ä¸­æŒ‚è½½çš„æ–‡ä»¶çš„è·¯å¾„å’Œåç§°ã€‚ "),n("code",[e._v("/<source>")]),e._v(" å¦‚æœæœªæŒ‡å®š ï¼Œ åˆ™ é»˜è®¤ä¸º ã€‚")]),e._v(" "),n("li",[n("code",[e._v("uid")]),e._v(" å’Œ "),n("code",[e._v("gid")]),e._v(" ï¼šæ‹¥æœ‰æœåŠ¡ä»»åŠ¡å®¹å™¨ä¸­å·²å®‰è£…çš„é…ç½®æ–‡ä»¶çš„æ•°å­—UIDæˆ–GIDã€‚ "),n("code",[e._v("0")]),e._v(" å¦‚æœæœªæŒ‡å®šï¼Œåˆ™ ä¸¤è€…é»˜è®¤éƒ½ åœ¨Linuxä¸Šã€‚ Windowsä¸æ”¯æŒã€‚")]),e._v(" "),n("li",[n("code",[e._v("mode")]),e._v(" ï¼šæœåŠ¡çš„ä»»åŠ¡å®¹å™¨ä¸­è£…å…¥çš„æ–‡ä»¶çš„æƒé™ï¼Œä»¥å…«è¿›åˆ¶è¡¨ç¤ºæ³•ã€‚ ä¾‹å¦‚ï¼Œ "),n("code",[e._v("0444")]),e._v(" è¡¨ç¤ºä¸–ç•Œå¯è¯»ã€‚ é»˜è®¤å€¼ä¸º "),n("code",[e._v("0444")]),e._v(" ã€‚ ç”±äºé…ç½®æ–‡ä»¶å·²æŒ‚è½½åœ¨ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå› æ­¤å®ƒä»¬ä¸å¯å†™ï¼Œå› æ­¤ï¼Œå¦‚æœè®¾ç½®å¯å†™ä½ï¼Œåˆ™å°†å…¶å¿½ç•¥ã€‚ å¯æ‰§è¡Œä½å¯ä»¥è®¾ç½®ã€‚ å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰UNIXæ–‡ä»¶æƒé™æ¨¡å¼ï¼Œåˆ™å¯èƒ½ä¼šå‘ç°æ­¤ "),n("a",{attrs:{href:"http://permissions-calculator.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("æƒé™è®¡ç®—å™¨"),n("OutboundLink")],1),e._v(" å¾ˆæœ‰ç”¨ã€‚")])]),e._v(" "),n("p",[e._v("ä¸‹é¢çš„ç¤ºä¾‹è®¾ç½®çš„åç§° "),n("code",[e._v("my_config")]),e._v(" ï¼Œä»¥ "),n("code",[e._v("redis_config")]),e._v(" åœ¨å®¹å™¨å†…ï¼Œå°†æ¨¡å¼è®¾å®šä¸º "),n("code",[e._v("0440")]),e._v(" ï¼ˆç»„å¯è¯»ï¼‰ï¼Œå¹¶ä¸”å°†æ‰€è¿°ç”¨æˆ·å’Œç»„ "),n("code",[e._v("103")]),e._v(" ã€‚ è¯¥ "),n("code",[e._v("redis")]),e._v(" æœåŠ¡æ— æƒè®¿é—®è¯¥ "),n("code",[e._v("my_other_config")]),e._v(" é…ç½®ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("version: \"3.8\"\nservices:\n  redis:\n    image: redis:latest\n    deploy:\n      replicas: 1\n    configs:\n      - source: my_config\n        target: /redis_config\n        uid: '103'\n        gid: '103'\n        mode: 0440\nconfigs:\n  my_config:\n    file: ./my_config.txt\n  my_other_config:\n    external: true\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br")])]),n("p",[e._v("æ‚¨å¯ä»¥æˆäºˆæœåŠ¡è®¿é—®å¤šä¸ªé…ç½®çš„æƒé™ï¼Œå¹¶ä¸”å¯ä»¥æ··åˆé•¿çŸ­è¯­æ³•ã€‚ å®šä¹‰é…ç½®å¹¶ä¸æ„å‘³ç€æˆäºˆå¯¹å®ƒçš„æœåŠ¡è®¿é—®æƒé™ã€‚")]),e._v(" "),n("h3",{attrs:{id:"container-name-ğŸ”—"}},[e._v("CONTAINER_NAME "),n("a",{attrs:{href:"#container_name"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æŒ‡å®šè‡ªå®šä¹‰å®¹å™¨åç§°ï¼Œè€Œä¸æ˜¯ç”Ÿæˆçš„é»˜è®¤åç§°ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("container_name: my-web-container\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("p",[e._v("ç”±äºDockerå®¹å™¨åç§°å¿…é¡»å”¯ä¸€ï¼Œå› æ­¤å¦‚æœæ‚¨æŒ‡å®šäº†è‡ªå®šä¹‰åç§°ï¼Œåˆ™æ— æ³•å°†æœåŠ¡æ‰©å±•åˆ°è¶…è¿‡1ä¸ªå®¹å™¨ã€‚ å°è¯•è¿™æ ·åšä¼šå¯¼è‡´é”™è¯¯ã€‚")]),e._v(" "),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨é›†ç¾¤æ¨¡å¼ä¸‹éƒ¨ç½²å †æ ˆ"),n("OutboundLink")],1),e._v(" "),n("code",[e._v("container_name")]),e._v(" æ—¶ï¼Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å°†"),n("OutboundLink")],1),e._v(" å¿½ç•¥ è¯¥ é€‰é¡¹"),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[n("OutboundLink")],1)])]),e._v(" "),n("h3",{attrs:{id:"credential-spec-ğŸ”—"}},[e._v("credential_spec "),n("a",{attrs:{href:"#credential_spec"}},[e._v("ğŸ”—")])]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-33",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç‰ˆæœ¬3.3"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")]),e._v(" "),n("p",[e._v("è¯¥ "),n("code",[e._v("credential_spec")]),e._v(" é€‰é¡¹å·²åœ¨v3.3ä¸­æ·»åŠ ã€‚ æ–‡ä»¶æ ¼å¼ç‰ˆæœ¬3.8æˆ–æ›´é«˜ç‰ˆæœ¬æ”¯æŒå°†ç»„æ‰˜ç®¡æœåŠ¡å¸æˆ·ï¼ˆgMSAï¼‰é…ç½®ä¸æ’°å†™æ–‡ä»¶ä¸€èµ·ä½¿ç”¨ã€‚")])]),e._v(" "),n("p",[e._v("é…ç½®æ‰˜ç®¡æœåŠ¡å¸æˆ·çš„å‡­æ®è§„èŒƒã€‚ æ­¤é€‰é¡¹ä»…ç”¨äºä½¿ç”¨Windowså®¹å™¨çš„æœåŠ¡ã€‚ åœ¨ "),n("code",[e._v("credential_spec")]),e._v(" å¿…é¡»åœ¨æ ¼å¼ "),n("code",[e._v("file://<filename>")]),e._v(" æˆ– "),n("code",[e._v("registry://<value-name>")]),e._v(" ã€‚")]),e._v(" "),n("p",[e._v("ä½¿ç”¨æ—¶ "),n("code",[e._v("file:")]),e._v(" ï¼Œå¼•ç”¨çš„æ–‡ä»¶å¿…é¡»å­˜åœ¨äº "),n("code",[e._v("CredentialSpecs")]),e._v(" Dockeræ•°æ®ç›®å½• çš„ å­ç›®å½•ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ "),n("code",[e._v("C:\\ProgramData\\Docker\\")]),e._v(" åœ¨Windowsä¸Šã€‚ ä»¥ä¸‹ç¤ºä¾‹ä»åä¸ºçš„æ–‡ä»¶ä¸­åŠ è½½å‡­æ®è§„èŒƒ "),n("code",[e._v("C:\\ProgramData\\Docker\\CredentialSpecs\\my-credential-spec.json")]),e._v(" ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("credential_spec:\n  file: my-credential-spec.json\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("p",[e._v("ä½¿ç”¨æ—¶ "),n("code",[e._v("registry:")]),e._v(" ï¼Œå°†ä»å®ˆæŠ¤ç¨‹åºä¸»æœºä¸Šçš„Windowsæ³¨å†Œè¡¨ä¸­è¯»å–å‡­æ®è§„èŒƒã€‚ å…·æœ‰ç»™å®šåç§°çš„æ³¨å†Œè¡¨å€¼å¿…é¡»ä½äºï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Virtualization\\Containers\\CredentialSpecs\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("p",[e._v("ä»¥ä¸‹ç¤ºä¾‹ä» "),n("code",[e._v("my-credential-spec")]),e._v(" æ³¨å†Œè¡¨ä¸­ å‘½åçš„å€¼åŠ è½½å‡­æ®è§„èŒƒ ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("credential_spec:\n  registry: my-credential-spec\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("h4",{attrs:{id:"gmsaé…ç½®ç¤ºä¾‹"}},[e._v("gMSAé…ç½®ç¤ºä¾‹")]),e._v(" "),n("p",[e._v("ä¸ºæœåŠ¡é…ç½®gMSAå‡­æ®è§„èŒƒæ—¶ï¼Œæ‚¨åªéœ€ä½¿ç”¨å³å¯æŒ‡å®šå‡­æ®è§„èŒƒ "),n("code",[e._v("config")]),e._v(" ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  myservice:\n    image: myimage:latest\n    credential_spec:\n      config: my_credential_spec\n\nconfigs:\n  my_credentials_spec:\n    file: ./my-credential-spec.json|\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br")])]),n("h3",{attrs:{id:"å–å†³äº-ğŸ”—"}},[e._v("å–å†³äº "),n("a",{attrs:{href:"#depends_on"}},[e._v("_ğŸ”—")])]),e._v(" "),n("p",[e._v("è¡¨è¾¾æœåŠ¡ä¹‹é—´çš„ä¾èµ–æ€§ã€‚ æœåŠ¡ä¾èµ–é¡¹å¯¼è‡´ä»¥ä¸‹è¡Œä¸ºï¼š")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("docker-compose up")]),e._v(" ä»¥ä¾èµ–æ€§é¡ºåºå¯åŠ¨æœåŠ¡ã€‚ åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œ "),n("code",[e._v("db")]),e._v(" å’Œ "),n("code",[e._v("redis")]),e._v(" åœ¨ä¹‹å‰å¯åŠ¨ "),n("code",[e._v("web")]),e._v(" ã€‚")]),e._v(" "),n("li",[n("code",[e._v("docker-compose up SERVICE")]),e._v(" è‡ªåŠ¨åŒ…å« "),n("code",[e._v("SERVICE")]),e._v(" çš„ä¾èµ–é¡¹ã€‚ åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œ "),n("code",[e._v("docker-compose up web")]),e._v(" è¿˜å°†åˆ›å»ºå¹¶å¯åŠ¨ "),n("code",[e._v("db")]),e._v(" å’Œ "),n("code",[e._v("redis")]),e._v(" ã€‚")]),e._v(" "),n("li",[n("code",[e._v("docker-compose stop")]),e._v(" æŒ‰ä¾èµ–å…³ç³»é¡ºåºåœæ­¢æœåŠ¡ã€‚ åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œ "),n("code",[e._v("web")]),e._v(" åœ¨ "),n("code",[e._v("db")]),e._v(" å’Œ ä¹‹å‰åœæ­¢ "),n("code",[e._v("redis")]),e._v(" ã€‚")])]),e._v(" "),n("p",[e._v("ç®€å•çš„ä¾‹å­ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  web:\n    build: .\n    depends_on:\n      - db\n      - redis\n  redis:\n    image: redis\n  db:\n    image: postgres\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br")])]),n("blockquote",[n("p",[e._v("ä½¿ç”¨æ—¶æœ‰å‡ ä»¶äº‹è¦æ³¨æ„ "),n("code",[e._v("depends_on")]),e._v(" ï¼š")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("depends_on")]),e._v(" åœ¨å¯åŠ¨ä¹‹å‰ ä¸ç­‰å¾… "),n("code",[e._v("db")]),e._v(" å¹¶ä¸” "),n("code",[e._v("redis")]),e._v(" â€œå‡†å¤‡å°±ç»ªâ€ "),n("code",[e._v("web")]),e._v(" -ä»… åœ¨å¯åŠ¨ ä¹‹å‰ã€‚ å¦‚æœéœ€è¦ç­‰å¾…æœåŠ¡å‡†å¤‡å°±ç»ªï¼Œè¯·å‚é˜… "),n("a",{attrs:{href:"https://docs.docker.com/compose/startup-order/",target:"_blank",rel:"noopener noreferrer"}},[e._v("æ§åˆ¶å¯åŠ¨é¡ºåºä»¥"),n("OutboundLink")],1),e._v(" è·å–æœ‰å…³æ­¤é—®é¢˜çš„æ›´å¤šä¿¡æ¯ä»¥åŠè§£å†³è¯¥é—®é¢˜çš„ç­–ç•¥ã€‚")]),e._v(" "),n("li",[e._v("ç‰ˆæœ¬3ä¸å†æ”¯æŒçš„ "),n("code",[e._v("condition")]),e._v(" å½¢å¼ "),n("code",[e._v("depends_on")]),e._v(" ã€‚")]),e._v(" "),n("li",[n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨ä»¥ç¾¤ä½“æ¨¡å¼"),n("OutboundLink")],1),e._v(" 3ç‰ˆæœ¬çš„Composeæ–‡ä»¶ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("éƒ¨ç½²å †æ ˆ"),n("OutboundLink")],1),e._v(" "),n("code",[e._v("depends_on")]),e._v(" æ—¶ï¼Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å°†"),n("OutboundLink")],1),e._v(" å¿½ç•¥ è¯¥ é€‰é¡¹ ã€‚")])])]),e._v(" "),n("h3",{attrs:{id:"éƒ¨ç½²-ğŸ”—"}},[e._v("éƒ¨ç½² "),n("a",{attrs:{href:"#deploy"}},[e._v("ğŸ”—")])]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-3",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç‰ˆæœ¬3"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")])]),e._v(" "),n("p",[e._v("æŒ‡å®šä¸æœåŠ¡çš„éƒ¨ç½²å’Œè¿è¡Œæœ‰å…³çš„é…ç½®ã€‚ è¿™åªèƒ½éƒ¨ç½²åˆ°æ—¶ç”Ÿæ•ˆ "),n("a",{attrs:{href:"https://docs.docker.com/engine/swarm/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç¾¤"),n("OutboundLink")],1),e._v(" ä¸ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("æ³Šåçª—å †æ ˆéƒ¨ç½²"),n("OutboundLink")],1),e._v(" ï¼Œå¹¶ä¸”è¢«å¿½ç•¥ "),n("code",[e._v("docker-compose up")]),e._v(" å’Œ "),n("code",[e._v("docker-compose run")]),e._v(" ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  redis:\n    image: redis:alpine\n    deploy:\n      replicas: 6\n      placement:\n        max_replicas_per_node: 1\n      update_config:\n        parallelism: 2\n        delay: 10s\n      restart_policy:\n        condition: on-failure\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br")])]),n("p",[e._v("æœ‰å‡ ä¸ªå­é€‰é¡¹å¯ç”¨ï¼š")]),e._v(" "),n("h4",{attrs:{id:"ç«¯ç‚¹æ¨¡å¼"}},[e._v("ç«¯ç‚¹æ¨¡å¼")]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-32",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.2ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")])]),e._v(" "),n("p",[e._v("ä¸ºè¿æ¥åˆ°ç¾¤é›†çš„å¤–éƒ¨å®¢æˆ·ç«¯æŒ‡å®šæœåŠ¡å‘ç°æ–¹æ³•ã€‚")]),e._v(" "),n("ul",[n("li",[n("p",[n("code",[e._v("endpoint_mode: vip")]),e._v(" -Dockerä¸ºæœåŠ¡åˆ†é…äº†ä¸€ä¸ªè™šæ‹ŸIPï¼ˆVIPï¼‰ï¼Œè¯¥è™šæ‹ŸIPå……å½“å®¢æˆ·ç«¯è®¿é—®ç½‘ç»œä¸ŠæœåŠ¡çš„å‰ç«¯ã€‚ Dockeråœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡çš„å¯ç”¨å·¥ä½œç¨‹åºèŠ‚ç‚¹ä¹‹é—´è·¯ç”±è¯·æ±‚ï¼Œè€Œæ— éœ€å®¢æˆ·ç«¯çŸ¥é“æœ‰å¤šå°‘èŠ‚ç‚¹æ­£åœ¨å‚ä¸æœåŠ¡æˆ–å…¶IPåœ°å€æˆ–ç«¯å£ã€‚ ï¼ˆè¿™æ˜¯é»˜è®¤è®¾ç½®ã€‚ï¼‰")])]),e._v(" "),n("li",[n("p",[n("code",[e._v("endpoint_mode: dnsrr")]),e._v(" -DNSè½®è¯¢ï¼ˆDNSRRï¼‰æœåŠ¡å‘ç°ä¸ä½¿ç”¨å•ä¸ªè™šæ‹ŸIPã€‚ Dockerè®¾ç½®æœåŠ¡çš„DNSæ¡ç›®ï¼Œä»¥ä¾¿å¯¹æœåŠ¡åç§°çš„DNSæŸ¥è¯¢è¿”å›IPåœ°å€åˆ—è¡¨ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯ç›´æ¥è¿æ¥åˆ°å…¶ä¸­ä¹‹ä¸€ã€‚ åœ¨æƒ³è¦ä½¿ç”¨è‡ªå·±çš„è´Ÿè½½å¹³è¡¡å™¨æˆ–æ··åˆWindowså’ŒLinuxåº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹ï¼ŒDNSè½®è¯¢å¾ˆæœ‰ç”¨ã€‚")])])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\n\nservices:\n  wordpress:\n    image: wordpress\n    ports:\n      - "8080:80"\n    networks:\n      - overlay\n    deploy:\n      mode: replicated\n      replicas: 2\n      endpoint_mode: vip\n\n  mysql:\n    image: mysql\n    volumes:\n       - db-data:/var/lib/mysql/data\n    networks:\n       - overlay\n    deploy:\n      mode: replicated\n      replicas: 2\n      endpoint_mode: dnsrr\n\nvolumes:\n  db-data:\n\nnetworks:\n  overlay:\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br"),n("span",{staticClass:"line-number"},[e._v("23")]),n("br"),n("span",{staticClass:"line-number"},[e._v("24")]),n("br"),n("span",{staticClass:"line-number"},[e._v("25")]),n("br"),n("span",{staticClass:"line-number"},[e._v("26")]),n("br"),n("span",{staticClass:"line-number"},[e._v("27")]),n("br"),n("span",{staticClass:"line-number"},[e._v("28")]),n("br"),n("span",{staticClass:"line-number"},[e._v("29")]),n("br"),n("span",{staticClass:"line-number"},[e._v("30")]),n("br"),n("span",{staticClass:"line-number"},[e._v("31")]),n("br")])]),n("p",[e._v("çš„é€‰é¡¹ "),n("code",[e._v("endpoint_mode")]),e._v(" è¿˜å¯ä»¥åœ¨ç¾¤é›†æ¨¡å¼CLIå‘½ä»¤ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/service_create/",target:"_blank",rel:"noopener noreferrer"}},[e._v("docker service create"),n("OutboundLink")],1),e._v(" ä¸Šç”¨ä½œæ ‡å¿— ã€‚ æœ‰å…³æ‰€æœ‰swarmç›¸å…³ "),n("code",[e._v("docker")]),e._v(" å‘½ä»¤ çš„å¿«é€Ÿåˆ—è¡¨ ï¼Œè¯·å‚é˜… "),n("a",{attrs:{href:"https://docs.docker.com/engine/swarm/#swarm-mode-key-concepts-and-tutorial",target:"_blank",rel:"noopener noreferrer"}},[e._v("Swarmæ¨¡å¼CLIå‘½ä»¤"),n("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),n("p",[e._v("è¦äº†è§£æœ‰å…³åœ¨ç¾¤é›†æ¨¡å¼ä¸‹è¿›è¡ŒæœåŠ¡å‘ç°å’Œè”ç½‘çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…åœ¨ç¾¤é›†æ¨¡å¼ä¸‹ "),n("a",{attrs:{href:"https://docs.docker.com/engine/swarm/networking/#configure-service-discovery",target:"_blank",rel:"noopener noreferrer"}},[e._v("é…ç½®æœåŠ¡å‘ç°"),n("OutboundLink")],1),e._v(" ä¸»é¢˜ã€‚")]),e._v(" "),n("h4",{attrs:{id:"æ ‡ç­¾-2"}},[e._v("æ ‡ç­¾")]),e._v(" "),n("p",[e._v("æŒ‡å®šæœåŠ¡æ ‡ç­¾ã€‚ è¿™äº›æ ‡ç­¾ "),n("em",[e._v("ä»…")]),e._v(" åœ¨æœåŠ¡ä¸Šè®¾ç½®ï¼Œ "),n("em",[e._v("è€Œä¸")]),e._v(" åœ¨æœåŠ¡çš„ä»»ä½•å®¹å™¨ä¸Šè®¾ç½®ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  web:\n    image: web\n    deploy:\n      labels:\n        com.example.description: "This label will appear on the web service"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br")])]),n("p",[e._v("åœ¨å®¹å™¨ä¸Šçš„æ ‡ç­¾é›†ä»£æ›¿ï¼Œä½¿ç”¨ "),n("code",[e._v("labels")]),e._v(" çš„é”®å¤– "),n("code",[e._v("deploy")]),e._v(" ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  web:\n    image: web\n    labels:\n      com.example.description: "This label will appear on all containers for the web service"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br")])]),n("h4",{attrs:{id:"æ¨¡å¼"}},[e._v("æ¨¡å¼")]),e._v(" "),n("p",[e._v("ä»»ä¸€ "),n("code",[e._v("global")]),e._v(" ï¼ˆæ­£å¥½ä¸€ä¸ªæ¯ç¾¤èŠ‚ç‚¹å®¹å™¨ï¼‰æˆ– "),n("code",[e._v("replicated")]),e._v(" ï¼ˆå®¹å™¨çš„æŒ‡å®šæ•°é‡ï¼‰ã€‚ é»˜è®¤å€¼ä¸º "),n("code",[e._v("replicated")]),e._v(" ã€‚ ï¼ˆè¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… "),n("a",{attrs:{href:"https://docs.docker.com/engine/swarm/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç¾¤é›†"),n("OutboundLink")],1),e._v(" ä¸»é¢˜ ä¸­çš„ "),n("a",{attrs:{href:"https://docs.docker.com/engine/swarm/how-swarm-mode-works/services/#replicated-and-global-services",target:"_blank",rel:"noopener noreferrer"}},[e._v("å¤åˆ¶æœåŠ¡å’Œå…¨å±€æœåŠ¡"),n("OutboundLink")],1),e._v(" ã€‚ï¼‰"),n("a",{attrs:{href:"https://docs.docker.com/engine/swarm/",target:"_blank",rel:"noopener noreferrer"}},[n("OutboundLink")],1)]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  worker:\n    image: dockersamples/examplevotingapp_worker\n    deploy:\n      mode: global\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br")])]),n("h4",{attrs:{id:"æ”¾ç½®"}},[e._v("æ”¾ç½®")]),e._v(" "),n("p",[e._v("æŒ‡å®šçº¦æŸå’Œé¦–é€‰é¡¹çš„ä½ç½®ã€‚ æœ‰å…³è¯­æ³•ä»¥åŠ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/service_create/#specify-service-constraints---constraint",target:"_blank",rel:"noopener noreferrer"}},[e._v("çº¦æŸ"),n("OutboundLink")],1),e._v(" ï¼Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/service_create/#specify-service-placement-preferences---placement-pref",target:"_blank",rel:"noopener noreferrer"}},[e._v("é¦–é€‰é¡¹çš„"),n("OutboundLink")],1),e._v(" å¯ç”¨ç±»å‹çš„å®Œæ•´è¯´æ˜ ï¼Œä»¥åŠ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/service_create/#specify-maximum-replicas-per-node---replicas-max-per-node",target:"_blank",rel:"noopener noreferrer"}},[e._v("æŒ‡å®šæ¯ä¸ªèŠ‚ç‚¹çš„æœ€å¤§å‰¯æœ¬æ•°"),n("OutboundLink")],1),e._v(" ï¼Œ è¯·å‚é˜…dockeræœåŠ¡createæ–‡æ¡£ã€‚"),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/service_create/#specify-maximum-replicas-per-node---replicas-max-per-node",target:"_blank",rel:"noopener noreferrer"}},[n("OutboundLink")],1)]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  db:\n    image: postgres\n    deploy:\n      placement:\n        constraints:\n          - "node.role==manager"\n          - "engine.labels.operatingsystem==ubuntu 18.04"\n        preferences:\n          - spread: node.labels.zone\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br")])]),n("h4",{attrs:{id:"max-replicas-per-node"}},[e._v("max_replicas_per_node")]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-38",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.8ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")])]),e._v(" "),n("p",[e._v("å¦‚æœæœåŠ¡æ˜¯ "),n("code",[e._v("replicated")]),e._v(" ï¼ˆé»˜è®¤ï¼‰æœåŠ¡ï¼Œè¯· "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/service_create/#specify-maximum-replicas-per-node---replicas-max-per-node",target:"_blank",rel:"noopener noreferrer"}},[e._v("é™åˆ¶"),n("OutboundLink")],1),e._v(" å¯éšæ—¶åœ¨èŠ‚ç‚¹ä¸Šè¿è¡Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/service_create/#specify-maximum-replicas-per-node---replicas-max-per-node",target:"_blank",rel:"noopener noreferrer"}},[e._v("çš„å‰¯æœ¬æ•°"),n("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),n("p",[e._v("å½“è¯·æ±‚çš„ä»»åŠ¡å¤šäºè¿è¡ŒèŠ‚ç‚¹æ—¶ï¼Œå°† "),n("code",[e._v("no suitable node (max replicas per node limit exceed)")]),e._v(" å¼•å‘ é”™è¯¯ ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  worker:\n    image: dockersamples/examplevotingapp_worker\n    networks:\n      - frontend\n      - backend\n    deploy:\n      mode: replicated\n      replicas: 6\n      placement:\n        max_replicas_per_node: 1\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br")])]),n("h4",{attrs:{id:"å¤åˆ¶å“"}},[e._v("å¤åˆ¶å“")]),e._v(" "),n("p",[e._v("å¦‚æœæœåŠ¡æ˜¯ "),n("code",[e._v("replicated")]),e._v(" ï¼ˆé»˜è®¤ï¼‰æœåŠ¡ï¼Œè¯·æŒ‡å®šåœ¨ä»»ä½•ç»™å®šæ—¶é—´åº”è¿è¡Œçš„å®¹å™¨æ•°ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  worker:\n    image: dockersamples/examplevotingapp_worker\n    networks:\n      - frontend\n      - backend\n    deploy:\n      mode: replicated\n      replicas: 6\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br")])]),n("h4",{attrs:{id:"èµ„æº"}},[e._v("èµ„æº")]),e._v(" "),n("p",[e._v("é…ç½®èµ„æºçº¦æŸã€‚")]),e._v(" "),n("blockquote",[n("p",[e._v("æ›´æ”¹äº†æ’°å†™æ–‡ä»¶ç‰ˆæœ¬3")]),e._v(" "),n("p",[e._v("è¯¥ "),n("code",[e._v("resources")]),e._v(" éƒ¨åˆ†å–ä»£äº† "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-file-v2/#cpu-and-other-resources",target:"_blank",rel:"noopener noreferrer"}},[e._v("æ—§çš„èµ„æºçº¦æŸé€‰é¡¹"),n("OutboundLink")],1),e._v(" åœ¨æ’°å†™ç¬¬3ç‰ˆä¹‹å‰çš„æ–‡ä»¶ï¼ˆ "),n("code",[e._v("cpu_shares")]),e._v(" ï¼Œ "),n("code",[e._v("cpu_quota")]),e._v(" ï¼Œ "),n("code",[e._v("cpuset")]),e._v(" ï¼Œ "),n("code",[e._v("mem_limit")]),e._v(" ï¼Œ "),n("code",[e._v("memswap_limit")]),e._v(" ï¼Œ "),n("code",[e._v("mem_swappiness")]),e._v(" ï¼‰ã€‚ è¯·å‚é˜… "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#upgrading",target:"_blank",rel:"noopener noreferrer"}},[e._v("å°†ç‰ˆæœ¬2.xå‡çº§åˆ°3.xï¼Œ"),n("OutboundLink")],1),e._v(" ä»¥äº†è§£ç‰ˆæœ¬2å’Œç‰ˆæœ¬3çš„æ’°å†™æ–‡ä»¶æ ¼å¼ä¹‹é—´çš„å·®å¼‚ã€‚")])]),e._v(" "),n("p",[e._v("å…¶ä¸­æ¯ä¸ªéƒ½æ˜¯ä¸€ä¸ªå€¼ï¼Œç±»ä¼¼äºå…¶ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/service_create/",target:"_blank",rel:"noopener noreferrer"}},[e._v("dockeræœåŠ¡create"),n("OutboundLink")],1),e._v(" å¯¹åº”é¡¹ã€‚")]),e._v(" "),n("p",[e._v("åœ¨æ­¤ä¸€èˆ¬ç¤ºä¾‹ä¸­ï¼Œ "),n("code",[e._v("redis")]),e._v(" æœåŠ¡è¢«é™åˆ¶ä¸ºä½¿ç”¨ä¸è¶…è¿‡50Mçš„å†…å­˜å’Œ "),n("code",[e._v("0.50")]),e._v(" ï¼ˆå•æ ¸çš„50ï¼…ï¼‰å¯ç”¨çš„å¤„ç†æ—¶é—´ï¼ˆCPUï¼‰ï¼Œå¹¶ä¸”å…·æœ‰ ä¿ç•™ "),n("code",[e._v("20M")]),e._v(" çš„å†…å­˜å’Œ "),n("code",[e._v("0.25")]),e._v(" CPUæ—¶é—´ï¼ˆå§‹ç»ˆå¯ç”¨ï¼‰ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("version: \"3.8\"\nservices:\n  redis:\n    image: redis:alpine\n    deploy:\n      resources:\n        limits:\n          cpus: '0.50'\n          memory: 50M\n        reservations:\n          cpus: '0.25'\n          memory: 20M\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br")])]),n("p",[e._v("ä»¥ä¸‹ä¸»é¢˜æè¿°äº†å¯ç”¨äºè®¾ç½®ç¾¤ä¸­æœåŠ¡æˆ–å®¹å™¨çš„èµ„æºçº¦æŸçš„å¯ç”¨é€‰é¡¹ã€‚")]),e._v(" "),n("blockquote",[n("p",[e._v("å¯»æ‰¾ç”¨äºåœ¨éç¾¤æ¨¡å¼å®¹å™¨ä¸Šè®¾ç½®èµ„æºçš„é€‰é¡¹å—ï¼Ÿ")]),e._v(" "),n("p",[e._v("æ­¤å¤„æè¿°çš„é€‰é¡¹ç‰¹å®šäº "),n("code",[e._v("deploy")]),e._v(" é”®å’Œç¾¤æ¨¡å¼ã€‚ å¦‚æœè¦åœ¨éç¾¤é›†éƒ¨ç½²ä¸­è®¾ç½®èµ„æºé™åˆ¶ï¼Œè¯·ä½¿ç”¨ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-file-v2/#cpu-and-other-resources",target:"_blank",rel:"noopener noreferrer"}},[e._v("Composeæ–‡ä»¶æ ¼å¼ç‰ˆæœ¬2 CPUï¼Œå†…å­˜å’Œå…¶ä»–èµ„æºé€‰é¡¹"),n("OutboundLink")],1),e._v(" ã€‚ å¦‚æœæ‚¨è¿˜æœ‰å…¶ä»–é—®é¢˜ï¼Œè¯·å‚é˜…æœ‰å…³GitHubé—®é¢˜ "),n("a",{attrs:{href:"https://github.com/docker/compose/issues/4513",target:"_blank",rel:"noopener noreferrer"}},[e._v("docker / compose / 4513"),n("OutboundLink")],1),e._v(" çš„è®¨è®º ã€‚")])]),e._v(" "),n("h5",{attrs:{id:"å†…å­˜ä¸è¶³å¼‚å¸¸ï¼ˆoomeï¼‰"}},[e._v("å†…å­˜ä¸è¶³å¼‚å¸¸ï¼ˆOOMEï¼‰")]),e._v(" "),n("p",[e._v("å¦‚æœæ‚¨çš„æœåŠ¡æˆ–å®¹å™¨å°è¯•ä½¿ç”¨çš„å†…å­˜è¶…è¿‡ç³»ç»Ÿå¯ç”¨çš„å†…å­˜ï¼Œåˆ™å¯èƒ½ä¼šé‡åˆ°å†…å­˜ä¸è¶³å¼‚å¸¸ï¼ˆOOMEï¼‰ï¼Œå¹¶ä¸”å®¹å™¨æˆ–Dockerå®ˆæŠ¤ç¨‹åºå¯èƒ½ä¼šè¢«å†…æ ¸OOMæ€æ‰‹æ€æ­»ã€‚ ä¸ºé˜²æ­¢è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œè¯·ç¡®ä¿æ‚¨çš„åº”ç”¨ç¨‹åºåœ¨å…·æœ‰è¶³å¤Ÿå†…å­˜çš„ä¸»æœºä¸Šè¿è¡Œï¼Œâ€‹â€‹è¯·å‚é˜… "),n("a",{attrs:{href:"https://docs.docker.com/config/containers/resource_constraints/#understand-the-risks-of-running-out-of-memory",target:"_blank",rel:"noopener noreferrer"}},[e._v("äº†è§£"),n("OutboundLink")],1),e._v(" å†…å­˜ä¸è¶³ "),n("a",{attrs:{href:"https://docs.docker.com/config/containers/resource_constraints/#understand-the-risks-of-running-out-of-memory",target:"_blank",rel:"noopener noreferrer"}},[e._v("çš„é£é™©"),n("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),n("h4",{attrs:{id:"restart-policy"}},[e._v("restart_policy")]),e._v(" "),n("p",[e._v("é…ç½®æ˜¯å¦ä»¥åŠå¦‚ä½•åœ¨é€€å‡ºå®¹å™¨æ—¶é‡æ–°å¯åŠ¨å®¹å™¨ã€‚ æ›¿æ¢ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-file-v2/#orig-resources",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("restart")]),n("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("condition")]),e._v(" ï¼šå…¶ä¸€ "),n("code",[e._v("none")]),e._v(" ï¼Œ "),n("code",[e._v("on-failure")]),e._v(" æˆ–è€… "),n("code",[e._v("any")]),e._v(" ï¼ˆé»˜è®¤å€¼ï¼š "),n("code",[e._v("any")]),e._v(" ï¼‰ã€‚")]),e._v(" "),n("li",[n("code",[e._v("delay")]),e._v(" ï¼šé‡æ–°å¯åŠ¨å°è¯•ä¹‹é—´ç­‰å¾…çš„ "),n("a",{attrs:{href:"#specifying-durations"}},[e._v("æ—¶é—´")]),e._v(" ï¼ŒæŒ‡å®šä¸º "),n("a",{attrs:{href:"#specifying-durations"}},[e._v("æŒç»­æ—¶é—´")]),e._v(" ï¼ˆé»˜è®¤å€¼ï¼š0ï¼‰ã€‚")]),e._v(" "),n("li",[n("code",[e._v("max_attempts")]),e._v(" ï¼šæ”¾å¼ƒä¹‹å‰å°è¯•é‡æ–°å¯åŠ¨å®¹å™¨çš„æ¬¡æ•°ï¼ˆé»˜è®¤å€¼ï¼šæ°¸ä¸æ”¾å¼ƒï¼‰ã€‚ å¦‚æœé‡å¯æœªåœ¨configureå†…æˆåŠŸå®Œæˆ "),n("code",[e._v("window")]),e._v(" ï¼Œåˆ™æ­¤å°è¯•ä¸ä¼šè®¡å…¥é…ç½® "),n("code",[e._v("max_attempts")]),e._v(" å€¼ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœ "),n("code",[e._v("max_attempts")]),e._v(" è®¾ç½®ä¸ºâ€œ 2â€ï¼Œå¹¶ä¸”ç¬¬ä¸€æ¬¡å°è¯•é‡å¯å¤±è´¥ï¼Œåˆ™å¯èƒ½å°è¯•ä¸¤æ¬¡ä»¥ä¸Šé‡å¯ã€‚")]),e._v(" "),n("li",[n("code",[e._v("window")]),e._v(" ï¼šå†³å®šé‡æ–°å¯åŠ¨æ˜¯å¦æˆåŠŸä¹‹å‰è¦ç­‰å¾…çš„ "),n("a",{attrs:{href:"#specifying-durations"}},[e._v("æ—¶é—´")]),e._v(" ï¼ŒæŒ‡å®šä¸º "),n("a",{attrs:{href:"#specifying-durations"}},[e._v("æŒç»­æ—¶é—´")]),e._v(" ï¼ˆé»˜è®¤å€¼ï¼šç«‹å³å†³å®šï¼‰ã€‚")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  redis:\n    image: redis:alpine\n    deploy:\n      restart_policy:\n        condition: on-failure\n        delay: 5s\n        max_attempts: 3\n        window: 120s\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br")])]),n("h4",{attrs:{id:"rollback-config"}},[e._v("rollback_config")]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-37",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.7ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")])]),e._v(" "),n("p",[e._v("é…ç½®åœ¨æ›´æ–°å¤±è´¥çš„æƒ…å†µä¸‹åº”å¦‚ä½•å›æ»šæœåŠ¡ã€‚")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("parallelism")]),e._v(" ï¼šä¸€æ¬¡è¦å›æ»šçš„å®¹å™¨æ•°ã€‚ å¦‚æœè®¾ç½®ä¸º0ï¼Œåˆ™æ‰€æœ‰å®¹å™¨å°†åŒæ—¶å›æ»šã€‚")]),e._v(" "),n("li",[n("code",[e._v("delay")]),e._v(" ï¼šæ¯ä¸ªå®¹å™¨ç»„å›æ»šä¹‹é—´ç­‰å¾…çš„æ—¶é—´ï¼ˆé»˜è®¤ä¸º0sï¼‰ã€‚")]),e._v(" "),n("li",[n("code",[e._v("failure_action")]),e._v(" ï¼šå¦‚æœå›æ»šå¤±è´¥ï¼Œè¯¥æ€ä¹ˆåŠã€‚ å…¶ä¸­ä¸€ä¸ª "),n("code",[e._v("continue")]),e._v(" æˆ–è€… "),n("code",[e._v("pause")]),e._v(" ï¼ˆé»˜è®¤ "),n("code",[e._v("pause")]),e._v(" ï¼‰")]),e._v(" "),n("li",[n("code",[e._v("monitor")]),e._v(" ï¼šæ›´æ–°æ¯ä¸ªä»»åŠ¡ä»¥ç›‘è§†å¤±è´¥åçš„æŒç»­æ—¶é—´ "),n("code",[e._v("(ns|us|ms|s|m|h)")]),e._v(" ï¼ˆé»˜è®¤ä¸º0sï¼‰ã€‚")]),e._v(" "),n("li",[n("code",[e._v("max_failure_ratio")]),e._v(" ï¼šåœ¨å›æ»šæœŸé—´å¯ä»¥å®¹å¿çš„æ•…éšœç‡ï¼ˆé»˜è®¤ä¸º0ï¼‰ã€‚")]),e._v(" "),n("li",[n("code",[e._v("order")]),e._v(" ï¼šå›æ»šæœŸé—´çš„æ“ä½œé¡ºåºã€‚ å…¶ä¸­ä¸€ä¸ª "),n("code",[e._v("stop-first")]),e._v(" ï¼ˆæ—§ä»»åŠ¡ï¼Œå¼€å§‹æ–°çš„ä¸€ä¸ªå‰åœæ­¢ï¼‰ï¼Œæˆ–è€… "),n("code",[e._v("start-first")]),e._v(" ï¼ˆæ–°çš„ä»»åŠ¡é¦–å…ˆå¯åŠ¨ï¼Œå¹¶ä¸”æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ç®€å•åœ°é‡å ï¼‰ï¼ˆé»˜è®¤ "),n("code",[e._v("stop-first")]),e._v(" ï¼‰ã€‚")])]),e._v(" "),n("h4",{attrs:{id:"update-config"}},[e._v("update_config")]),e._v(" "),n("p",[e._v("é…ç½®åº”å¦‚ä½•æ›´æ–°æœåŠ¡ã€‚ å¯¹äºé…ç½®æ»šåŠ¨æ›´æ–°å¾ˆæœ‰ç”¨ã€‚")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("parallelism")]),e._v(" ï¼šä¸€æ¬¡æ›´æ–°çš„å®¹å™¨æ•°ã€‚")]),e._v(" "),n("li",[n("code",[e._v("delay")]),e._v(" ï¼šåœ¨æ›´æ–°ä¸€ç»„å®¹å™¨ä¹‹é—´ç­‰å¾…çš„æ—¶é—´ã€‚")]),e._v(" "),n("li",[n("code",[e._v("failure_action")]),e._v(" ï¼šå¦‚æœæ›´æ–°å¤±è´¥ï¼Œè¯¥æ€ä¹ˆåŠã€‚ å…¶ä¸­ä¸€ä¸ª "),n("code",[e._v("continue")]),e._v(" ï¼Œ "),n("code",[e._v("rollback")]),e._v(" æˆ–è€… "),n("code",[e._v("pause")]),e._v(" ï¼ˆé»˜è®¤ï¼š "),n("code",[e._v("pause")]),e._v(" ï¼‰ã€‚")]),e._v(" "),n("li",[n("code",[e._v("monitor")]),e._v(" ï¼šæ›´æ–°æ¯ä¸ªä»»åŠ¡ä»¥ç›‘è§†å¤±è´¥åçš„æŒç»­æ—¶é—´ "),n("code",[e._v("(ns|us|ms|s|m|h)")]),e._v(" ï¼ˆé»˜è®¤ä¸º0sï¼‰ã€‚")]),e._v(" "),n("li",[n("code",[e._v("max_failure_ratio")]),e._v(" ï¼šæ›´æ–°æœŸé—´å¯ä»¥å®¹å¿çš„æ•…éšœç‡ã€‚")]),e._v(" "),n("li",[n("code",[e._v("order")]),e._v(" ï¼šæ›´æ–°æœŸé—´çš„æ“ä½œé¡ºåºã€‚ å…¶ä¸­ä¸€ä¸ª "),n("code",[e._v("stop-first")]),e._v(" ï¼ˆæ—§ä»»åŠ¡ï¼Œå¼€å§‹æ–°çš„ä¸€ä¸ªå‰åœæ­¢ï¼‰ï¼Œæˆ–è€… "),n("code",[e._v("start-first")]),e._v(" ï¼ˆæ–°çš„ä»»åŠ¡é¦–å…ˆå¯åŠ¨ï¼Œå¹¶ä¸”æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ç®€å•é‡å ï¼‰ï¼ˆé»˜è®¤ "),n("code",[e._v("stop-first")]),e._v(" ï¼‰ "),n("strong",[e._v("æ³¨")]),e._v(" ï¼šä»…æ”¯æŒV3.4åŠæ›´é«˜ç‰ˆæœ¬ã€‚")])]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-34",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.4ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")]),e._v(" "),n("p",[n("code",[e._v("order")]),e._v(" v3.4åŠæ›´é«˜ç‰ˆæœ¬çš„æ’°å†™æ–‡ä»¶æ ¼å¼ä»…æ”¯æŒ è¯¥ é€‰é¡¹ã€‚")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  vote:\n    image: dockersamples/examplevotingapp_vote:before\n    depends_on:\n      - redis\n    deploy:\n      replicas: 2\n      update_config:\n        parallelism: 2\n        delay: 10s\n        order: stop-first\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br")])]),n("h4",{attrs:{id:"ä¸æ”¯æŒ-docker-stack-deploy"}},[e._v("ä¸æ”¯æŒ "),n("code",[e._v("docker stack deploy")])]),e._v(" "),n("p",[e._v("ä¸‹é¢çš„å­é€‰é¡¹ï¼ˆæ”¯æŒ "),n("code",[e._v("docker-compose up")]),e._v(" å’Œ "),n("code",[e._v("docker-compose run")]),e._v(" ï¼‰æ˜¯ "),n("em",[e._v("ä¸æ”¯æŒ")]),e._v(" çš„ "),n("code",[e._v("docker stack deploy")]),e._v(" æˆ– "),n("code",[e._v("deploy")]),e._v(" å…³é”®çš„ã€‚")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"#build"}},[e._v("å»ºç«‹")])]),e._v(" "),n("li",[n("a",{attrs:{href:"#cgroup_parent"}},[e._v("cgroup_parent")])]),e._v(" "),n("li",[n("a",{attrs:{href:"#container_name"}},[e._v("container_name")])]),e._v(" "),n("li",[n("a",{attrs:{href:"#devices"}},[e._v("è®¾å¤‡")])]),e._v(" "),n("li",[n("a",{attrs:{href:"#tmpfs"}},[e._v("tmpfs")])]),e._v(" "),n("li",[n("a",{attrs:{href:"#external_links"}},[e._v("å¤–éƒ¨é“¾æ¥")])]),e._v(" "),n("li",[n("a",{attrs:{href:"#links"}},[e._v("é“¾æ¥")])]),e._v(" "),n("li",[n("a",{attrs:{href:"#network_mode"}},[e._v("ç½‘ç»œæ¨¡å¼")])]),e._v(" "),n("li",[n("a",{attrs:{href:"#restart"}},[e._v("é‡æ–°å¼€å§‹")])]),e._v(" "),n("li",[n("a",{attrs:{href:"#security_opt"}},[e._v("security_opt")])]),e._v(" "),n("li",[n("a",{attrs:{href:"#userns_mode"}},[e._v("userns_mode")])])]),e._v(" "),n("blockquote",[n("p",[e._v("å°è´¹")]),e._v(" "),n("p",[e._v("è¯·å‚é˜…æœ‰å…³ "),n("a",{attrs:{href:"#volumes-for-services-swarms-and-stack-files"}},[e._v("å¦‚ä½•ä¸ºæœåŠ¡ï¼Œç¾¤é›†å’Œdocker-stack.ymlæ–‡ä»¶é…ç½®å·")]),e._v(" çš„éƒ¨åˆ† ã€‚ å· "),n("em",[e._v("æ˜¯")]),e._v(" å—æ”¯æŒçš„ï¼Œä½†æ˜¯è¦ä¸ç¾¤é›†å’ŒæœåŠ¡ä¸€èµ·ä½¿ç”¨ï¼Œå¿…é¡»å°†å®ƒä»¬é…ç½®ä¸ºå‘½åå·æˆ–ä¸å—çº¦æŸäºæœ‰æƒè®¿é—®å¿…éœ€å·çš„èŠ‚ç‚¹çš„æœåŠ¡å…³è”ã€‚")])]),e._v(" "),n("h3",{attrs:{id:"è®¾å¤‡-ğŸ”—"}},[e._v("è®¾å¤‡ "),n("a",{attrs:{href:"#devices"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("è®¾å¤‡æ˜ å°„åˆ—è¡¨ã€‚ ä½¿ç”¨ä¸ "),n("code",[e._v("--device")]),e._v(" docker client createé€‰é¡¹ ç›¸åŒçš„æ ¼å¼ ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('devices:\n  - "/dev/ttyUSB0:/dev/ttyUSB0"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨é›†ç¾¤æ¨¡å¼ä¸‹éƒ¨ç½²å †æ ˆ"),n("OutboundLink")],1),e._v(" "),n("code",[e._v("devices")]),e._v(" æ—¶ï¼Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å°†"),n("OutboundLink")],1),e._v(" å¿½ç•¥ è¯¥ é€‰é¡¹"),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[n("OutboundLink")],1)])]),e._v(" "),n("h3",{attrs:{id:"dns-ğŸ”—"}},[e._v("DNS "),n("a",{attrs:{href:"#dns"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("è‡ªå®šä¹‰DNSæœåŠ¡å™¨ã€‚ å¯ä»¥æ˜¯å•ä¸ªå€¼æˆ–åˆ—è¡¨ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("dns: 8.8.8.8\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("dns:\n  - 8.8.8.8\n  - 9.9.9.9\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("h3",{attrs:{id:"dns-search-ğŸ”—"}},[e._v("dns_search "),n("a",{attrs:{href:"#dns_search"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("è‡ªå®šä¹‰DNSæœç´¢åŸŸã€‚ å¯ä»¥æ˜¯å•ä¸ªå€¼æˆ–åˆ—è¡¨ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("dns_search: example.com\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("dns_search:\n  - dc1.example.com\n  - dc2.example.com\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("h3",{attrs:{id:"å…¥å£ç‚¹-ğŸ”—"}},[e._v("å…¥å£ç‚¹ "),n("a",{attrs:{href:"#entrypoint"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("è¦†ç›–é»˜è®¤å…¥å£ç‚¹ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("entrypoint: /code/entrypoint.sh\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("p",[e._v("å…¥å£ç‚¹ä¹Ÿå¯ä»¥æ˜¯åˆ—è¡¨ï¼Œç±»ä¼¼äº "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/builder/#entrypoint",target:"_blank",rel:"noopener noreferrer"}},[e._v("dockerfile"),n("OutboundLink")],1),e._v(" ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('entrypoint: ["php", "-d", "memory_limit=-1", "vendor/bin/phpunit"]\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("blockquote",[n("p",[n("strong",[e._v("æ³¨æ„")])]),e._v(" "),n("p",[e._v("è®¾ç½® "),n("code",[e._v("entrypoint")]),e._v(" ä¸¤è€…éƒ½å°†ä½¿ç”¨ "),n("code",[e._v("ENTRYPOINT")]),e._v(" DockerfileæŒ‡ä»¤ è¦†ç›–æœåŠ¡æ˜ åƒä¸Š è®¾ç½®çš„ ä»»ä½•é»˜è®¤å…¥å£ç‚¹ ï¼Œ "),n("em",[e._v("å¹¶")]),e._v(" æ¸…é™¤æ˜ åƒä¸Šçš„ä»»ä½•é»˜è®¤å‘½ä»¤-è¿™æ„å‘³ç€å¦‚æœ "),n("code",[e._v("CMD")]),e._v(" Dockerfileä¸­ æœ‰ æŒ‡ä»¤ï¼Œåˆ™å°†å…¶å¿½ç•¥ã€‚")])]),e._v(" "),n("h3",{attrs:{id:"env-file-ğŸ”—"}},[e._v("env_file "),n("a",{attrs:{href:"#env_file"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("ä»æ–‡ä»¶æ·»åŠ ç¯å¢ƒå˜é‡ã€‚ å¯ä»¥æ˜¯å•ä¸ªå€¼æˆ–åˆ—è¡¨ã€‚")]),e._v(" "),n("p",[e._v("å¦‚æœæ‚¨ä½¿ç”¨æŒ‡å®šäº†Composeæ–‡ä»¶ "),n("code",[e._v("docker-compose -f FILE")]),e._v(" ï¼Œåˆ™in "),n("code",[e._v("env_file")]),e._v(" çš„ è·¯å¾„ ç›¸å¯¹äºè¯¥æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ã€‚")]),e._v(" "),n("p",[e._v("åœ¨ "),n("a",{attrs:{href:"#environment"}},[e._v("ç¯å¢ƒ")]),e._v(" éƒ¨åˆ†ä¸­ å£°æ˜çš„ç¯å¢ƒå˜é‡å°† "),n("em",[e._v("è¦†ç›–")]),e._v(" è¿™äº›å€¼â€“å³ä½¿è¿™äº›å€¼ä¸ºç©ºæˆ–æœªå®šä¹‰ï¼Œä¹Ÿæ˜¯å¦‚æ­¤ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("env_file: .env\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("env_file:\n  - ./common.env\n  - ./apps/web.env\n  - /opt/runtime_opts.env\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("p",[e._v("ComposeæœŸæœ›ç¯å¢ƒæ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œéƒ½é‡‡ç”¨ "),n("code",[e._v("VAR=VAL")]),e._v(" æ ¼å¼ã€‚ ä»¥å¼€å¤´çš„è¡Œ "),n("code",[e._v("#")]),e._v(" è¢«è§†ä¸ºæ³¨é‡Šï¼Œå¹¶è¢«å¿½ç•¥ã€‚ ç©ºè¡Œä¹Ÿå°†è¢«å¿½ç•¥ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("# Set Rails/Rack environment\nRACK_ENV=development\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("blockquote",[n("p",[n("strong",[e._v("æ³¨æ„")])]),e._v(" "),n("p",[e._v("å¦‚æœæ‚¨çš„æœåŠ¡æŒ‡å®šäº† "),n("a",{attrs:{href:"#build"}},[e._v("æ„å»º")]),e._v(" é€‰é¡¹ï¼Œåˆ™ åœ¨æ„å»ºè¿‡ç¨‹ ä¸­ "),n("em",[e._v("ä¸ä¼š")]),e._v(" è‡ªåŠ¨æ˜¾ç¤º ç¯å¢ƒæ–‡ä»¶ä¸­å®šä¹‰çš„å˜é‡ ã€‚ ä½¿ç”¨çš„ "),n("a",{attrs:{href:"#args"}},[e._v("args")]),e._v(" å­é€‰é¡¹ "),n("code",[e._v("build")]),e._v(" æ¥å®šä¹‰æ„å»ºæ—¶ç¯å¢ƒå˜é‡ã€‚")])]),e._v(" "),n("p",[e._v("çš„å€¼æŒ‰ "),n("code",[e._v("VAL")]),e._v(" åŸæ ·ä½¿ç”¨ï¼Œæ ¹æœ¬æ²¡æœ‰ä¿®æ”¹ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœè¯¥å€¼ç”¨å¼•å·å¼•èµ·æ¥ï¼ˆé€šå¸¸æ˜¯shellå˜é‡ï¼‰ï¼Œåˆ™å¼•å·åŒ…å«åœ¨ä¼ é€’ç»™Composeçš„å€¼ä¸­ã€‚")]),e._v(" "),n("p",[e._v("è¯·è®°ä½ï¼Œ "),n("em",[e._v("åˆ—è¡¨ä¸­æ–‡ä»¶çš„é¡ºåºå¯¹äºç¡®å®šåˆ†é…ç»™å¤šæ¬¡æ˜¾ç¤ºçš„å˜é‡çš„å€¼å¾ˆé‡è¦")]),e._v(" ã€‚ åˆ—è¡¨ä¸­çš„æ–‡ä»¶ä»ä¸Šåˆ°ä¸‹è¿›è¡Œå¤„ç†ã€‚ å¯¹äºåœ¨fileä¸­æŒ‡å®šå¹¶åœ¨fileä¸­ "),n("code",[e._v("a.env")]),e._v(" åˆ†é…äº†ä¸åŒå€¼ çš„ç›¸åŒå˜é‡ "),n("code",[e._v("b.env")]),e._v(" ï¼Œå¦‚æœ "),n("code",[e._v("b.env")]),e._v(" åœ¨ä¸‹é¢ï¼ˆä¹‹åï¼‰åˆ—å‡ºï¼Œåˆ™æ¥è‡ªæ ‡å‡†ä½çš„å€¼ "),n("code",[e._v("b.env")]),e._v(" ã€‚ ä¾‹å¦‚ï¼Œåœ¨ä¸­ç»™å‡ºä»¥ä¸‹å£°æ˜ "),n("code",[e._v("docker-compose.yml")]),e._v(" ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("services:\n  some-service:\n    env_file:\n      - a.env\n      - b.env\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("p",[e._v("å’Œä»¥ä¸‹æ–‡ä»¶ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("# a.env\nVAR=1\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("p",[e._v("å’Œ")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("# b.env\nVAR=hello\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("p",[n("code",[e._v("$VAR")]),e._v(" æ˜¯ "),n("code",[e._v("hello")]),e._v(" ã€‚")]),e._v(" "),n("h3",{attrs:{id:"ç¯å¢ƒ-ğŸ”—"}},[e._v("ç¯å¢ƒ "),n("a",{attrs:{href:"#environment"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æ·»åŠ ç¯å¢ƒå˜é‡ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨æ•°ç»„æˆ–å­—å…¸ã€‚ ä»»ä½•å¸ƒå°”å€¼ï¼ˆtrueï¼Œfalseï¼Œyesï¼Œnoï¼‰éƒ½éœ€è¦ç”¨å¼•å·å¼•èµ·æ¥ï¼Œä»¥ç¡®ä¿YMLè§£æå™¨ä¸ä¼šå°†å…¶è½¬æ¢ä¸ºTrueæˆ–Falseã€‚")]),e._v(" "),n("p",[e._v("ä»…å…·æœ‰é”®çš„ç¯å¢ƒå˜é‡åœ¨è¿è¡ŒComposeçš„è®¡ç®—æœºä¸Šè§£æä¸ºå®ƒä»¬çš„å€¼ï¼Œè¿™å¯¹äºç§˜å¯†æˆ–ç‰¹å®šäºä¸»æœºçš„å€¼å¾ˆæœ‰ç”¨ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("environment:\n  RACK_ENV: development\n  SHOW: 'true'\n  SESSION_SECRET:\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("environment:\n  - RACK_ENV=development\n  - SHOW=true\n  - SESSION_SECRET\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("blockquote",[n("p",[n("strong",[e._v("æ³¨æ„")])]),e._v(" "),n("p",[e._v("å¦‚æœæ‚¨çš„æœåŠ¡æŒ‡å®šäº† "),n("a",{attrs:{href:"#build"}},[e._v("æ„å»º")]),e._v(" é€‰é¡¹ï¼Œ "),n("code",[e._v("environment")]),e._v(" åˆ™ åœ¨æ„å»ºè¿‡ç¨‹ ä¸­ "),n("em",[e._v("ä¸ä¼š")]),e._v(" è‡ªåŠ¨æ˜¾ç¤ºä¸­ å®šä¹‰çš„å˜é‡ ã€‚ ä½¿ç”¨çš„ "),n("a",{attrs:{href:"#args"}},[e._v("args")]),e._v(" å­é€‰é¡¹ "),n("code",[e._v("build")]),e._v(" æ¥å®šä¹‰æ„å»ºæ—¶ç¯å¢ƒå˜é‡ã€‚")])]),e._v(" "),n("h3",{attrs:{id:"æš´éœ²-ğŸ”—"}},[e._v("æš´éœ² "),n("a",{attrs:{href:"#expose"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("å…¬å¼€ç«¯å£è€Œä¸å°†å…¶å‘å¸ƒåˆ°ä¸»æœºä¸Š-åªæœ‰é“¾æ¥çš„æœåŠ¡æ‰èƒ½è®¿é—®å®ƒä»¬ã€‚ åªèƒ½æŒ‡å®šå†…éƒ¨ç«¯å£ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('expose:\n  - "3000"\n  - "8000"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("h3",{attrs:{id:"external-links-ğŸ”—"}},[e._v("external_links "),n("a",{attrs:{href:"#external_links"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("é“¾æ¥åˆ°åœ¨æ­¤èŒƒå›´ä¹‹å¤– "),n("code",[e._v("docker-compose.yml")]),e._v(" ç”šè‡³åœ¨Composeä¹‹å¤– å¼€å§‹çš„å®¹å™¨ ï¼Œç‰¹åˆ«æ˜¯å¯¹äºæä¾›å…±äº«æˆ–å…¬å…±æœåŠ¡çš„å®¹å™¨ã€‚ åŒæ—¶æŒ‡å®šå®¹å™¨åç§°å’Œé“¾æ¥åˆ«åï¼ˆ ï¼‰ æ—¶ï¼Œè¯· "),n("code",[e._v("external_links")]),e._v(" éµå¾ªä¸legacyé€‰é¡¹ç›¸ä¼¼çš„è¯­ä¹‰ ã€‚ "),n("code",[e._v("links")]),e._v(" "),n("code",[e._v("CONTAINER:ALIAS")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("external_links:\n  - redis_1\n  - project_db_1:mysql\n  - project_db_1:postgresql\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("blockquote",[n("p",[n("strong",[e._v("æ³¨æ„")])]),e._v(" "),n("p",[e._v("å¤–éƒ¨åˆ›å»ºçš„å®¹å™¨å¿…é¡»è¿æ¥åˆ°ä¸é“¾æ¥åˆ°å®ƒä»¬çš„æœåŠ¡ç›¸åŒçš„ç½‘ç»œä¸­çš„è‡³å°‘ä¸€ä¸ªã€‚ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-file-v2#links",target:"_blank",rel:"noopener noreferrer"}},[e._v("é“¾æ¥"),n("OutboundLink")],1),e._v(" æ˜¯æ—§é€‰é¡¹ã€‚ æˆ‘ä»¬å»ºè®® æ”¹ä¸º ä½¿ç”¨ "),n("a",{attrs:{href:"#networks"}},[e._v("ç½‘ç»œ")]),e._v(" ã€‚")])]),e._v(" "),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨é›†ç¾¤æ¨¡å¼ä¸‹éƒ¨ç½²å †æ ˆ"),n("OutboundLink")],1),e._v(" "),n("code",[e._v("external_links")]),e._v(" æ—¶ï¼Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å°†"),n("OutboundLink")],1),e._v(" å¿½ç•¥ è¯¥ é€‰é¡¹"),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[n("OutboundLink")],1)])]),e._v(" "),n("h3",{attrs:{id:"extra-hosts-ğŸ”—"}},[e._v("extra_hosts "),n("a",{attrs:{href:"#extra_hosts"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æ·»åŠ ä¸»æœºåæ˜ å°„ã€‚ ä½¿ç”¨ä¸docker client "),n("code",[e._v("--add-host")]),e._v(" å‚æ•° ç›¸åŒçš„å€¼ ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('extra_hosts:\n  - "somehost:162.242.195.82"\n  - "otherhost:50.31.209.229"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("p",[e._v("åœ¨ "),n("code",[e._v("/etc/hosts")]),e._v(" æ­¤æœåŠ¡çš„å†…éƒ¨å®¹å™¨ä¸­ åˆ›å»ºä¸€ä¸ªå…·æœ‰ipåœ°å€å’Œä¸»æœºåçš„æ¡ç›® ï¼Œä¾‹å¦‚ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("162.242.195.82  somehost\n50.31.209.229   otherhost\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("h3",{attrs:{id:"å¥åº·-æ£€æŸ¥ğŸ”—"}},[e._v("å¥åº· "),n("a",{attrs:{href:"#healthcheck"}},[e._v("æ£€æŸ¥ğŸ”—")])]),e._v(" "),n("p",[e._v("é…ç½®è¿è¡Œçš„æ£€æŸ¥ä»¥ç¡®å®šè¯¥æœåŠ¡çš„å®¹å™¨æ˜¯å¦â€œå¥åº·â€ã€‚ æœ‰å…³è¿è¡Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/builder/#healthcheck",target:"_blank",rel:"noopener noreferrer"}},[e._v("çŠ¶å†µæ£€æŸ¥"),n("OutboundLink")],1),e._v(" å¦‚ä½•å·¥ä½œçš„è¯¦ç»†ä¿¡æ¯ï¼Œ è¯·å‚é˜…æ–‡æ¡£ä¸­çš„ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/builder/#healthcheck",target:"_blank",rel:"noopener noreferrer"}},[e._v("HEALTHCHECK DockerfileæŒ‡ä»¤"),n("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('healthcheck:\n  test: ["CMD", "curl", "-f", "http://localhost"]\n  interval: 1m30s\n  timeout: 10s\n  retries: 3\n  start_period: 40s\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br")])]),n("p",[n("code",[e._v("interval")]),e._v(" ï¼Œ "),n("code",[e._v("timeout")]),e._v(" å¹¶ "),n("code",[e._v("start_period")]),e._v(" æŒ‡å®šä¸º "),n("a",{attrs:{href:"#specifying-durations"}},[e._v("duration")]),e._v(" ã€‚")]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-34",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.4ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")]),e._v(" "),n("p",[e._v("è¯¥ "),n("code",[e._v("start_period")]),e._v(" é€‰é¡¹ä»¥æ–‡ä»¶æ ¼å¼3.4æ·»åŠ ã€‚")])]),e._v(" "),n("p",[n("code",[e._v("test")]),e._v(" å¿…é¡»æ˜¯å­—ç¬¦ä¸²æˆ–åˆ—è¡¨ã€‚ å¦‚æœå®ƒæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œç¬¬ä¸€é¡¹å¿…é¡»æ˜¯ "),n("code",[e._v("NONE")]),e._v(" ï¼Œ "),n("code",[e._v("CMD")]),e._v(" æˆ– "),n("code",[e._v("CMD-SHELL")]),e._v(" ã€‚ å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™ç­‰æ•ˆäºæŒ‡å®š "),n("code",[e._v("CMD-SHELL")]),e._v(" åè·Ÿè¯¥å­—ç¬¦ä¸²ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('# Hit the local web app\ntest: ["CMD", "curl", "-f", "http://localhost"]\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("p",[e._v("å¦‚ä¸Šæ‰€è¿°ï¼Œä½†åŒ…è£¹åœ¨ä¸­ "),n("code",[e._v("/bin/sh")]),e._v(" ã€‚ ä»¥ä¸‹ä¸¤ç§å½¢å¼æ˜¯ç­‰æ•ˆçš„ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('test: ["CMD-SHELL", "curl -f http://localhost || exit 1"]\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("test: curl -f https://localhost || exit 1\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("p",[e._v("è¦ç¦ç”¨å›¾åƒè®¾ç½®çš„ä»»ä½•é»˜è®¤è¿è¡ŒçŠ¶å†µæ£€æŸ¥ï¼Œå¯ä»¥ä½¿ç”¨ "),n("code",[e._v("disable: true")]),e._v(" ã€‚ è¿™ç­‰æ•ˆäºæŒ‡å®š "),n("code",[e._v('test: ["NONE"]')]),e._v(" ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("healthcheck:\n  disable: true\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("h3",{attrs:{id:"å›¾ç‰‡-ğŸ”—"}},[e._v("å›¾ç‰‡ "),n("a",{attrs:{href:"#image"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æŒ‡å®šç”¨äºå¯åŠ¨å®¹å™¨çš„å›¾åƒã€‚ å¯ä»¥æ˜¯å­˜å‚¨åº“/æ ‡ç­¾æˆ–éƒ¨åˆ†å›¾åƒIDã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("image: redis\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("image: ubuntu:18.04\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("image: tutum/influxdb\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("image: example-registry.com:4000/postgresql\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("image: a4bc65fd\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("p",[e._v("å¦‚æœå›¾åƒä¸å­˜åœ¨ï¼Œé™¤éæ‚¨è¿˜æŒ‡å®šäº† "),n("a",{attrs:{href:"#build"}},[e._v("build")]),e._v(" ï¼Œå¦åˆ™Composeä¼šå°è¯•æ‹‰å‡ºå®ƒï¼Œ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå°†ä½¿ç”¨æŒ‡å®šçš„é€‰é¡¹æ¥æ„å»ºå®ƒå¹¶ä½¿ç”¨æŒ‡å®šçš„æ ‡ç­¾å¯¹å…¶è¿›è¡Œæ ‡è®°ã€‚")]),e._v(" "),n("h3",{attrs:{id:"åˆå§‹åŒ–-ğŸ”—"}},[e._v("åˆå§‹åŒ– "),n("a",{attrs:{href:"#init"}},[e._v("ğŸ”—")])]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-37",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.7ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")])]),e._v(" "),n("p",[e._v("åœ¨å®¹å™¨å†…è¿è¡Œä¸€ä¸ªåˆå§‹åŒ–ç¨‹åºï¼Œä»¥è½¬å‘ä¿¡å·å¹¶è·å–è¿›ç¨‹ã€‚ è®¾ç½®æ­¤é€‰é¡¹å¯ä»¥ "),n("code",[e._v("true")]),e._v(" ä¸ºæœåŠ¡å¯ç”¨æ­¤åŠŸèƒ½ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  web:\n    image: alpine:latest\n    init: true\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("blockquote",[n("p",[e._v("ä½¿ç”¨çš„é»˜è®¤åˆå§‹åŒ–äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯ "),n("a",{attrs:{href:"https://github.com/krallin/tini",target:"_blank",rel:"noopener noreferrer"}},[e._v("Tini"),n("OutboundLink")],1),e._v(" ï¼Œå¹¶å®‰è£…åœ¨ "),n("code",[e._v("/usr/libexec/docker-init")]),e._v(" å®ˆæŠ¤ç¨‹åºä¸»æœºä¸Šã€‚ æ‚¨å¯ä»¥é€šè¿‡ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("init-path")]),e._v("é…ç½®é€‰é¡¹"),n("OutboundLink")],1),e._v(" å°†å®ˆæŠ¤ç¨‹åºé…ç½®ä¸ºä½¿ç”¨è‡ªå®šä¹‰initäºŒè¿›åˆ¶æ–‡ä»¶ ã€‚")])]),e._v(" "),n("h3",{attrs:{id:"éš”ç¦»-ğŸ”—"}},[e._v("éš”ç¦» "),n("a",{attrs:{href:"#isolation"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æŒ‡å®šå®¹å™¨çš„éš”ç¦»æŠ€æœ¯ã€‚ åœ¨Linuxä¸Šï¼Œå”¯ä¸€æ”¯æŒçš„å€¼æ˜¯ "),n("code",[e._v("default")]),e._v(" ã€‚ åœ¨Windowsä¸­ï¼Œå¯æ¥å—çš„å€¼æ˜¯ "),n("code",[e._v("default")]),e._v(" ï¼Œ "),n("code",[e._v("process")]),e._v(" å’Œ "),n("code",[e._v("hyperv")]),e._v(" ã€‚ æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œ è¯·å‚è€ƒ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/run/#specify-isolation-technology-for-container---isolation",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker Engineæ–‡æ¡£"),n("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),n("h3",{attrs:{id:"æ ‡ç­¾-ğŸ”—"}},[e._v("æ ‡ç­¾ "),n("a",{attrs:{href:"#labels-2"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("ä½¿ç”¨ "),n("a",{attrs:{href:"https://docs.docker.com/config/labels-custom-metadata/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Dockeræ ‡ç­¾"),n("OutboundLink")],1),e._v(" å°†å…ƒæ•°æ®æ·»åŠ åˆ°å®¹å™¨ ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨æ•°ç»„æˆ–å­—å…¸ã€‚")]),e._v(" "),n("p",[e._v("å»ºè®®æ‚¨ä½¿ç”¨åå‘DNSè¡¨ç¤ºæ³•ï¼Œä»¥é˜²æ­¢æ ‡ç­¾ä¸å…¶ä»–è½¯ä»¶ä½¿ç”¨çš„æ ‡ç­¾å†²çªã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('labels:\n  com.example.description: "Accounting webapp"\n  com.example.department: "Finance"\n  com.example.label-with-empty-value: ""\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('labels:\n  - "com.example.description=Accounting webapp"\n  - "com.example.department=Finance"\n  - "com.example.label-with-empty-value"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("h3",{attrs:{id:"é“¾æ¥-ğŸ”—"}},[e._v("é“¾æ¥ "),n("a",{attrs:{href:"#links"}},[e._v("ğŸ”—")])]),e._v(" "),n("blockquote",[n("p",[n("strong",[e._v("è­¦å‘Š")])]),e._v(" "),n("p",[e._v("è¯¥ "),n("code",[e._v("--link")]),e._v(" æ ‡å¿—æ˜¯Dockerçš„é—ç•™åŠŸèƒ½ã€‚ å®ƒæœ€ç»ˆå¯èƒ½ä¼šè¢«åˆ é™¤ã€‚ é™¤éæ‚¨ç»å¯¹éœ€è¦ç»§ç»­ä½¿ç”¨å®ƒï¼Œå¦åˆ™å»ºè®®æ‚¨ä½¿ç”¨ "),n("a",{attrs:{href:"https://docs.docker.com/compose/networking/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç”¨æˆ·å®šä¹‰çš„ç½‘ç»œ"),n("OutboundLink")],1),e._v(" æ¥ä¿ƒè¿›ä¸¤ä¸ªå®¹å™¨ä¹‹é—´çš„é€šä¿¡ï¼Œè€Œä¸è¦ä½¿ç”¨ "),n("code",[e._v("--link")]),e._v(" ã€‚")]),e._v(" "),n("p",[e._v("ç”¨æˆ·å®šä¹‰çš„ç½‘ç»œä¸æ”¯æŒæ‚¨å¯ä»¥ä½¿ç”¨çš„åŠŸèƒ½ä¹‹ä¸€ "),n("code",[e._v("--link")]),e._v(" æ˜¯åœ¨å®¹å™¨ä¹‹é—´å…±äº«ç¯å¢ƒå˜é‡ã€‚ ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å…¶ä»–æœºåˆ¶ï¼ˆä¾‹å¦‚å·ï¼‰ä»¥æ›´å¯æ§çš„æ–¹å¼åœ¨å®¹å™¨ä¹‹é—´å…±äº«ç¯å¢ƒå˜é‡ã€‚")])]),e._v(" "),n("p",[e._v("é“¾æ¥åˆ°å¦ä¸€ä¸ªæœåŠ¡ä¸­çš„å®¹å™¨ã€‚ æŒ‡å®šæœåŠ¡åç§°å’Œé“¾æ¥åˆ«åï¼ˆ "),n("code",[e._v('"SERVICE:ALIAS"')]),e._v(" ï¼‰ï¼Œæˆ–è€…ä»…æŒ‡å®šæœåŠ¡åç§°ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('web:\n  links:\n    - "db"\n    - "db:database"\n    - "redis"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("p",[e._v("é“¾æ¥æœåŠ¡çš„å®¹å™¨å¯ä»¥é€šè¿‡ä¸åˆ«åç›¸åŒçš„ä¸»æœºåè®¿é—®ï¼Œå¦‚æœæœªæŒ‡å®šåˆ«åï¼Œåˆ™å¯ä»¥ä½¿ç”¨æœåŠ¡åã€‚")]),e._v(" "),n("p",[e._v("ä¸éœ€è¦é“¾æ¥å³å¯ä½¿æœåŠ¡è¿›è¡Œé€šä¿¡-é»˜è®¤æƒ…å†µä¸‹ï¼Œä»»ä½•æœåŠ¡éƒ½å¯ä»¥ä½¿ç”¨è¯¥æœåŠ¡çš„åç§°è®¿é—®ä»»ä½•å…¶ä»–æœåŠ¡ã€‚ ï¼ˆå¦è¯·å‚è§ "),n("a",{attrs:{href:"https://docs.docker.com/compose/networking/#links",target:"_blank",rel:"noopener noreferrer"}},[e._v("Composeä¸­çš„Networkingä¸­"),n("OutboundLink")],1),e._v(" çš„ "),n("a",{attrs:{href:"https://docs.docker.com/compose/networking/#links",target:"_blank",rel:"noopener noreferrer"}},[e._v("Linksä¸»é¢˜"),n("OutboundLink")],1),e._v(" ã€‚ï¼‰")]),e._v(" "),n("p",[e._v("é“¾æ¥ä¹Ÿä»¥ä¸ "),n("a",{attrs:{href:"#depends_on"}},[e._v("depends_on")]),e._v(" ç›¸åŒçš„æ–¹å¼è¡¨ç¤ºæœåŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³» ï¼Œå› æ­¤å®ƒä»¬ç¡®å®šäº†æœåŠ¡å¯åŠ¨çš„é¡ºåºã€‚")]),e._v(" "),n("blockquote",[n("p",[n("strong",[e._v("æ³¨æ„")])]),e._v(" "),n("p",[e._v("å¦‚æœåŒæ—¶å®šä¹‰é“¾æ¥å’Œ "),n("a",{attrs:{href:"#networks"}},[e._v("ç½‘ç»œ")]),e._v(" ï¼Œåˆ™å®ƒä»¬ä¹‹é—´å…·æœ‰é“¾æ¥çš„æœåŠ¡å¿…é¡»å…±äº«è‡³å°‘ä¸€ä¸ªå…¬å…±ç½‘ç»œæ‰èƒ½è¿›è¡Œé€šä¿¡ã€‚")])]),e._v(" "),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨é›†ç¾¤æ¨¡å¼ä¸‹éƒ¨ç½²å †æ ˆ"),n("OutboundLink")],1),e._v(" "),n("code",[e._v("links")]),e._v(" æ—¶ï¼Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å°†"),n("OutboundLink")],1),e._v(" å¿½ç•¥ è¯¥ é€‰é¡¹"),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[n("OutboundLink")],1)])]),e._v(" "),n("h3",{attrs:{id:"è®°å½•-ğŸ”—"}},[e._v("è®°å½• "),n("a",{attrs:{href:"#logging"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æœåŠ¡çš„æ—¥å¿—è®°å½•é…ç½®ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('logging:\n  driver: syslog\n  options:\n    syslog-address: "tcp://192.168.0.42:123"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("p",[e._v("è¯¥ "),n("code",[e._v("driver")]),e._v(" åç§°æŒ‡å®šäº†æœåŠ¡å®¹å™¨çš„æ—¥å¿—è®°å½•é©±åŠ¨ç¨‹åºï¼Œä»¥åŠ "),n("code",[e._v("--log-driver")]),e._v(" docker runé€‰é¡¹ï¼ˆ "),n("a",{attrs:{href:"https://docs.docker.com/config/containers/logging/configure/",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨æ­¤å¤„è®°å½•"),n("OutboundLink")],1),e._v(" ï¼‰ã€‚")]),e._v(" "),n("p",[e._v("é»˜è®¤å€¼ä¸ºjson-fileã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('driver: "json-file"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('driver: "syslog"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('driver: "none"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("blockquote",[n("p",[n("strong",[e._v("æ³¨æ„")])]),e._v(" "),n("p",[e._v("åªæœ‰ "),n("code",[e._v("json-file")]),e._v(" å’Œ "),n("code",[e._v("journald")]),e._v(" é©±åŠ¨ç¨‹åºæ‰èƒ½ä» "),n("code",[e._v("docker-compose up")]),e._v(" å’Œ ç›´æ¥æä¾›æ—¥å¿— "),n("code",[e._v("docker-compose logs")]),e._v(" ã€‚ ä½¿ç”¨ä»»ä½•å…¶ä»–é©±åŠ¨ç¨‹åºä¸ä¼šæ‰“å°ä»»ä½•æ—¥å¿—ã€‚")])]),e._v(" "),n("p",[e._v("ä½¿ç”¨ "),n("code",[e._v("options")]),e._v(" é”® ä¸ºæ—¥å¿—è®°å½•é©±åŠ¨ç¨‹åºæŒ‡å®šæ—¥å¿—è®°å½•é€‰é¡¹ ï¼Œå¦‚çš„ "),n("code",[e._v("--log-opt")]),e._v(" é€‰é¡¹ "),n("code",[e._v("docker run")]),e._v(" ã€‚")]),e._v(" "),n("p",[e._v("æ—¥å¿—è®°å½•é€‰é¡¹æ˜¯é”®å€¼å¯¹ã€‚ "),n("code",[e._v("syslog")]),e._v(" é€‰é¡¹ ç¤ºä¾‹ ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('driver: "syslog"\noptions:\n  syslog-address: "tcp://192.168.0.42:123"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("p",[e._v("é»˜è®¤é©±åŠ¨ç¨‹åº "),n("a",{attrs:{href:"https://docs.docker.com/config/containers/logging/json-file/",target:"_blank",rel:"noopener noreferrer"}},[e._v("json-file"),n("OutboundLink")],1),e._v(" ï¼Œå…·æœ‰ç”¨äºé™åˆ¶æ‰€å­˜å‚¨æ—¥å¿—æ•°é‡çš„é€‰é¡¹ã€‚ ä¸ºæ­¤ï¼Œè¯·ä½¿ç”¨é”®å€¼å¯¹ä»¥è·å–æœ€å¤§å­˜å‚¨å¤§å°å’Œæœ€å¤§æ–‡ä»¶æ•°ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('options:\n  max-size: "200k"\n  max-file: "10"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("p",[e._v("ä¸Šé¢æ˜¾ç¤ºçš„ç¤ºä¾‹å°†å­˜å‚¨æ—¥å¿—æ–‡ä»¶ï¼Œç›´åˆ°å®ƒä»¬è¾¾åˆ° "),n("code",[e._v("max-size")]),e._v(" 200kBï¼Œç„¶åæ—‹è½¬å®ƒä»¬ã€‚ å•ä¸ªæ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨é‡ç”±è¯¥ "),n("code",[e._v("max-file")]),e._v(" å€¼ æŒ‡å®š ã€‚ éšç€æ—¥å¿—è¶…è¿‡æœ€å¤§é™åˆ¶ï¼Œå°†åˆ é™¤è¾ƒæ—§çš„æ—¥å¿—æ–‡ä»¶ä»¥å…è®¸å­˜å‚¨æ–°æ—¥å¿—ã€‚")]),e._v(" "),n("p",[e._v("è¿™æ˜¯ä¸€ä¸ª "),n("code",[e._v("docker-compose.yml")]),e._v(" é™åˆ¶æ—¥å¿—å­˜å‚¨ çš„ç¤ºä¾‹ æ–‡ä»¶ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  some-service:\n    image: some-service\n    logging:\n      driver: "json-file"\n      options:\n        max-size: "200k"\n        max-file: "10"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br")])]),n("blockquote",[n("p",[e._v("å¯ç”¨çš„æ—¥å¿—è®°å½•é€‰é¡¹å–å†³äºæ‚¨ä½¿ç”¨çš„æ—¥å¿—è®°å½•é©±åŠ¨ç¨‹åº")]),e._v(" "),n("p",[e._v("ä¸Šé¢ç”¨äºæ§åˆ¶æ—¥å¿—æ–‡ä»¶å’Œå¤§å°çš„ç¤ºä¾‹ä½¿ç”¨ç‰¹å®šäº "),n("a",{attrs:{href:"https://docs.docker.com/config/containers/logging/json-file/",target:"_blank",rel:"noopener noreferrer"}},[e._v("json-file driverçš„"),n("OutboundLink")],1),e._v(" é€‰é¡¹ ã€‚ è¿™äº›ç‰¹å®šé€‰é¡¹åœ¨å…¶ä»–æ—¥å¿—è®°å½•é©±åŠ¨ç¨‹åºä¸Šä¸å¯ç”¨ã€‚ æœ‰å…³å—æ”¯æŒçš„æ—¥å¿—è®°å½•é©±åŠ¨ç¨‹åºåŠå…¶é€‰é¡¹çš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·å‚é˜… "),n("a",{attrs:{href:"https://docs.docker.com/config/containers/logging/configure/",target:"_blank",rel:"noopener noreferrer"}},[e._v("æ—¥å¿—è®°å½•é©±åŠ¨ç¨‹åº"),n("OutboundLink")],1),e._v(" æ–‡æ¡£ã€‚")])]),e._v(" "),n("h3",{attrs:{id:"network-mode-ğŸ”—"}},[e._v("network_mode "),n("a",{attrs:{href:"#network_mode"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("ç½‘ç»œæ¨¡å¼ã€‚ ä½¿ç”¨ä¸docker client "),n("code",[e._v("--network")]),e._v(" å‚æ•° ç›¸åŒçš„å€¼ ï¼Œä»¥åŠç‰¹æ®Šå½¢å¼ "),n("code",[e._v("service:[service name]")]),e._v(" ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('network_mode: "bridge"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('network_mode: "host"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('network_mode: "none"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('network_mode: "service:[service name]"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('network_mode: "container:[container name/id]"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("blockquote",[n("p",[n("strong",[e._v("æ³¨æ„")])]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨é›†ç¾¤æ¨¡å¼ä¸‹éƒ¨ç½²å †æ ˆ"),n("OutboundLink")],1),e._v(" æ—¶ï¼Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å°†"),n("OutboundLink")],1),e._v(" å¿½ç•¥æ­¤é€‰é¡¹ ã€‚")]),e._v(" "),n("li",[n("code",[e._v('network_mode: "host"')]),e._v(" ä¸èƒ½ä¸ "),n("a",{attrs:{href:"#links"}},[e._v("é“¾æ¥")]),e._v(" æ··åˆåœ¨ä¸€èµ· ã€‚")])])]),e._v(" "),n("h3",{attrs:{id:"ç½‘ç»œ-ğŸ”—"}},[e._v("ç½‘ç»œ "),n("a",{attrs:{href:"#networks"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("è¦åŠ å…¥çš„ç½‘ç»œï¼Œå¼•ç”¨ "),n("a",{attrs:{href:"#network-configuration-reference"}},[e._v("é¡¶çº§ "),n("code",[e._v("networks")]),e._v(" å¯†é’¥")]),e._v(" ä¸‹çš„æ¡ç›® ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("services:\n  some-service:\n    networks:\n     - some-network\n     - other-network\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("h4",{attrs:{id:"åˆ«å"}},[e._v("åˆ«å")]),e._v(" "),n("p",[e._v("ç½‘ç»œä¸Šæ­¤æœåŠ¡çš„åˆ«åï¼ˆå¤‡ç”¨ä¸»æœºåï¼‰ã€‚ åŒä¸€ç½‘ç»œä¸Šçš„å…¶ä»–å®¹å™¨å¯ä»¥ä½¿ç”¨æœåŠ¡åç§°æˆ–æ­¤åˆ«åæ¥è¿æ¥åˆ°æœåŠ¡çš„å®¹å™¨ä¹‹ä¸€ã€‚")]),e._v(" "),n("p",[e._v("ç”±äº "),n("code",[e._v("aliases")]),e._v(" æ˜¯ç½‘ç»œèŒƒå›´çš„ï¼Œå› æ­¤åŒä¸€æœåŠ¡åœ¨ä¸åŒçš„ç½‘ç»œä¸Šå¯ä»¥å…·æœ‰ä¸åŒçš„åˆ«åã€‚")]),e._v(" "),n("blockquote",[n("p",[n("strong",[e._v("æ³¨æ„")])]),e._v(" "),n("p",[e._v("ç½‘ç»œèŒƒå›´å†…çš„åˆ«åå¯ä»¥ç”±å¤šä¸ªå®¹å™¨ç”šè‡³å¤šä¸ªæœåŠ¡å…±äº«ã€‚ å¦‚æœæ˜¯è¿™æ ·ï¼Œåˆ™ä¸èƒ½ä¿è¯åç§°è§£æåˆ°å“ªä¸ªå®¹å™¨ã€‚")])]),e._v(" "),n("p",[e._v("ä¸€èˆ¬æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("services:\n  some-service:\n    networks:\n      some-network:\n        aliases:\n          - alias1\n          - alias3\n      other-network:\n        aliases:\n          - alias2\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br")])]),n("p",[e._v("åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæä¾›äº†ä¸‰ç§æœåŠ¡ï¼ˆ "),n("code",[e._v("web")]),e._v(" ï¼Œ "),n("code",[e._v("worker")]),e._v(" ï¼Œå’Œ "),n("code",[e._v("db")]),e._v(" ï¼‰ï¼Œå…¶ä¸­ä¸¤ä¸ªç½‘ç»œï¼ˆæ²¿ "),n("code",[e._v("new")]),e._v(" å’Œ "),n("code",[e._v("legacy")]),e._v(" ï¼‰ã€‚ è¯¥ "),n("code",[e._v("db")]),e._v(" æœåŠ¡æ˜¯åœ¨åˆ°è¾¾çš„ä¸»æœºå "),n("code",[e._v("db")]),e._v(" æˆ– "),n("code",[e._v("database")]),e._v(" ä¸Š "),n("code",[e._v("new")]),e._v(" ç½‘ç»œï¼Œå¹¶ "),n("code",[e._v("db")]),e._v(" æˆ– "),n("code",[e._v("mysql")]),e._v(" å°†ä¸Š "),n("code",[e._v("legacy")]),e._v(" ç½‘ç»œã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\n\nservices:\n  web:\n    image: "nginx:alpine"\n    networks:\n      - new\n\n  worker:\n    image: "my-worker-image:latest"\n    networks:\n      - legacy\n\n  db:\n    image: mysql\n    networks:\n      new:\n        aliases:\n          - database\n      legacy:\n        aliases:\n          - mysql\n\nnetworks:\n  new:\n  legacy:\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br"),n("span",{staticClass:"line-number"},[e._v("23")]),n("br"),n("span",{staticClass:"line-number"},[e._v("24")]),n("br"),n("span",{staticClass:"line-number"},[e._v("25")]),n("br"),n("span",{staticClass:"line-number"},[e._v("26")]),n("br"),n("span",{staticClass:"line-number"},[e._v("27")]),n("br")])]),n("h4",{attrs:{id:"ipv4-addressï¼Œipv6-address"}},[e._v("ipv4_addressï¼Œipv6_address")]),e._v(" "),n("p",[e._v("åŠ å…¥ç½‘ç»œåï¼Œä¸ºæ­¤æœåŠ¡çš„å®¹å™¨æŒ‡å®šä¸€ä¸ªé™æ€IPåœ°å€ã€‚")]),e._v(" "),n("p",[n("a",{attrs:{href:"#network-configuration-reference"}},[e._v("é¡¶çº§ç½‘ç»œéƒ¨åˆ†ä¸­")]),e._v(" çš„ç›¸åº”ç½‘ç»œé…ç½® å¿…é¡»å…·æœ‰ä¸€ä¸ª "),n("code",[e._v("ipam")]),e._v(" å—ï¼Œå…¶ä¸­å­ç½‘é…ç½®è¦†ç›–æ¯ä¸ªé™æ€åœ°å€ã€‚")]),e._v(" "),n("blockquote",[n("p",[e._v("å¦‚æœéœ€è¦IPv6å¯»å€ï¼Œåˆ™ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-file-v2/#enable_ipv6",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("enable_ipv6")]),n("OutboundLink")],1),e._v(" å¿…é¡»è®¾ç½® è¯¥ é€‰é¡¹ï¼Œå¹¶ä¸”å¿…é¡»ä½¿ç”¨ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-file-v2/#ipv4_address-ipv6_address",target:"_blank",rel:"noopener noreferrer"}},[e._v("2.xç‰ˆæœ¬çš„Composeæ–‡ä»¶"),n("OutboundLink")],1),e._v(" ã€‚ "),n("em",[e._v("IPv6é€‰é¡¹å½“å‰åœ¨ç¾¤é›†æ¨¡å¼ä¸‹ä¸èµ·ä½œç”¨")]),e._v(" ã€‚")])]),e._v(" "),n("p",[e._v("ä¸€ä¸ªä¾‹å­ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\n\nservices:\n  app:\n    image: nginx:alpine\n    networks:\n      app_net:\n        ipv4_address: 172.16.238.10\n        ipv6_address: 2001:3984:3989::10\n\nnetworks:\n  app_net:\n    ipam:\n      driver: default\n      config:\n        - subnet: "172.16.238.0/24"\n        - subnet: "2001:3984:3989::/64"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br")])]),n("h3",{attrs:{id:"pid-ğŸ”—"}},[e._v("PID "),n("a",{attrs:{href:"#pid"}},[e._v("ğŸ”—")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('pid: "host"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("p",[e._v("å°†PIDæ¨¡å¼è®¾ç½®ä¸ºä¸»æœºPIDæ¨¡å¼ã€‚ è¿™å°†æ‰“å¼€å®¹å™¨å’Œä¸»æœºæ“ä½œç³»ç»Ÿä¹‹é—´çš„PIDåœ°å€ç©ºé—´å…±äº«ã€‚ ä½¿ç”¨æ­¤æ ‡å¿—å¯åŠ¨çš„å®¹å™¨å¯ä»¥è®¿é—®å’Œæ“ä½œè£¸æœºåç§°ç©ºé—´ä¸­çš„å…¶ä»–å®¹å™¨ï¼Œåä¹‹äº¦ç„¶ã€‚")]),e._v(" "),n("h3",{attrs:{id:"æ¸¯å£-ğŸ”—"}},[e._v("æ¸¯å£ "),n("a",{attrs:{href:"#ports"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("éœ²å‡ºç«¯å£ã€‚")]),e._v(" "),n("blockquote",[n("p",[n("strong",[e._v("æ³¨æ„")])]),e._v(" "),n("p",[e._v("ç«¯å£æ˜ å°„ä¸ "),n("code",[e._v("network_mode: host")])])]),e._v(" "),n("h4",{attrs:{id:"çŸ­è¯­æ³•-2"}},[e._v("çŸ­è¯­æ³•")]),e._v(" "),n("p",[e._v("è¦ä¹ˆæŒ‡å®šä¸¤ä¸ªç«¯å£ï¼ˆ "),n("code",[e._v("HOST:CONTAINER")]),e._v(" ï¼‰ï¼Œè¦ä¹ˆä»…æŒ‡å®šå®¹å™¨ç«¯å£ï¼ˆé€‰æ‹©äº†ä¸´æ—¶ä¸»æœºç«¯å£ï¼‰ã€‚")]),e._v(" "),n("blockquote",[n("p",[n("strong",[e._v("æ³¨æ„")])]),e._v(" "),n("p",[e._v("å½“ä»¥è¯¥ "),n("code",[e._v("HOST:CONTAINER")]),e._v(" æ ¼å¼ æ˜ å°„ç«¯å£ æ—¶ï¼Œä½¿ç”¨ä½äº60çš„å®¹å™¨ç«¯å£å¯èƒ½ä¼šé‡åˆ°é”™è¯¯çš„ç»“æœï¼Œå› ä¸ºYAMLä¼šå°†æ ¼å¼ "),n("code",[e._v("xx:yy")]),e._v(" ä¸­çš„ æ•°å­—è§£æ ä¸ºä»¥60ä¸ºåº•çš„å€¼ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å»ºè®®å§‹ç»ˆå°†ç«¯å£æ˜ å°„æ˜¾å¼æŒ‡å®šä¸ºå­—ç¬¦ä¸²ã€‚")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('ports:\n  - "3000"\n  - "3000-3005"\n  - "8000:8000"\n  - "9090-9091:8080-8081"\n  - "49100:22"\n  - "127.0.0.1:8001:8001"\n  - "127.0.0.1:5000-5010:5000-5010"\n  - "6060:6060/udp"\n  - "12400-12500:1240"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br")])]),n("h4",{attrs:{id:"é•¿è¯­æ³•-2"}},[e._v("é•¿è¯­æ³•")]),e._v(" "),n("p",[e._v("é•¿æ ¼å¼è¯­æ³•å…è®¸é…ç½®å…¶ä»–ä¸èƒ½ä»¥çŸ­æ ¼å¼è¡¨ç¤ºçš„å­—æ®µã€‚")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("target")]),e._v(" ï¼šå®¹å™¨å†…çš„ç«¯å£")]),e._v(" "),n("li",[n("code",[e._v("published")]),e._v(" ï¼šå…¬å¼€æš´éœ²çš„æ¸¯å£")]),e._v(" "),n("li",[n("code",[e._v("protocol")]),e._v(" ï¼šç«¯å£åè®®ï¼ˆ "),n("code",[e._v("tcp")]),e._v(" æˆ– "),n("code",[e._v("udp")]),e._v(" ï¼‰")]),e._v(" "),n("li",[n("code",[e._v("mode")]),e._v(" ï¼š "),n("code",[e._v("host")]),e._v(" ç”¨äºåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šå‘å¸ƒä¸»æœºç«¯å£ï¼Œæˆ– "),n("code",[e._v("ingress")]),e._v(" ä½¿ç¾¤é›†æ¨¡å¼ç«¯å£è¾¾åˆ°è´Ÿè½½å¹³è¡¡ã€‚")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("ports:\n  - target: 80\n    published: 8080\n    protocol: tcp\n    mode: host\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-32",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.2ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")]),e._v(" "),n("p",[e._v("é•¿è¯­æ³•æ˜¯v3.2æ–‡ä»¶æ ¼å¼çš„æ–°è¯­æ³•ã€‚")])]),e._v(" "),n("h3",{attrs:{id:"é‡æ–°å¯åŠ¨-ğŸ”—"}},[e._v("é‡æ–°å¯åŠ¨ "),n("a",{attrs:{href:"#restart"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[n("code",[e._v("no")]),e._v(" æ˜¯é»˜è®¤çš„ "),n("a",{attrs:{href:"https://docs.docker.com/config/containers/start-containers-automatically/#use-a-restart-policy",target:"_blank",rel:"noopener noreferrer"}},[e._v("é‡æ–°å¯åŠ¨ç­–ç•¥"),n("OutboundLink")],1),e._v(" ï¼Œåœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸ä¼šé‡æ–°å¯åŠ¨å®¹å™¨ã€‚ å½“ "),n("code",[e._v("always")]),e._v(" æŒ‡å®šæ—¶ï¼Œå®¹å™¨æ€»æ˜¯é‡æ–°å¯åŠ¨ã€‚ è¯¥ "),n("code",[e._v("on-failure")]),e._v(" å¦‚æœé€€å‡ºä»£ç æŒ‡ç¤ºçš„æ•…éšœé”™è¯¯æ”¿ç­–é‡å¯çš„å®¹å™¨ã€‚ "),n("code",[e._v("unless-stopped")]),e._v(" æ€»æ˜¯é‡æ–°å¯åŠ¨å®¹å™¨ï¼Œé™¤éå®¹å™¨åœæ­¢ï¼ˆæ‰‹åŠ¨æˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('restart: "no"\nrestart: always\nrestart: on-failure\nrestart: unless-stopped\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨ä»¥ç¾¤é›†æ¨¡å¼éƒ¨ç½²å †æ ˆ"),n("OutboundLink")],1),e._v(" "),n("code",[e._v("restart")]),e._v(" æ—¶ï¼Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å°†"),n("OutboundLink")],1),e._v(" å¿½ç•¥ è¯¥ é€‰é¡¹ ã€‚")])]),e._v(" "),n("h3",{attrs:{id:"ç§˜å¯†-ğŸ”—"}},[e._v("ç§˜å¯† "),n("a",{attrs:{href:"#secrets"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("ä½¿ç”¨æŒ‰æœåŠ¡ "),n("code",[e._v("secrets")]),e._v(" é…ç½® ï¼ŒæŒ‰æœåŠ¡æˆäºˆå¯¹æœºå¯†çš„è®¿é—®æƒé™ ã€‚ æ”¯æŒä¸¤ç§ä¸åŒçš„è¯­æ³•å˜ä½“ã€‚")]),e._v(" "),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[e._v("è¯¥å¯†ç å¿…é¡»å·²ç»å­˜åœ¨æˆ– åœ¨æ’°å†™æ–‡ä»¶ "),n("a",{attrs:{href:"#secrets-configuration-reference"}},[e._v("çš„é¡¶çº§ "),n("code",[e._v("secrets")]),e._v(" é…ç½®")]),e._v(" ä¸­ "),n("a",{attrs:{href:"#secrets-configuration-reference"}},[e._v("å®šä¹‰")]),e._v(" ï¼Œå¦åˆ™å †æ ˆéƒ¨ç½²å°†å¤±è´¥ã€‚")])]),e._v(" "),n("p",[e._v("æœ‰å…³æœºå¯†çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§ "),n("a",{attrs:{href:"https://docs.docker.com/engine/swarm/secrets/",target:"_blank",rel:"noopener noreferrer"}},[e._v("æœºå¯†"),n("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),n("h4",{attrs:{id:"çŸ­è¯­æ³•-3"}},[e._v("çŸ­è¯­æ³•")]),e._v(" "),n("p",[e._v("ç®€çŸ­çš„è¯­æ³•å˜ä½“ä»…æŒ‡å®šç§˜å¯†åç§°ã€‚ è¿™ä¼šæˆäºˆå®¹å™¨è®¿é—®æœºå¯†çš„æƒé™ï¼Œå¹¶å°†å…¶å®‰è£…åœ¨ "),n("code",[e._v("/run/secrets/<secret_name>")]),e._v(" å®¹å™¨å†…ã€‚ æºåç§°å’Œç›®æ ‡å®‰è£…ç‚¹éƒ½è®¾ç½®ä¸ºæœºå¯†åç§°ã€‚")]),e._v(" "),n("p",[e._v("ä»¥ä¸‹ç¤ºä¾‹ä½¿ç”¨shortè¯­æ³•æˆäºˆ "),n("code",[e._v("redis")]),e._v(" æœåŠ¡å¯¹ "),n("code",[e._v("my_secret")]),e._v(" å’Œ "),n("code",[e._v("my_other_secret")]),e._v(" ç§˜å¯†çš„ è®¿é—®æƒé™ ã€‚ çš„å€¼ "),n("code",[e._v("my_secret")]),e._v(" è®¾ç½®ä¸ºfileçš„å†…å®¹ "),n("code",[e._v("./my_secret.txt")]),e._v(" ï¼Œå¹¶ "),n("code",[e._v("my_other_secret")]),e._v(" å®šä¹‰ä¸ºå¤–éƒ¨èµ„æºï¼Œè¿™æ„å‘³ç€å®ƒå·²ç»åœ¨Dockerä¸­å®šä¹‰ï¼Œå¯ä»¥é€šè¿‡è¿è¡Œ "),n("code",[e._v("docker secret create")]),e._v(" å‘½ä»¤æˆ–é€šè¿‡å…¶ä»–å †æ ˆéƒ¨ç½²è¿›è¡Œå®šä¹‰ã€‚ å¦‚æœå¤–éƒ¨æœºå¯†ä¸å­˜åœ¨ï¼Œåˆ™å †æ ˆéƒ¨ç½²å°†å¤±è´¥å¹¶æ˜¾ç¤º "),n("code",[e._v("secret not found")]),e._v(" é”™è¯¯ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  redis:\n    image: redis:latest\n    deploy:\n      replicas: 1\n    secrets:\n      - my_secret\n      - my_other_secret\nsecrets:\n  my_secret:\n    file: ./my_secret.txt\n  my_other_secret:\n    external: true\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br")])]),n("h4",{attrs:{id:"é•¿è¯­æ³•-3"}},[e._v("é•¿è¯­æ³•")]),e._v(" "),n("p",[e._v("é•¿è¯­æ³•æä¾›äº†åœ¨æœåŠ¡çš„ä»»åŠ¡å®¹å™¨ä¸­å¦‚ä½•åˆ›å»ºæœºå¯†çš„æ›´å¤šç²’åº¦ã€‚")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("source")]),e._v(" ï¼šç§˜å¯†çš„åç§°ï¼Œå› ä¸ºå®ƒå­˜åœ¨äºDockerä¸­ã€‚")]),e._v(" "),n("li",[n("code",[e._v("target")]),e._v(" ï¼šè¦ "),n("code",[e._v("/run/secrets/")]),e._v(" åœ¨æœåŠ¡çš„ä»»åŠ¡å®¹å™¨ä¸­ æŒ‚è½½çš„æ–‡ä»¶çš„åç§° ã€‚ "),n("code",[e._v("source")]),e._v(" å¦‚æœæœªæŒ‡å®š ï¼Œ åˆ™ é»˜è®¤ä¸º ã€‚")]),e._v(" "),n("li",[n("code",[e._v("uid")]),e._v(" å’Œ "),n("code",[e._v("gid")]),e._v(" ï¼š "),n("code",[e._v("/run/secrets/")]),e._v(" åœ¨æœåŠ¡çš„ä»»åŠ¡å®¹å™¨ ä¸­æ‹¥æœ‰æ–‡ä»¶çš„æ•°å­—UIDæˆ–GID ã€‚ "),n("code",[e._v("0")]),e._v(" å¦‚æœæœªæŒ‡å®š ï¼Œ åˆ™ ä¸¤è€…éƒ½é»˜è®¤ä¸º ã€‚")]),e._v(" "),n("li",[n("code",[e._v("mode")]),e._v(" ï¼šæ–‡ä»¶çš„æƒé™ä»¥ "),n("code",[e._v("/run/secrets/")]),e._v(" å…«è¿›åˆ¶è¡¨ç¤ºæ³• è£…å…¥ æœåŠ¡çš„ä»»åŠ¡å®¹å™¨ä¸­ã€‚ ä¾‹å¦‚ï¼Œ "),n("code",[e._v("0444")]),e._v(" è¡¨ç¤ºä¸–ç•Œå¯è¯»ã€‚ Docker 1.13.1ä¸­çš„é»˜è®¤å€¼ä¸º "),n("code",[e._v("0000")]),e._v(" ï¼Œä½†æ˜¯æ˜¯ "),n("code",[e._v("0444")]),e._v(" è¾ƒæ–°çš„ç‰ˆæœ¬ã€‚ æœºå¯†ä¿¡æ¯ä¸å¯å†™ï¼Œå› ä¸ºå®ƒä»¬å·²å®‰è£…åœ¨ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå› æ­¤ï¼Œå¦‚æœè®¾ç½®äº†å¯å†™ä½ï¼Œå®ƒå°†è¢«å¿½ç•¥ã€‚ å¯æ‰§è¡Œä½å¯ä»¥è®¾ç½®ã€‚ å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰UNIXæ–‡ä»¶æƒé™æ¨¡å¼ï¼Œåˆ™å¯èƒ½ä¼šå‘ç°æ­¤ "),n("a",{attrs:{href:"http://permissions-calculator.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("æƒé™è®¡ç®—å™¨"),n("OutboundLink")],1),e._v(" å¾ˆæœ‰ç”¨ã€‚")])]),e._v(" "),n("p",[e._v("çš„ä¸‹é¢çš„ç¤ºä¾‹é›†åç§° "),n("code",[e._v("my_secret")]),e._v(" ä»¥ "),n("code",[e._v("redis_secret")]),e._v(" åœ¨å®¹å™¨å†…ï¼Œå°†æ¨¡å¼è®¾å®šä¸º "),n("code",[e._v("0440")]),e._v(" ï¼ˆç»„å¯è¯»ï¼‰å’Œå¥—åœ¨ç”¨æˆ·å’Œç»„ "),n("code",[e._v("103")]),e._v(" ã€‚ è¯¥ "),n("code",[e._v("redis")]),e._v(" æœåŠ¡æ— æƒè®¿é—®è¯¥ "),n("code",[e._v("my_other_secret")]),e._v(" æœºå¯†ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("version: \"3.8\"\nservices:\n  redis:\n    image: redis:latest\n    deploy:\n      replicas: 1\n    secrets:\n      - source: my_secret\n        target: redis_secret\n        uid: '103'\n        gid: '103'\n        mode: 0440\nsecrets:\n  my_secret:\n    file: ./my_secret.txt\n  my_other_secret:\n    external: true\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br")])]),n("p",[e._v("æ‚¨å¯ä»¥æˆäºˆæœåŠ¡è®¿é—®å¤šä¸ªæœºå¯†çš„æƒé™ï¼Œå¹¶ä¸”å¯ä»¥æ··åˆé•¿çŸ­è¯­æ³•ã€‚ å®šä¹‰æœºå¯†å¹¶ä¸æ„å‘³ç€æˆäºˆæœåŠ¡å¯¹å…¶çš„è®¿é—®æƒé™ã€‚")]),e._v(" "),n("h3",{attrs:{id:"security-opt-ğŸ”—"}},[e._v("security_opt "),n("a",{attrs:{href:"#security_opt"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("è¦†ç›–æ¯ä¸ªå®¹å™¨çš„é»˜è®¤æ ‡ç­¾æ–¹æ¡ˆã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("security_opt:\n  - label:user:USER\n  - label:role:ROLE\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨ä»¥ç¾¤é›†æ¨¡å¼éƒ¨ç½²å †æ ˆ"),n("OutboundLink")],1),e._v(" "),n("code",[e._v("security_opt")]),e._v(" æ—¶ï¼Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å°†"),n("OutboundLink")],1),e._v(" å¿½ç•¥ è¯¥ é€‰é¡¹ ã€‚")])]),e._v(" "),n("h3",{attrs:{id:"stop-grace-period-ğŸ”—"}},[e._v("stop_grace_period "),n("a",{attrs:{href:"#stop_grace_period"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æŒ‡å®š "),n("a",{attrs:{href:"#stop_signal"}},[n("code",[e._v("stop_signal")])]),e._v(" åœ¨å‘é€SIGKILLä¹‹å‰ï¼Œ å¦‚æœå®¹å™¨æ— æ³•å¤„ç†SIGTERMï¼ˆæˆ–å·²ä½¿ç”¨æŒ‡å®šçš„ä»»ä½•åœæ­¢ä¿¡å·ï¼‰è€Œè¯•å›¾åœæ­¢å®¹å™¨çš„ç­‰å¾…æ—¶é—´ ã€‚ æŒ‡å®šä¸º "),n("a",{attrs:{href:"#specifying-durations"}},[e._v("æŒç»­æ—¶é—´")]),e._v(" ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("stop_grace_period: 1s\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("stop_grace_period: 1m30s\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("p",[e._v("é»˜è®¤æƒ…å†µä¸‹ï¼Œ "),n("code",[e._v("stop")]),e._v(" åœ¨å‘é€SIGKILLä¹‹å‰ç­‰å¾…å®¹å™¨é€€å‡º10ç§’é’Ÿã€‚")]),e._v(" "),n("h3",{attrs:{id:"stop-signal-ğŸ”—"}},[e._v("stop_signal "),n("a",{attrs:{href:"#stop_signal"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("è®¾ç½®æ›¿ä»£ä¿¡å·ä»¥åœæ­¢å®¹å™¨ã€‚ é»˜è®¤æƒ…å†µä¸‹ "),n("code",[e._v("stop")]),e._v(" ä½¿ç”¨SIGTERMã€‚ ä½¿ç”¨ "),n("code",[e._v("stop_signal")]),e._v(" åŸå›  è®¾ç½®æ›¿ä»£ä¿¡å· ä¼š "),n("code",[e._v("stop")]),e._v(" æ”¹ä¸ºå‘é€è¯¥ä¿¡å·ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("stop_signal: SIGUSR1\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("h3",{attrs:{id:"çš„sysctl-ğŸ”—"}},[e._v("çš„sysctl "),n("a",{attrs:{href:"#sysctls"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("è¦åœ¨å®¹å™¨ä¸­è®¾ç½®å†…æ ¸å‚æ•°ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨æ•°ç»„æˆ–å­—å…¸ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("sysctls:\n  net.core.somaxconn: 1024\n  net.ipv4.tcp_syncookies: 0\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("sysctls:\n  - net.core.somaxconn=1024\n  - net.ipv4.tcp_syncookies=0\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("p",[e._v("æ‚¨åªèƒ½ä½¿ç”¨å†…æ ¸ä¸­å·²å‘½åç©ºé—´çš„sysctlsã€‚ Dockerä¸æ”¯æŒæ›´æ”¹ä¹Ÿä¼šä¿®æ”¹ä¸»æœºç³»ç»Ÿçš„å®¹å™¨å†…çš„sysctlsã€‚ æœ‰å…³å—æ”¯æŒçš„sysctlsçš„æ¦‚è¿°ï¼Œè¯·å‚é˜… "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/run/#configure-namespaced-kernel-parameters-sysctls-at-runtime",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨è¿è¡Œæ—¶é…ç½®å‘½åç©ºé—´çš„å†…æ ¸å‚æ•°ï¼ˆsysctlsï¼‰"),n("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨ä»¥é›†ç¾¤æ¨¡å¼éƒ¨ç½²å †æ ˆ"),n("OutboundLink")],1),e._v(" æ—¶ï¼Œæ­¤é€‰é¡¹éœ€è¦Docker Engine 19.03æˆ–æ›´é«˜ç‰ˆæœ¬ ã€‚")])]),e._v(" "),n("h3",{attrs:{id:"tmpfsçš„-ğŸ”—"}},[e._v("tmpfsçš„ "),n("a",{attrs:{href:"#tmpfs"}},[e._v("ğŸ”—")])]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-36",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.6ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")])]),e._v(" "),n("p",[e._v("åœ¨å®¹å™¨å†…å®‰è£…ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿã€‚ å¯ä»¥æ˜¯å•ä¸ªå€¼æˆ–åˆ—è¡¨ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("tmpfs: /run\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("tmpfs:\n  - /run\n  - /tmp\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨"),n("OutboundLink")],1),e._v(" ä»¥ï¼ˆ3-3.5ç‰ˆï¼‰æ’°å†™æ–‡ä»¶ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ä»¥ç¾¤é›†æ¨¡å¼éƒ¨ç½²å †æ ˆ"),n("OutboundLink")],1),e._v(" æ—¶ï¼Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å°†"),n("OutboundLink")],1),e._v(" å¿½ç•¥æ­¤é€‰é¡¹ ã€‚")])]),e._v(" "),n("p",[e._v("åœ¨å®¹å™¨å†…å®‰è£…ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿã€‚ Sizeå‚æ•°æŒ‡å®štmpfså®‰è£…çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚ é»˜è®¤æƒ…å†µä¸‹ä¸å—é™åˆ¶ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("- type: tmpfs\n  target: /app\n  tmpfs:\n    size: 1000\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("h3",{attrs:{id:"ulimits-ğŸ”—"}},[e._v("ulimits "),n("a",{attrs:{href:"#ulimits"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("è¦†ç›–å®¹å™¨çš„é»˜è®¤ulimitã€‚ æ‚¨å¯ä»¥å°†å•ä¸ªé™åˆ¶æŒ‡å®šä¸ºæ•´æ•°ï¼Œä¹Ÿå¯ä»¥å°†è½¯/ç¡¬é™åˆ¶æŒ‡å®šä¸ºæ˜ å°„ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("ulimits:\n  nproc: 65535\n  nofile:\n    soft: 20000\n    hard: 40000\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("h3",{attrs:{id:"userns-mode-ğŸ”—"}},[e._v("userns_mode "),n("a",{attrs:{href:"#userns_mode"}},[e._v("ğŸ”—")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('userns_mode: "host"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("p",[e._v("å¦‚æœDockerå®ˆæŠ¤ç¨‹åºé…ç½®äº†ç”¨æˆ·åç§°ç©ºé—´ï¼Œåˆ™ç¦ç”¨æ­¤æœåŠ¡çš„ç”¨æˆ·åç§°ç©ºé—´ã€‚ æœ‰å…³ æ›´å¤šä¿¡æ¯ï¼Œ è¯·å‚è§ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/dockerd/#disable-user-namespace-for-a-container",target:"_blank",rel:"noopener noreferrer"}},[e._v("dockerd"),n("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("åœ¨ä»¥ç¾¤é›†æ¨¡å¼éƒ¨ç½²å †æ ˆ"),n("OutboundLink")],1),e._v(" "),n("code",[e._v("userns_mode")]),e._v(" æ—¶ï¼Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/stack_deploy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å°†"),n("OutboundLink")],1),e._v(" å¿½ç•¥ è¯¥ é€‰é¡¹ ã€‚")])]),e._v(" "),n("h3",{attrs:{id:"å·-ğŸ”—"}},[e._v("å· "),n("a",{attrs:{href:"#volumes"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æŒ‚è½½ä¸»æœºè·¯å¾„æˆ–å‘½åå·ï¼ŒæŒ‡å®šä¸ºæœåŠ¡çš„å­é€‰é¡¹ã€‚")]),e._v(" "),n("p",[e._v("æ‚¨å¯ä»¥å°†ä¸»æœºè·¯å¾„å®‰è£…ä¸ºå•ä¸ªæœåŠ¡çš„å®šä¹‰çš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ— éœ€åœ¨é¡¶çº§ "),n("code",[e._v("volumes")]),e._v(" å¯†é’¥ä¸­ è¿›è¡Œå®šä¹‰ ã€‚")]),e._v(" "),n("p",[e._v("ä½†æ˜¯ï¼Œå¦‚æœè¦è·¨å¤šä¸ªæœåŠ¡é‡ç”¨å·ï¼Œè¯·åœ¨ "),n("a",{attrs:{href:"#volume-configuration-reference"}},[e._v("é¡¶çº§ "),n("code",[e._v("volumes")]),e._v(" é”®ä¸­")]),e._v(" å®šä¹‰ä¸€ä¸ªå‘½åå· ã€‚ å°†å‘½åå·ä¸ "),n("a",{attrs:{href:"#volumes-for-services-swarms-and-stack-files"}},[e._v("æœåŠ¡ï¼Œç¾¤é›†å’Œå †æ ˆæ–‡ä»¶ä¸€èµ·ä½¿ç”¨")]),e._v(" ã€‚")]),e._v(" "),n("blockquote",[n("p",[e._v("æ›´æ”¹ä¸º "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-3",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç‰ˆæœ¬3"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ã€‚")]),e._v(" "),n("p",[e._v("é¡¶çº§ "),n("a",{attrs:{href:"#volume-configuration-reference"}},[e._v("å·")]),e._v(" é”®å®šä¹‰äº†ä¸€ä¸ªå‘½åå·ï¼Œå¹¶ä»æ¯ä¸ªæœåŠ¡çš„ "),n("code",[e._v("volumes")]),e._v(" åˆ—è¡¨ä¸­ å¼•ç”¨äº†è¯¥å· ã€‚ è¿™å°†æ›¿æ¢ "),n("code",[e._v("volumes_from")]),e._v(" æ—©æœŸç‰ˆæœ¬çš„Composeæ–‡ä»¶æ ¼å¼ã€‚")])]),e._v(" "),n("p",[e._v("æ­¤ç¤ºä¾‹æ˜¾ç¤ºäº† æœåŠ¡ "),n("code",[e._v("mydata")]),e._v(" æ­£åœ¨ä½¿ç”¨ çš„å‘½åå·ï¼ˆ ï¼‰ "),n("code",[e._v("web")]),e._v(" ï¼Œä»¥åŠä¸ºå•ä¸ªæœåŠ¡ï¼ˆ "),n("code",[e._v("db")]),e._v(" service ä¹‹ä¸‹çš„ç¬¬ä¸€ä¸ªè·¯å¾„ "),n("code",[e._v("volumes")]),e._v(" ï¼‰ å®šä¹‰çš„ç»‘å®šå®‰è£… ã€‚ è¯¥ "),n("code",[e._v("db")]),e._v(" æœåŠ¡è¿˜ä½¿ç”¨ä¸€ä¸ªåä¸º "),n("code",[e._v("dbdata")]),e._v(" ï¼ˆ "),n("code",[e._v("db")]),e._v(" service ä¸‹çš„ç¬¬äºŒè·¯å¾„ "),n("code",[e._v("volumes")]),e._v(" ï¼‰ çš„å‘½åå· ï¼Œä½†æ˜¯ä½¿ç”¨æ—§çš„å­—ç¬¦ä¸²æ ¼å¼å®šä¹‰è¯¥å·ä»¥è£…å…¥å‘½åå·ã€‚ "),n("code",[e._v("volumes")]),e._v(" å¦‚å›¾æ‰€ç¤ºï¼Œ å‘½åå·å¿…é¡»åœ¨é¡¶çº§ é”®ä¸‹åˆ—å‡ºã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  web:\n    image: nginx:alpine\n    volumes:\n      - type: volume\n        source: mydata\n        target: /data\n        volume:\n          nocopy: true\n      - type: bind\n        source: ./static\n        target: /opt/app/static\n\n  db:\n    image: postgres:latest\n    volumes:\n      - "/var/run/postgres/postgres.sock:/var/run/postgres/postgres.sock"\n      - "dbdata:/var/lib/postgresql/data"\n\nvolumes:\n  mydata:\n  dbdata:\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br"),n("span",{staticClass:"line-number"},[e._v("23")]),n("br"),n("span",{staticClass:"line-number"},[e._v("24")]),n("br")])]),n("blockquote",[n("p",[n("strong",[e._v("æ³¨æ„")])]),e._v(" "),n("p",[e._v("æœ‰å…³å·çš„ä¸€èˆ¬ä¿¡æ¯ï¼Œè¯·å‚é˜… æ–‡æ¡£ä¸­çš„ â€œ "),n("a",{attrs:{href:"https://docs.docker.com/storage/volumes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ä½¿ç”¨å·"),n("OutboundLink")],1),e._v(" å’Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/extend/plugins_volume/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å·æ’ä»¶â€"),n("OutboundLink")],1),e._v(" éƒ¨åˆ†ã€‚")])]),e._v(" "),n("h4",{attrs:{id:"çŸ­è¯­æ³•-4"}},[e._v("çŸ­è¯­æ³•")]),e._v(" "),n("p",[e._v("ç®€çŸ­è¯­æ³•ä½¿ç”¨é€šç”¨ "),n("code",[e._v("[SOURCE:]TARGET[:MODE]")]),e._v(" æ ¼å¼ï¼Œå…¶ä¸­ "),n("code",[e._v("SOURCE")]),e._v(" å¯ä»¥æ˜¯ä¸»æœºè·¯å¾„æˆ–å·åã€‚ "),n("code",[e._v("TARGET")]),e._v(" æ˜¯å®‰è£…å·çš„å®¹å™¨è·¯å¾„ã€‚ æ ‡å‡†æ¨¡å¼é€‚ç”¨ "),n("code",[e._v("ro")]),e._v(" äºåªè¯»å’Œ "),n("code",[e._v("rw")]),e._v(" è¯»å†™ï¼ˆé»˜è®¤ï¼‰ã€‚")]),e._v(" "),n("p",[e._v("æ‚¨å¯ä»¥åœ¨ä¸»æœºä¸Šå®‰è£…ç›¸å¯¹è·¯å¾„ï¼Œè¯¥ç›¸å¯¹è·¯å¾„ç›¸å¯¹äºæ­£åœ¨ä½¿ç”¨çš„Composeé…ç½®æ–‡ä»¶çš„ç›®å½•è¿›è¡Œæ‰©å±•ã€‚ ç›¸å¯¹è·¯å¾„åº”å§‹ç»ˆä»¥ "),n("code",[e._v(".")]),e._v(" æˆ– å¼€å¤´ "),n("code",[e._v("..")]),e._v(" ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("volumes:\n  # Just specify a path and let the Engine create a volume\n  - /var/lib/mysql\n\n  # Specify an absolute path mapping\n  - /opt/data:/var/lib/mysql\n\n  # Path on the host, relative to the Compose file\n  - ./cache:/tmp/cache\n\n  # User-relative path\n  - ~/configs:/etc/configs/:ro\n\n  # Named volume\n  - datavolume:/var/lib/mysql\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br")])]),n("h4",{attrs:{id:"é•¿è¯­æ³•-4"}},[e._v("é•¿è¯­æ³•")]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-32",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.2ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")])]),e._v(" "),n("p",[e._v("é•¿æ ¼å¼è¯­æ³•å…è®¸é…ç½®å…¶ä»–ä¸èƒ½ä»¥çŸ­æ ¼å¼è¡¨ç¤ºçš„å­—æ®µã€‚")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("type")]),e._v(" ï¼šæ‰€è¿°å®‰è£…å‹ "),n("code",[e._v("volume")]),e._v(" ï¼Œ "),n("code",[e._v("bind")]),e._v(" ï¼Œ "),n("code",[e._v("tmpfs")]),e._v(" æˆ– "),n("code",[e._v("npipe")])]),e._v(" "),n("li",[n("code",[e._v("source")]),e._v(" ï¼šæŒ‚è½½çš„æºï¼Œä¸»æœºä¸Šç”¨äºç»‘å®šæŒ‚è½½çš„è·¯å¾„æˆ– "),n("a",{attrs:{href:"#volume-configuration-reference"}},[e._v("é¡¶çº§ "),n("code",[e._v("volumes")]),e._v(" å¯†é’¥ä¸­")]),e._v(" å®šä¹‰çš„å·çš„åç§° ã€‚ ä¸é€‚ç”¨äºtmpfsæŒ‚è½½ã€‚")]),e._v(" "),n("li",[n("code",[e._v("target")]),e._v(" ï¼šå®‰è£…äº†å·çš„å®¹å™¨ä¸­çš„è·¯å¾„")]),e._v(" "),n("li",[n("code",[e._v("read_only")]),e._v(" ï¼šå°†å·è®¾ç½®ä¸ºåªè¯»çš„æ ‡å¿—")]),e._v(" "),n("li",[n("code",[e._v("bind")]),e._v(" ï¼šé…ç½®å…¶ä»–ç»‘å®šé€‰é¡¹\n"),n("ul",[n("li",[n("code",[e._v("propagation")]),e._v(" ï¼šç”¨äºç»‘å®šçš„ä¼ æ’­æ¨¡å¼")])])]),e._v(" "),n("li",[n("code",[e._v("volume")]),e._v(" ï¼šé…ç½®å…¶ä»–éŸ³é‡é€‰é¡¹\n"),n("ul",[n("li",[n("code",[e._v("nocopy")]),e._v(" ï¼šåˆ›å»ºå·æ—¶ç¦ç”¨ä»å®¹å™¨ä¸­å¤åˆ¶æ•°æ®çš„æ ‡å¿—")])])]),e._v(" "),n("li",[n("code",[e._v("tmpfs")]),e._v(" ï¼šé…ç½®å…¶ä»–tmpfsé€‰é¡¹\n"),n("ul",[n("li",[n("code",[e._v("size")]),e._v(" ï¼štmpfsæŒ‚è½½çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰")])])]),e._v(" "),n("li",[n("code",[e._v("consistency")]),e._v(" ï¼šè£…è½½çš„ä¸€è‡´æ€§è¦æ±‚ï¼Œ "),n("code",[e._v("consistent")]),e._v(" ï¼ˆä¸»æœºå’Œå®¹å™¨å…·æœ‰ç›¸åŒçš„è§†å›¾ï¼‰ï¼Œ "),n("code",[e._v("cached")]),e._v(" ï¼ˆè¯»ç¼“å­˜ï¼Œä¸»æœºè§†å›¾å…·æœ‰æƒå¨æ€§ï¼‰æˆ– "),n("code",[e._v("delegated")]),e._v(" ï¼ˆè¯»å†™ç¼“å­˜ï¼Œå®¹å™¨çš„è§†å›¾å…·æœ‰æƒå¨æ€§ï¼‰ä¹‹ä¸€")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  web:\n    image: nginx:alpine\n    ports:\n      - "80:80"\n    volumes:\n      - type: volume\n        source: mydata\n        target: /data\n        volume:\n          nocopy: true\n      - type: bind\n        source: ./static\n        target: /opt/app/static\n\nnetworks:\n  webnet:\n\nvolumes:\n  mydata:\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br")])]),n("blockquote",[n("p",[n("strong",[e._v("æ³¨æ„")])]),e._v(" "),n("p",[e._v("åˆ›å»ºç»‘å®šå®‰è£…æ—¶ï¼Œä½¿ç”¨é•¿è¯­æ³•è¦æ±‚äº‹å…ˆåˆ›å»ºå¼•ç”¨çš„æ–‡ä»¶å¤¹ã€‚ å¦‚æœè¯¥æ–‡ä»¶å¤¹ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨çŸ­è¯­æ³•ç«‹å³åˆ›å»ºè¯¥æ–‡ä»¶å¤¹ã€‚ æœ‰å…³ æ›´å¤šä¿¡æ¯ï¼Œ è¯·å‚è§ "),n("a",{attrs:{href:"https://docs.docker.com/storage/bind-mounts/#differences-between--v-and---mount-behavior",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç»‘å®šå®‰è£…æ–‡æ¡£"),n("OutboundLink")],1),e._v(" ã€‚")])]),e._v(" "),n("h4",{attrs:{id:"æœåŠ¡ï¼Œç¾¤é›†å’Œå †æ ˆæ–‡ä»¶çš„å·"}},[e._v("æœåŠ¡ï¼Œç¾¤é›†å’Œå †æ ˆæ–‡ä»¶çš„å·")]),e._v(" "),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[e._v("ä½¿ç”¨æœåŠ¡ï¼Œç¾¤é›†å’Œ "),n("code",[e._v("docker-stack.yml")]),e._v(" æ–‡ä»¶æ—¶ï¼Œè¯·è®°ä½ï¼Œæ”¯æŒæœåŠ¡çš„ä»»åŠ¡ï¼ˆå®¹å™¨ï¼‰å¯ä»¥éƒ¨ç½²åœ¨ç¾¤é›†ä¸­çš„ä»»ä½•èŠ‚ç‚¹ä¸Šï¼Œå¹¶ä¸”æ¯æ¬¡æ›´æ–°æœåŠ¡æ—¶ï¼Œè¯¥èŠ‚ç‚¹éƒ½å¯ä»¥æ˜¯ä¸åŒçš„èŠ‚ç‚¹ã€‚")])]),e._v(" "),n("p",[e._v("åœ¨æ²¡æœ‰å…·æœ‰æŒ‡å®šæºçš„å‘½åå·çš„æƒ…å†µä¸‹ï¼ŒDockerä¸ºæ”¯æŒæœåŠ¡çš„æ¯ä¸ªä»»åŠ¡åˆ›å»ºä¸€ä¸ªåŒ¿åå·ã€‚ åˆ é™¤å…³è”çš„å®¹å™¨åï¼ŒåŒ¿åå·ä¸ä¼šç»§ç»­å­˜åœ¨ã€‚")]),e._v(" "),n("p",[e._v("å¦‚æœè¦ä¿ç•™æ•°æ®ï¼Œè¯·ä½¿ç”¨å‘½åå·å’Œæ”¯æŒå¤šä¸»æœºçš„å·é©±åŠ¨ç¨‹åºï¼Œä»¥ä¾¿å¯ä»¥ä»ä»»ä½•èŠ‚ç‚¹è®¿é—®æ•°æ®ã€‚ æˆ–è€…ï¼Œå¯¹æœåŠ¡è®¾ç½®çº¦æŸï¼Œä»¥ä¾¿å°†å…¶ä»»åŠ¡éƒ¨ç½²åœ¨å…·æœ‰è¯¥å·çš„èŠ‚ç‚¹ä¸Šã€‚")]),e._v(" "),n("p",[e._v("ä¾‹å¦‚ï¼Œ "),n("a",{attrs:{href:"https://github.com/docker/labs/blob/master/beginner/chapters/votingapp.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker Labsä¸­votingappç¤ºä¾‹"),n("OutboundLink")],1),e._v(" çš„ "),n("code",[e._v("docker-stack.yml")]),e._v(" æ–‡ä»¶ å®šä¹‰äº†ä¸€ä¸ªç§°ä¸º è¿è¡Œ æ•°æ®åº“çš„æœåŠ¡ã€‚ å®ƒè¢«é…ç½®ä¸ºå‘½åå·ä»¥å°†æ•°æ®æŒä¹…å­˜å‚¨åœ¨ç¾¤é›†ä¸­ï¼Œ"),n("em",[e._v("å¹¶ä¸”")]),e._v(" è¢«é™åˆ¶ä¸ºä»…åœ¨ èŠ‚ç‚¹ ä¸Šè¿è¡Œ ã€‚ è¿™æ˜¯è¯¥æ–‡ä»¶ä¸­çš„ç›¸å…³ç‰‡æ®µï¼š "),n("a",{attrs:{href:"https://github.com/docker/labs/blob/master/beginner/chapters/votingapp.md",target:"_blank",rel:"noopener noreferrer"}},[n("OutboundLink")],1),n("code",[e._v("db")]),e._v(" "),n("code",[e._v("postgres")]),e._v(" "),n("code",[e._v("manager")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  db:\n    image: postgres:9.4\n    volumes:\n      - db-data:/var/lib/postgresql/data\n    networks:\n      - backend\n    deploy:\n      placement:\n        constraints: [node.role == manager]\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br")])]),n("h4",{attrs:{id:"å·è£…è½½çš„ç¼“å­˜é€‰é¡¹ï¼ˆé€‚ç”¨äºmacçš„dockeræ¡Œé¢ï¼‰"}},[e._v("å·è£…è½½çš„ç¼“å­˜é€‰é¡¹ï¼ˆé€‚ç”¨äºMacçš„Dockeræ¡Œé¢ï¼‰")]),e._v(" "),n("p",[e._v("æ‚¨å¯ä»¥åœ¨Composeæ–‡ä»¶ä¸­ä¸ºç»‘å®šå®‰è£…çš„ç›®å½•é…ç½®å®¹å™¨å’Œä¸»æœºçš„ä¸€è‡´æ€§è¦æ±‚ï¼Œä»¥æé«˜è¯»/å†™å·å®‰è£…çš„æ€§èƒ½ã€‚ è¿™äº›é€‰é¡¹è§£å†³äº† "),n("code",[e._v("osxfs")]),e._v(" æ–‡ä»¶å…±äº« æ‰€ç‰¹æœ‰çš„é—®é¢˜ ï¼Œå› æ­¤ä»…é€‚ç”¨äºMacçš„Docker Desktopã€‚")]),e._v(" "),n("p",[e._v("æ ‡å¿—æ˜¯ï¼š")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("consistent")]),e._v(" ï¼šå®Œå…¨ä¸€è‡´ã€‚ å®¹å™¨è¿è¡Œæ—¶å’Œä¸»æœºå§‹ç»ˆä¿æŒç›¸åŒçš„å®‰è£…è§†å›¾ã€‚ è¿™æ˜¯é»˜è®¤å€¼ã€‚")]),e._v(" "),n("li",[n("code",[e._v("cached")]),e._v(" ï¼šä¸»æœºå¯¹æŒ‚è½½çš„è§‚ç‚¹æ˜¯æƒå¨çš„ã€‚ åœ¨å®¹å™¨ä¸­å¯ä»¥çœ‹åˆ°ä¸»æœºä¸Šæ‰€åšçš„æ›´æ–°ï¼Œè¿™å¯èƒ½ä¼šæœ‰æ‰€å»¶è¿Ÿã€‚")]),e._v(" "),n("li",[n("code",[e._v("delegated")]),e._v(" ï¼šå®¹å™¨è¿è¡Œæ—¶çš„æŒ‚è½½è§†å›¾å…·æœ‰æƒå¨æ€§ã€‚ åœ¨ä¸»æœºä¸Šçœ‹åˆ°å®¹å™¨ä¸­æ‰€åšçš„æ›´æ–°ä¹‹å‰å¯èƒ½ä¼šæœ‰æ‰€å»¶è¿Ÿã€‚")])]),e._v(" "),n("p",[e._v("è¿™æ˜¯å°†å·é…ç½®ä¸ºçš„ç¤ºä¾‹ "),n("code",[e._v("cached")]),e._v(" ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  php:\n    image: php:7.1-fpm\n    ports:\n      - "9000"\n    volumes:\n      - .:/var/www/project:cached\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br")])]),n("p",[e._v("æœ‰å…³è¿™äº›æ ‡å¿—ï¼Œå®ƒä»¬æ‰€è§£å†³çš„é—®é¢˜ä»¥åŠ "),n("code",[e._v("docker run")]),e._v(" ä¸ä¹‹å¯¹åº” çš„é—®é¢˜çš„å®Œæ•´è¯¦ç»†ä¿¡æ¯ï¼Œè¯· å‚è§Docker Desktop for Macä¸»é¢˜ "),n("a",{attrs:{href:"https://docs.docker.com/docker-for-mac/osxfs-caching/",target:"_blank",rel:"noopener noreferrer"}},[e._v("â€œé’ˆå¯¹å·æŒ‚è½½ï¼ˆå…±äº«æ–‡ä»¶ç³»ç»Ÿï¼‰çš„æ€§èƒ½è°ƒæ•´â€"),n("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),n("h3",{attrs:{id:"åŸŸåï¼Œä¸»æœºåï¼Œipcï¼Œmac-addressï¼Œç‰¹æƒï¼Œread-onlyï¼Œshm-sizeï¼Œstdin-openï¼Œttyç”¨æˆ·ï¼Œworking-dir-ğŸ”—"}},[e._v("åŸŸåï¼Œä¸»æœºåï¼ŒIPCï¼ŒMAC_ADDRESSï¼Œç‰¹æƒï¼ŒREAD_ONLYï¼Œshm_sizeï¼Œstdin_openï¼ŒTTYç”¨æˆ·ï¼Œworking_dir "),n("a",{attrs:{href:"#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("å…¶ä¸­æ¯ä¸ªéƒ½æ˜¯ä¸€ä¸ªå€¼ï¼Œç±»ä¼¼äºå…¶ "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/run/",target:"_blank",rel:"noopener noreferrer"}},[e._v("docker run"),n("OutboundLink")],1),e._v(" å¯¹åº”é¡¹ã€‚ è¯·æ³¨æ„ï¼Œè¿™ "),n("code",[e._v("mac_address")]),e._v(" æ˜¯ä¸€ä¸ªæ—§é€‰é¡¹ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("user: postgresql\nworking_dir: /code\n\ndomainname: foo.com\nhostname: foo\nipc: host\nmac_address: 02:42:ac:11:65:43\n\nprivileged: true\n\nread_only: true\nshm_size: 64M\nstdin_open: true\ntty: true\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br")])]),n("h2",{attrs:{id:"æŒ‡å®šæŒç»­æ—¶é—´-ğŸ”—"}},[e._v("æŒ‡å®šæŒç»­æ—¶é—´ "),n("a",{attrs:{href:"#specifying-durations"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æŸäº›é…ç½®é€‰é¡¹ï¼ˆä¾‹å¦‚çš„ "),n("code",[e._v("interval")]),e._v(" å’Œ "),n("code",[e._v("timeout")]),e._v(" å­é€‰é¡¹ï¼‰ "),n("a",{attrs:{href:"#healthcheck"}},[n("code",[e._v("check")])]),e._v(" å°†æŒç»­æ—¶é—´ä½œä¸ºå­—ç¬¦ä¸²æ¥å—ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("2.5s\n10s\n1m30s\n2h32m\n5h34m56s\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("p",[e._v("æ”¯æŒçš„å•ä½æ˜¯ "),n("code",[e._v("us")]),e._v(" ï¼Œ "),n("code",[e._v("ms")]),e._v(" ï¼Œ "),n("code",[e._v("s")]),e._v(" ï¼Œ "),n("code",[e._v("m")]),e._v(" å’Œ "),n("code",[e._v("h")]),e._v(" ã€‚")]),e._v(" "),n("h2",{attrs:{id:"æŒ‡å®šå­—èŠ‚å€¼-ğŸ”—"}},[e._v("æŒ‡å®šå­—èŠ‚å€¼ "),n("a",{attrs:{href:"#specifying-byte-values"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("ä¸€äº›é…ç½®é€‰é¡¹ï¼ˆä¾‹å¦‚çš„ "),n("code",[e._v("shm_size")]),e._v(" å­é€‰é¡¹ï¼‰ "),n("a",{attrs:{href:"#build"}},[n("code",[e._v("build")])]),e._v(" å°†å­—èŠ‚å€¼ä½œä¸ºå­—ç¬¦ä¸²æ¥å—ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("2b\n1024kb\n2048k\n300m\n1gb\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("p",[e._v("æ”¯æŒçš„å•ä½æ˜¯ "),n("code",[e._v("b")]),e._v(" ï¼Œ "),n("code",[e._v("k")]),e._v(" ï¼Œ "),n("code",[e._v("m")]),e._v(" å’Œ "),n("code",[e._v("g")]),e._v(" ï¼Œå’Œå®ƒä»¬çš„æ›¿ä»£ç¬¦å· "),n("code",[e._v("kb")]),e._v(" ï¼Œ "),n("code",[e._v("mb")]),e._v(" å’Œ "),n("code",[e._v("gb")]),e._v(" ã€‚ ç›®å‰ä¸æ”¯æŒåè¿›åˆ¶å€¼ã€‚")]),e._v(" "),n("h2",{attrs:{id:"å·é…ç½®å‚è€ƒ-ğŸ”—"}},[e._v("å·é…ç½®å‚è€ƒ "),n("a",{attrs:{href:"#volume-configuration-reference"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("è™½ç„¶å¯ä»¥ç”³æŠ¥ "),n("a",{attrs:{href:"#volumes"}},[e._v("å·")]),e._v(" ä¸Šé£ä½œä¸ºæœåŠ¡å£°æ˜çš„ä¸€éƒ¨åˆ†ï¼Œè¿™éƒ¨åˆ†å…è®¸æ‚¨åˆ›å»ºå¯åœ¨å¤šä¸ªæœåŠ¡ä¸­é‡å¤ä½¿ç”¨ï¼ˆä¸ä¾èµ–äºä¸€ä¸ªåä¸ºå· "),n("code",[e._v("volumes_from")]),e._v(" æˆ–ï¼‰ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“æ£€ç´¢å’Œä½¿ç”¨æ³Šåçª—å‘½ä»¤è¡Œæ¥å—è§†APIã€‚ æœ‰å…³ æ›´å¤šä¿¡æ¯ï¼Œ è¯·å‚é˜… "),n("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/volume_create/",target:"_blank",rel:"noopener noreferrer"}},[e._v("docker volume"),n("OutboundLink")],1),e._v(" å­å‘½ä»¤æ–‡æ¡£ã€‚")]),e._v(" "),n("p",[e._v("æœ‰å…³ "),n("a",{attrs:{href:"https://docs.docker.com/storage/volumes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å·"),n("OutboundLink")],1),e._v(" çš„ä¸€èˆ¬ä¿¡æ¯ï¼Œ è¯·å‚è§ "),n("a",{attrs:{href:"https://docs.docker.com/storage/volumes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ä½¿ç”¨å·"),n("OutboundLink")],1),e._v(" å’Œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/extend/plugins_volume/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å·æ’ä»¶"),n("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),n("p",[e._v("è¿™æ˜¯ä¸€ä¸ªä¸¤ç§æœåŠ¡è®¾ç½®çš„ç¤ºä¾‹ï¼Œå…¶ä¸­æ•°æ®åº“çš„æ•°æ®ç›®å½•ä¸å¦ä¸€ä¸ªæœåŠ¡ä½œä¸ºå·å…±äº«ï¼Œä»¥ä¾¿å¯ä»¥å®šæœŸå¤‡ä»½å®ƒï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\n\nservices:\n  db:\n    image: db\n    volumes:\n      - data-volume:/var/lib/db\n  backup:\n    image: backup-service\n    volumes:\n      - data-volume:/var/lib/backup/data\n\nvolumes:\n  data-volume:\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br")])]),n("p",[e._v("é¡¶çº§ "),n("code",[e._v("volumes")]),e._v(" é”® ä¸‹çš„æ¡ç›® å¯ä»¥ä¸ºç©ºï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä½¿ç”¨å¼•æ“é…ç½®çš„é»˜è®¤é©±åŠ¨ç¨‹åºï¼ˆåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™æ˜¯ "),n("code",[e._v("local")]),e._v(" é©±åŠ¨ç¨‹åºï¼‰ã€‚ ï¼ˆå¯é€‰ï¼‰æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é”®å¯¹å…¶è¿›è¡Œé…ç½®ï¼š")]),e._v(" "),n("h3",{attrs:{id:"å¸æœº-ğŸ”—"}},[e._v("å¸æœº "),n("a",{attrs:{href:"#driver"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æŒ‡å®šè¯¥å·åº”ä½¿ç”¨å“ªä¸ªå·é©±åŠ¨ç¨‹åºã€‚ é»˜è®¤ä¸ºDocker Engineé…ç½®ä¸ºä½¿ç”¨çš„ä»»ä½•é©±åŠ¨ç¨‹åºï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ä¸º "),n("code",[e._v("local")]),e._v(" ã€‚ å¦‚æœé©±åŠ¨ç¨‹åºä¸å¯ç”¨ï¼Œåˆ™å¼•æ“åœ¨ "),n("code",[e._v("docker-compose up")]),e._v(" å°è¯•åˆ›å»ºå· æ—¶ä¼šè¿”å›é”™è¯¯ ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("driver: foobar\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("h3",{attrs:{id:"driver-opts-ğŸ”—"}},[e._v("driver_opts "),n("a",{attrs:{href:"#driver_opts"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æŒ‡å®šé€‰é¡¹åˆ—è¡¨ä½œä¸ºé”®å€¼å¯¹ï¼Œä»¥ä¼ é€’ç»™è¯¥å·çš„é©±åŠ¨ç¨‹åºã€‚ è¿™äº›é€‰é¡¹å–å†³äºé©±åŠ¨ç¨‹åº-æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒé©±åŠ¨ç¨‹åºçš„æ–‡æ¡£ã€‚ å¯é€‰çš„ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('volumes:\n  example:\n    driver_opts:\n      type: "nfs"\n      o: "addr=10.40.0.199,nolock,soft,rw"\n      device: ":/docker/example"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br")])]),n("h3",{attrs:{id:"å¤–éƒ¨-ğŸ”—"}},[e._v("å¤–éƒ¨ "),n("a",{attrs:{href:"#external"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("å¦‚æœè®¾ç½®ä¸º "),n("code",[e._v("true")]),e._v(" ï¼Œåˆ™æŒ‡å®šæ­¤å·æ˜¯åœ¨Composeä¹‹å¤–åˆ›å»ºçš„ã€‚ "),n("code",[e._v("docker-compose up")]),e._v(" ä¸ä¼šå°è¯•åˆ›å»ºå®ƒï¼Œå¦‚æœä¸å­˜åœ¨åˆ™å¼•å‘é”™è¯¯ã€‚")]),e._v(" "),n("p",[e._v("ä¸º3.3å’Œä¸‹é¢çš„æ ¼å¼çš„ç‰ˆæœ¬ï¼Œ "),n("code",[e._v("external")]),e._v(" ä¸èƒ½åŒæ—¶ä½¿ç”¨ä¸å…¶å®ƒå·é…ç½®é”®ï¼ˆ "),n("code",[e._v("driver")]),e._v(" ï¼Œ "),n("code",[e._v("driver_opts")]),e._v(" ï¼Œ "),n("code",[e._v("labels")]),e._v(" ï¼‰ã€‚ å¯¹äº "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-34",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.4"),n("OutboundLink")],1),e._v(" åŠæ›´é«˜ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-34",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç‰ˆæœ¬ï¼Œ"),n("OutboundLink")],1),e._v(" æ­¤é™åˆ¶ä¸å†å­˜åœ¨ ã€‚")]),e._v(" "),n("p",[e._v("åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œ "),n("code",[e._v("[projectname]_data")]),e._v(" Compose ä¸ä¼šå°è¯•åˆ›å»ºä¸€ä¸ªåä¸ºçš„å·ï¼Œè€Œæ˜¯ æŸ¥æ‰¾ä¸€ä¸ªç®€å•åœ°ç§°ä¸ºçš„ç°æœ‰å· "),n("code",[e._v("data")]),e._v(" å¹¶å°†å…¶è£…å…¥ "),n("code",[e._v("db")]),e._v(" æœåŠ¡çš„å®¹å™¨ä¸­ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\n\nservices:\n  db:\n    image: postgres\n    volumes:\n      - data:/var/lib/postgresql/data\n\nvolumes:\n  data:\n    external: true\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br")])]),n("blockquote",[n("p",[e._v("ä¸å»ºè®®ä½¿ç”¨ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-34",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.4ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ã€‚")]),e._v(" "),n("p",[e._v("ä½¿ç”¨ç‰ˆæœ¬3.4æ–‡ä»¶æ ¼å¼å¼ƒç”¨äº†external.name "),n("code",[e._v("name")]),e._v(" ã€‚")])]),e._v(" "),n("p",[e._v("æ‚¨è¿˜å¯ä»¥ä¸åœ¨Composeæ–‡ä»¶ä¸­ç”¨äºå¼•ç”¨å·çš„åç§°åˆ†å¼€æŒ‡å®šå·çš„åç§°ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("volumes:\n  data:\n    external:\n      name: actual-name-of-volume\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[e._v("å¦‚æœæ‚¨ä½¿ç”¨ "),n("a",{attrs:{href:"#deploy"}},[e._v("docker stack deploy")]),e._v(" ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/engine/swarm/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç¾¤ä½“æ¨¡å¼"),n("OutboundLink")],1),e._v(" å¯åŠ¨åº”ç”¨ç¨‹åº ï¼ˆè€Œä¸æ˜¯ "),n("a",{attrs:{href:"https://docs.docker.com/compose/reference/up/",target:"_blank",rel:"noopener noreferrer"}},[e._v("docker compose up"),n("OutboundLink")],1),e._v(" ï¼‰ï¼Œ "),n("em",[e._v("åˆ™ä¼šåˆ›å»º")]),e._v(" ä¸å­˜åœ¨çš„å¤–éƒ¨å· ã€‚ åœ¨ç¾¤æ¨¡å¼ä¸‹ï¼Œç”±æœåŠ¡å®šä¹‰å·åå°†è‡ªåŠ¨åˆ›å»ºè¯¥å·ã€‚ ç”±äºæœåŠ¡ä»»åŠ¡æ˜¯åœ¨æ–°èŠ‚ç‚¹ä¸Šå®‰æ’çš„ï¼Œå› æ­¤ "),n("a",{attrs:{href:"https://github.com/docker/swarmkit/blob/master/README.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("swarmkit"),n("OutboundLink")],1),e._v(" åœ¨æœ¬åœ°èŠ‚ç‚¹ä¸Šåˆ›å»ºå·ã€‚ è¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§ "),n("a",{attrs:{href:"https://github.com/moby/moby/issues/29976",target:"_blank",rel:"noopener noreferrer"}},[e._v("moby / mobyï¼ƒ29976"),n("OutboundLink")],1),e._v(" ã€‚"),n("a",{attrs:{href:"#deploy"}}),n("a",{attrs:{href:"https://docs.docker.com/engine/swarm/",target:"_blank",rel:"noopener noreferrer"}},[n("OutboundLink")],1),n("a",{attrs:{href:"https://docs.docker.com/compose/reference/up/",target:"_blank",rel:"noopener noreferrer"}},[n("OutboundLink")],1),n("a",{attrs:{href:"https://github.com/docker/swarmkit/blob/master/README.md",target:"_blank",rel:"noopener noreferrer"}},[n("OutboundLink")],1),n("a",{attrs:{href:"https://github.com/moby/moby/issues/29976",target:"_blank",rel:"noopener noreferrer"}},[n("OutboundLink")],1)])]),e._v(" "),n("h3",{attrs:{id:"æ ‡ç­¾-ğŸ”—-2"}},[e._v("æ ‡ç­¾ "),n("a",{attrs:{href:"#labels-3"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("ä½¿ç”¨ "),n("a",{attrs:{href:"https://docs.docker.com/config/labels-custom-metadata/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Dockeræ ‡ç­¾"),n("OutboundLink")],1),e._v(" å°†å…ƒæ•°æ®æ·»åŠ åˆ°å®¹å™¨ ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨æ•°ç»„æˆ–å­—å…¸ã€‚")]),e._v(" "),n("p",[e._v("å»ºè®®æ‚¨ä½¿ç”¨åå‘DNSè¡¨ç¤ºæ³•ï¼Œä»¥é˜²æ­¢æ ‡ç­¾ä¸å…¶ä»–è½¯ä»¶ä½¿ç”¨çš„æ ‡ç­¾å†²çªã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('labels:\n  com.example.description: "Database volume"\n  com.example.department: "IT/Ops"\n  com.example.label-with-empty-value: ""\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('labels:\n  - "com.example.description=Database volume"\n  - "com.example.department=IT/Ops"\n  - "com.example.label-with-empty-value"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("h3",{attrs:{id:"å‘½å-ğŸ”—"}},[e._v("å‘½å "),n("a",{attrs:{href:"#name"}},[e._v("ğŸ”—")])]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-34",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.4ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")])]),e._v(" "),n("p",[e._v("ä¸ºæ­¤å·è®¾ç½®ä¸€ä¸ªè‡ªå®šä¹‰åç§°ã€‚ åç§°å­—æ®µå¯ç”¨äºå¼•ç”¨åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„å·ã€‚ è¯¥åç§°æŒ‰åŸæ ·ä½¿ç”¨ï¼Œ "),n("strong",[e._v("ä¸ä¼š")]),e._v(" ä¸å †æ ˆåç§°ä¸€èµ·ä½œç”¨åŸŸã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nvolumes:\n  data:\n    name: my-app-data\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("p",[e._v("å®ƒä¹Ÿå¯ä»¥ä¸ "),n("code",[e._v("external")]),e._v(" å±æ€§ ä¸€èµ·ä½¿ç”¨ ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nvolumes:\n  data:\n    external: true\n    name: my-app-data\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("h2",{attrs:{id:"ç½‘ç»œé…ç½®å‚è€ƒ-ğŸ”—"}},[e._v("ç½‘ç»œé…ç½®å‚è€ƒ "),n("a",{attrs:{href:"#network-configuration-reference"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("é¡¶çº§ "),n("code",[e._v("networks")]),e._v(" å¯†é’¥å¯è®©æ‚¨æŒ‡å®šè¦åˆ›å»ºçš„ç½‘ç»œã€‚")]),e._v(" "),n("ul",[n("li",[e._v("æœ‰å…³Composeä½¿ç”¨Dockerç½‘ç»œåŠŸèƒ½å’Œæ‰€æœ‰ç½‘ç»œé©±åŠ¨ç¨‹åºé€‰é¡¹çš„å®Œæ•´è¯´æ˜ï¼Œè¯·å‚é˜…ã€Š "),n("a",{attrs:{href:"https://docs.docker.com/compose/networking/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç½‘ç»œæŒ‡å—ã€‹"),n("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),n("li",[e._v("æœ‰å…³ ç½‘ç»œçš„ "),n("a",{attrs:{href:"https://github.com/docker/labs/blob/master/README.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker Labs"),n("OutboundLink")],1),e._v(" æ•™ç¨‹ï¼Œè¯·ä» "),n("a",{attrs:{href:"https://github.com/docker/labs/blob/master/networking/README.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("è®¾è®¡å¯æ‰©å±•çš„ä¾¿æºå¼Dockerå®¹å™¨ç½‘ç»œå¼€å§‹"),n("OutboundLink")],1)])]),e._v(" "),n("h3",{attrs:{id:"å¸æœº-ğŸ”—-2"}},[e._v("å¸æœº "),n("a",{attrs:{href:"#driver-1"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æŒ‡å®šè¯¥ç½‘ç»œåº”ä½¿ç”¨å“ªä¸ªé©±åŠ¨ç¨‹åºã€‚")]),e._v(" "),n("p",[e._v("é»˜è®¤é©±åŠ¨ç¨‹åºå–å†³äºæ‚¨ä½¿ç”¨çš„Dockerå¼•æ“çš„é…ç½®æ–¹å¼ï¼Œä½†æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ƒ "),n("code",[e._v("bridge")]),e._v(" ä½äºå•ä¸ªä¸»æœºå’Œ "),n("code",[e._v("overlay")]),e._v(" Swarmä¸Šã€‚")]),e._v(" "),n("p",[e._v("å¦‚æœé©±åŠ¨ç¨‹åºä¸å¯ç”¨ï¼ŒDockerå¼•æ“å°†è¿”å›é”™è¯¯ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("driver: overlay\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("h4",{attrs:{id:"æ¡¥"}},[e._v("æ¡¥")]),e._v(" "),n("p",[e._v("Dockeré»˜è®¤ "),n("code",[e._v("bridge")]),e._v(" åœ¨å•ä¸ªä¸»æœºä¸Š ä½¿ç”¨ ç½‘ç»œã€‚ æœ‰å…³å¦‚ä½•ä½¿ç”¨ç½‘æ¡¥ç½‘ç»œçš„ç¤ºä¾‹ï¼Œè¯·å‚é˜…å…³äº "),n("a",{attrs:{href:"https://github.com/docker/labs/blob/master/networking/A2-bridge-networking.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç½‘æ¡¥ç½‘ç»œ"),n("OutboundLink")],1),e._v(" çš„Docker Labsæ•™ç¨‹ ã€‚")]),e._v(" "),n("h4",{attrs:{id:"è¦†ç›–"}},[e._v("è¦†ç›–")]),e._v(" "),n("p",[e._v("è¯¥ "),n("code",[e._v("overlay")]),e._v(" é©±åŠ¨ç¨‹åºåˆ›å»ºä¸€ä¸ªè·¨å¤šä¸ªèŠ‚ç‚¹å‘½åçš„ç½‘ç»œ "),n("a",{attrs:{href:"https://docs.docker.com/engine/swarm/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç¾¤"),n("OutboundLink")],1),e._v(" ã€‚")]),e._v(" "),n("ul",[n("li",[n("p",[e._v("æœ‰å…³å¦‚ä½•ä»¥ "),n("code",[e._v("overlay")]),e._v(" ç¾¤é›†æ¨¡å¼ æ„å»ºå’Œä½¿ç”¨ å¸¦æœ‰æœåŠ¡ çš„ ç½‘ç»œ çš„æœ‰æ•ˆç¤ºä¾‹ ï¼Œè¯·å‚é˜…ã€Š "),n("a",{attrs:{href:"https://github.com/docker/labs/blob/master/networking/A3-overlay-networking.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("è¦†ç›–ç½‘ç»œå’ŒæœåŠ¡å‘ç°ã€‹"),n("OutboundLink")],1),e._v(" çš„Docker Labsæ•™ç¨‹ ã€‚")])]),e._v(" "),n("li",[n("p",[e._v("æœ‰å…³æ·±å…¥äº†è§£å…¶å·¥ä½œåŸç†çš„ä¿¡æ¯ï¼Œè¯·å‚è§â€œ "),n("a",{attrs:{href:"https://github.com/docker/labs/blob/master/networking/concepts/06-overlay-networks.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("è¦†ç›–é©±åŠ¨ç¨‹åºç½‘ç»œä½“ç³»ç»“æ„â€"),n("OutboundLink")],1),e._v(" ä¸Šçš„ç½‘ç»œæ¦‚å¿µå®éªŒå®¤ ã€‚")])])]),e._v(" "),n("h4",{attrs:{id:"ä¸»æœºæˆ–æ— "}},[e._v("ä¸»æœºæˆ–æ— ")]),e._v(" "),n("p",[e._v("ä½¿ç”¨ä¸»æœºçš„ç½‘ç»œå †æ ˆï¼Œæˆ–è€…ä¸ä½¿ç”¨ç½‘ç»œã€‚ ç­‰åŒäº "),n("code",[e._v("docker run --net=host")]),e._v(" æˆ– "),n("code",[e._v("docker run --net=none")]),e._v(" ã€‚ ä»…åœ¨ä½¿ç”¨ "),n("code",[e._v("docker stack")]),e._v(" å‘½ä»¤æ—¶ ä½¿ç”¨ ã€‚ å¦‚æœä½¿ç”¨ "),n("code",[e._v("docker-compose")]),e._v(" å‘½ä»¤ï¼Œè¯·æ”¹ç”¨ "),n("a",{attrs:{href:"#network_mode"}},[e._v("network_mode")]),e._v(" ã€‚")]),e._v(" "),n("p",[e._v("å¦‚æœè¦åœ¨é€šç”¨ç‰ˆæœ¬ä¸Šä½¿ç”¨ç‰¹å®šç½‘ç»œï¼Œè¯·ä½¿ç”¨ç¬¬äºŒä¸ªyamlæ–‡ä»¶ç¤ºä¾‹ä¸­æåˆ°çš„[network]ã€‚")]),e._v(" "),n("p",[e._v("ä½¿ç”¨å†…ç½®ç½‘ç»œï¼ˆä¾‹å¦‚ "),n("code",[e._v("host")]),e._v(" å’Œ "),n("code",[e._v("none")]),e._v(" ï¼‰ çš„è¯­æ³• ç•¥æœ‰ä¸åŒã€‚ ä½¿ç”¨åç§° "),n("code",[e._v("host")]),e._v(" æˆ– "),n("code",[e._v("none")]),e._v(" ï¼ˆDockerå·²ç»è‡ªåŠ¨åˆ›å»ºçš„ï¼‰ å®šä¹‰ä¸€ä¸ªå¤–éƒ¨ç½‘ç»œï¼Œå¹¶å®šä¹‰ä¸€ä¸ª Composeå¯ä»¥ä½¿ç”¨çš„åˆ«åï¼ˆ "),n("code",[e._v("hostnet")]),e._v(" æˆ– "),n("code",[e._v("nonet")]),e._v(" åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼‰ï¼Œç„¶åä½¿ç”¨è¯¥åˆ«åå‘è¯¥ç½‘ç»œæˆäºˆæœåŠ¡è®¿é—®æƒé™ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nservices:\n  web:\n    networks:\n      hostnet: {}\n\nnetworks:\n  hostnet:\n    external: true\n    name: host\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("services:\n  web:\n    ...\n    build:\n      ...\n      network: host\n      context: .\n      ...\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("services:\n  web:\n    ...\n    networks:\n      nonet: {}\n\nnetworks:\n  nonet:\n    external: true\n    name: none\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br")])]),n("h3",{attrs:{id:"driver-opts-ğŸ”—-2"}},[e._v("driver_opts "),n("a",{attrs:{href:"#driver_opts-1"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æŒ‡å®šé€‰é¡¹åˆ—è¡¨ä½œä¸ºé”®å€¼å¯¹ï¼Œä»¥ä¼ é€’ç»™è¯¥ç½‘ç»œçš„é©±åŠ¨ç¨‹åºã€‚ è¿™äº›é€‰é¡¹å–å†³äºé©±åŠ¨ç¨‹åº-æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒé©±åŠ¨ç¨‹åºçš„æ–‡æ¡£ã€‚ å¯é€‰çš„ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('driver_opts:\n  foo: "bar"\n  baz: 1\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("h3",{attrs:{id:"é™„-ğŸ”—"}},[e._v("é™„ "),n("a",{attrs:{href:"#attachable"}},[e._v("ğŸ”—")])]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-32",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.2ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")])]),e._v(" "),n("p",[e._v("ä»…åœ¨å°† "),n("code",[e._v("driver")]),e._v(" è®¾ç½® ä¸ºæ—¶ä½¿ç”¨ "),n("code",[e._v("overlay")]),e._v(" ã€‚ å¦‚æœè®¾ç½®ä¸º "),n("code",[e._v("true")]),e._v(" ï¼Œåˆ™é™¤äº†æœåŠ¡ä¹‹å¤–ï¼Œç‹¬ç«‹å®¹å™¨è¿˜å¯ä»¥è¿æ¥åˆ°è¯¥ç½‘ç»œã€‚ å¦‚æœç‹¬ç«‹å®¹å™¨è¿æ¥åˆ°è¦†ç›–ç½‘ç»œï¼Œåˆ™å®ƒå¯ä»¥ä¸ä¹Ÿä»å…¶ä»–Dockerå®ˆæŠ¤ç¨‹åºé™„åŠ åˆ°è¦†ç›–ç½‘ç»œçš„æœåŠ¡å’Œç‹¬ç«‹å®¹å™¨è¿›è¡Œé€šä¿¡ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("networks:\n  mynet1:\n    driver: overlay\n    attachable: true\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("h3",{attrs:{id:"enable-ipv6-ğŸ”—"}},[e._v("enable_ipv6 "),n("a",{attrs:{href:"#enable_ipv6"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("åœ¨æ­¤ç½‘ç»œä¸Šå¯ç”¨IPv6ç½‘ç»œã€‚")]),e._v(" "),n("blockquote",[n("p",[e._v("æ’°å†™æ–‡ä»¶ç‰ˆæœ¬3ä¸æ”¯æŒ")]),e._v(" "),n("p",[n("code",[e._v("enable_ipv6")]),e._v(" è¦æ±‚æ‚¨ä½¿ç”¨ç‰ˆæœ¬2çš„Composeæ–‡ä»¶ï¼Œå› ä¸ºSwarmæ¨¡å¼å°šä¸æ”¯æŒæ­¤æŒ‡ä»¤ã€‚")])]),e._v(" "),n("h3",{attrs:{id:"ä¼Šå¸•å§†-ğŸ”—"}},[e._v("ä¼Šå¸•å§† "),n("a",{attrs:{href:"#ipam"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æŒ‡å®šè‡ªå®šä¹‰IPAMé…ç½®ã€‚ è¿™æ˜¯ä¸€ä¸ªå…·æœ‰å¤šä¸ªå±æ€§çš„å¯¹è±¡ï¼Œæ¯ä¸ªå±æ€§éƒ½æ˜¯å¯é€‰çš„ï¼š")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("driver")]),e._v(" ï¼šè‡ªå®šä¹‰IPAMé©±åŠ¨ç¨‹åºï¼Œè€Œä¸æ˜¯é»˜è®¤é©±åŠ¨ç¨‹åºã€‚")]),e._v(" "),n("li",[n("code",[e._v("config")]),e._v(" ï¼šå…·æœ‰é›¶ä¸ªæˆ–å¤šä¸ªé…ç½®å—çš„åˆ—è¡¨ï¼Œæ¯ä¸ªé…ç½®å—åŒ…å«ä»¥ä¸‹ä»»ä¸€é”®ï¼š\n"),n("ul",[n("li",[n("code",[e._v("subnet")]),e._v(" ï¼šCIDRæ ¼å¼çš„å­ç½‘è¡¨ç¤ºä¸€ä¸ªç½‘æ®µ")])])])]),e._v(" "),n("p",[e._v("ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("ipam:\n  driver: default\n  config:\n    - subnet: 172.28.0.0/16\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("blockquote",[n("p",[n("strong",[e._v("æ³¨æ„")])]),e._v(" "),n("p",[n("code",[e._v("gateway")]),e._v(" ç›®å‰ä»…æ”¯æŒç‰ˆæœ¬2 ç­‰å…¶ä»–IPAMé…ç½® ã€‚")])]),e._v(" "),n("h3",{attrs:{id:"å†…éƒ¨-ğŸ”—"}},[e._v("å†…éƒ¨ "),n("a",{attrs:{href:"#internal"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("é»˜è®¤æƒ…å†µä¸‹ï¼ŒDockerè¿˜å°†æ¡¥æ¥ç½‘ç»œè¿æ¥åˆ°å®ƒä»¥æä¾›å¤–éƒ¨è¿æ¥ã€‚ å¦‚æœè¦åˆ›å»ºå¤–éƒ¨éš”ç¦»çš„è¦†ç›–ç½‘ç»œï¼Œå¯ä»¥å°†æ­¤é€‰é¡¹è®¾ç½®ä¸º "),n("code",[e._v("true")]),e._v(" ã€‚")]),e._v(" "),n("h3",{attrs:{id:"æ ‡ç­¾-ğŸ”—-3"}},[e._v("æ ‡ç­¾ "),n("a",{attrs:{href:"#labels-4"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("ä½¿ç”¨ "),n("a",{attrs:{href:"https://docs.docker.com/config/labels-custom-metadata/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Dockeræ ‡ç­¾"),n("OutboundLink")],1),e._v(" å°†å…ƒæ•°æ®æ·»åŠ åˆ°å®¹å™¨ ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨æ•°ç»„æˆ–å­—å…¸ã€‚")]),e._v(" "),n("p",[e._v("å»ºè®®æ‚¨ä½¿ç”¨åå‘DNSè¡¨ç¤ºæ³•ï¼Œä»¥é˜²æ­¢æ ‡ç­¾ä¸å…¶ä»–è½¯ä»¶ä½¿ç”¨çš„æ ‡ç­¾å†²çªã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('labels:\n  com.example.description: "Financial transaction network"\n  com.example.department: "Finance"\n  com.example.label-with-empty-value: ""\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('labels:\n  - "com.example.description=Financial transaction network"\n  - "com.example.department=Finance"\n  - "com.example.label-with-empty-value"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("h3",{attrs:{id:"å¤–éƒ¨-ğŸ”—-2"}},[e._v("å¤–éƒ¨ "),n("a",{attrs:{href:"#external-1"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("å¦‚æœè®¾ç½®ä¸º "),n("code",[e._v("true")]),e._v(" ï¼Œåˆ™æŒ‡å®šæ­¤ç½‘ç»œæ˜¯åœ¨Composeä¹‹å¤–åˆ›å»ºçš„ã€‚ "),n("code",[e._v("docker-compose up")]),e._v(" ä¸ä¼šå°è¯•åˆ›å»ºå®ƒï¼Œå¦‚æœä¸å­˜åœ¨åˆ™å¼•å‘é”™è¯¯ã€‚")]),e._v(" "),n("p",[e._v("ä¸º3.3å’Œä¸‹é¢çš„æ ¼å¼çš„ç‰ˆæœ¬ï¼Œ "),n("code",[e._v("external")]),e._v(" ä¸èƒ½åŒæ—¶ä½¿ç”¨ä¸å…¶ä»–ç½‘ç»œé…ç½®é”®ï¼ˆ "),n("code",[e._v("driver")]),e._v(" ï¼Œ "),n("code",[e._v("driver_opts")]),e._v(" ï¼Œ "),n("code",[e._v("ipam")]),e._v(" ï¼Œ "),n("code",[e._v("internal")]),e._v(" ï¼‰ã€‚ å¯¹äº "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-34",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.4"),n("OutboundLink")],1),e._v(" åŠæ›´é«˜ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-34",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç‰ˆæœ¬ï¼Œ"),n("OutboundLink")],1),e._v(" æ­¤é™åˆ¶ä¸å†å­˜åœ¨ ã€‚")]),e._v(" "),n("p",[e._v("åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œ "),n("code",[e._v("proxy")]),e._v(" æ˜¯é€šå¾€å¤–ç•Œçš„é—¨æˆ·ã€‚ "),n("code",[e._v("[projectname]_outside")]),e._v(" Compose ä¸ä¼šå°è¯•åˆ›å»ºä¸€ä¸ªåä¸ºçš„ç½‘ç»œ ï¼Œ è€Œæ˜¯ å¯»æ‰¾ä¸€ä¸ªç®€å•ç§°ä¸ºçš„ç°æœ‰ç½‘ç»œ "),n("code",[e._v("outside")]),e._v(" ï¼Œå¹¶å°† "),n("code",[e._v("proxy")]),e._v(" æœåŠ¡çš„å®¹å™¨ è¿æ¥ åˆ°è¯¥ç½‘ç»œã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\n\nservices:\n  proxy:\n    build: ./proxy\n    networks:\n      - outside\n      - default\n  app:\n    build: ./app\n    networks:\n      - default\n\nnetworks:\n  outside:\n    external: true\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br")])]),n("blockquote",[n("p",[e._v("ä¸å»ºè®®ä½¿ç”¨ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-35",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.5ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ã€‚")]),e._v(" "),n("p",[e._v("ä½¿ç”¨ç‰ˆæœ¬3.5æ–‡ä»¶æ ¼å¼å¼ƒç”¨äº†external.name "),n("code",[e._v("name")]),e._v(" ã€‚")])]),e._v(" "),n("p",[e._v("æ‚¨è¿˜å¯ä»¥åœ¨Composeæ–‡ä»¶ä¸­æŒ‡å®šç½‘ç»œåç§°ï¼Œè€Œä¸æ˜¯ç”¨æ¥å¼•ç”¨ç½‘ç»œçš„åç§°ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nnetworks:\n  outside:\n    external:\n      name: actual-name-of-network\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("h3",{attrs:{id:"å‘½å-ğŸ”—-2"}},[e._v("å‘½å "),n("a",{attrs:{href:"#name-1"}},[e._v("ğŸ”—")])]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-35",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç‰ˆæœ¬3.5"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")])]),e._v(" "),n("p",[e._v("ä¸ºæ­¤ç½‘ç»œè®¾ç½®ä¸€ä¸ªè‡ªå®šä¹‰åç§°ã€‚ åç§°å­—æ®µå¯ç”¨äºå¼•ç”¨åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„ç½‘ç»œã€‚ è¯¥åç§°æŒ‰åŸæ ·ä½¿ç”¨ï¼Œ "),n("strong",[e._v("ä¸ä¼š")]),e._v(" ä¸å †æ ˆåç§°ä¸€èµ·ä½œç”¨åŸŸã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nnetworks:\n  network1:\n    name: my-app-net\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("p",[e._v("å®ƒä¹Ÿå¯ä»¥ä¸ "),n("code",[e._v("external")]),e._v(" å±æ€§ ä¸€èµ·ä½¿ç”¨ ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: "3.8"\nnetworks:\n  network1:\n    external: true\n    name: my-app-net\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("h2",{attrs:{id:"configsé…ç½®å‚è€ƒ-ğŸ”—"}},[e._v("configsé…ç½®å‚è€ƒ "),n("a",{attrs:{href:"#configs-configuration-reference"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("é¡¶çº§ "),n("code",[e._v("configs")]),e._v(" å£°æ˜å®šä¹‰æˆ–å¼•ç”¨ å¯ä»¥æˆäºˆæ­¤å †æ ˆä¸­çš„æœåŠ¡çš„ "),n("a",{attrs:{href:"https://docs.docker.com/engine/swarm/configs/",target:"_blank",rel:"noopener noreferrer"}},[e._v("é…ç½®"),n("OutboundLink")],1),e._v(" ã€‚ é…ç½®çš„æ¥æºæ˜¯ "),n("code",[e._v("file")]),e._v(" æˆ– "),n("code",[e._v("external")]),e._v(" ã€‚")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("file")]),e._v(" ï¼šä½¿ç”¨æŒ‡å®šè·¯å¾„ä¸­çš„æ–‡ä»¶å†…å®¹åˆ›å»ºé…ç½®ã€‚")]),e._v(" "),n("li",[n("code",[e._v("external")]),e._v(" ï¼šå¦‚æœè®¾ç½®ä¸ºtrueï¼Œåˆ™æŒ‡å®šæ­¤é…ç½®å·²åˆ›å»ºã€‚ Dockerä¸ä¼šå°è¯•åˆ›å»ºå®ƒï¼Œå¦‚æœå®ƒä¸å­˜åœ¨ï¼Œ "),n("code",[e._v("config not found")]),e._v(" åˆ™ä¼šå‘ç”Ÿé”™è¯¯ã€‚")]),e._v(" "),n("li",[n("code",[e._v("name")]),e._v(" ï¼šDockerä¸­é…ç½®å¯¹è±¡çš„åç§°ã€‚ æ­¤å­—æ®µå¯ç”¨äºå¼•ç”¨åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„é…ç½®ã€‚ è¯¥åç§°æŒ‰åŸæ ·ä½¿ç”¨ï¼Œ "),n("strong",[e._v("ä¸ä¼š")]),e._v(" ä¸å †æ ˆåç§°ä¸€èµ·ä½œç”¨åŸŸã€‚ ä»¥3.5ç‰ˆæ–‡ä»¶æ ¼å¼å¼•å…¥ã€‚")]),e._v(" "),n("li",[n("code",[e._v("driver")]),e._v(" å’Œ "),n("code",[e._v("driver_opts")]),e._v(" ï¼šè‡ªå®šä¹‰ç§˜å¯†é©±åŠ¨ç¨‹åºçš„åç§°ï¼Œä»¥åŠä½œä¸ºé”®/å€¼å¯¹ä¼ é€’çš„ç‰¹å®šäºé©±åŠ¨ç¨‹åºçš„é€‰é¡¹ã€‚ ä»¥3.8ç‰ˆæ–‡ä»¶æ ¼å¼å¼•å…¥ï¼Œä»…åœ¨ä½¿ç”¨æ—¶å—æ”¯æŒ "),n("code",[e._v("docker stack")]),e._v(" ã€‚")]),e._v(" "),n("li",[n("code",[e._v("template_driver")]),e._v(" ï¼šè¦ä½¿ç”¨çš„æ¨¡æ¿é©±åŠ¨ç¨‹åºçš„åç§°ï¼Œå®ƒæ§åˆ¶æ˜¯å¦ä»¥åŠå¦‚ä½•å°†ç§˜å¯†æœ‰æ•ˆè´Ÿè½½è¯„ä¼°ä¸ºæ¨¡æ¿ã€‚ å¦‚æœæœªè®¾ç½®é©±åŠ¨ç¨‹åºï¼Œåˆ™ä¸ä½¿ç”¨ä»»ä½•æ¨¡æ¿ã€‚ å½“å‰æ”¯æŒçš„å”¯ä¸€é©±åŠ¨ç¨‹åºæ˜¯ "),n("code",[e._v("golang")]),e._v(" ï¼Œå®ƒä½¿ç”¨ "),n("code",[e._v("golang")]),e._v(" ã€‚ ä»¥3.8ç‰ˆæ–‡ä»¶æ ¼å¼å¼•å…¥ï¼Œä»…åœ¨ä½¿ç”¨æ—¶å—æ”¯æŒ "),n("code",[e._v("docker stack")]),e._v(" ã€‚ æœ‰å…³ "),n("a",{attrs:{href:"https://docs.docker.com/engine/swarm/configs/#example-use-a-templated-config",target:"_blank",rel:"noopener noreferrer"}},[e._v("æ¨¡æ¿åŒ–é…ç½®"),n("OutboundLink")],1),e._v(" çš„ç¤ºä¾‹ï¼Œ è¯·å‚é˜… "),n("a",{attrs:{href:"https://docs.docker.com/engine/swarm/configs/#example-use-a-templated-config",target:"_blank",rel:"noopener noreferrer"}},[e._v("ä½¿ç”¨"),n("OutboundLink")],1),e._v(" æ¨¡æ¿åŒ–é…ç½®ã€‚")])]),e._v(" "),n("p",[e._v("åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œ "),n("code",[e._v("my_first_config")]),e._v(" åˆ›å»ºäº†ï¼ˆå°±åƒ "),n("code",[e._v("<stack_name>_my_first_config)")]),e._v(" éƒ¨ç½²å †æ ˆæ—¶ä¸€æ ·ï¼Œå¹¶ä¸” "),n("code",[e._v("my_second_config")]),e._v(" å·²ç»å­˜åœ¨äºDockerä¸­ã€‚ï¼‰")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("configs:\n  my_first_config:\n    file: ./config_data\n  my_second_config:\n    external: true\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("p",[e._v("å¤–éƒ¨é…ç½®çš„å¦ä¸€ä¸ªå˜ä½“æ˜¯Dockerä¸­çš„é…ç½®åç§°ä¸æœåŠ¡ä¸­å­˜åœ¨çš„åç§°ä¸åŒæ—¶ã€‚ ä»¥ä¸‹ç¤ºä¾‹ä¿®æ”¹äº†å‰ä¸€ä¸ªç¤ºä¾‹ï¼Œä»¥ä½¿ç”¨åä¸ºçš„å¤–éƒ¨é…ç½® "),n("code",[e._v("redis_config")]),e._v(" ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("configs:\n  my_first_config:\n    file: ./config_data\n  my_second_config:\n    external:\n      name: redis_config\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br")])]),n("p",[e._v("æ‚¨ä»ç„¶éœ€è¦ "),n("a",{attrs:{href:"#configs"}},[e._v("å°†é…ç½®è®¿é—®æƒé™æˆäºˆ")]),e._v(" å †æ ˆä¸­çš„æ¯ä¸ªæœåŠ¡ã€‚")]),e._v(" "),n("h2",{attrs:{id:"æœºå¯†é…ç½®å‚è€ƒ-ğŸ”—"}},[e._v("æœºå¯†é…ç½®å‚è€ƒ "),n("a",{attrs:{href:"#secrets-configuration-reference"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("é¡¶çº§ "),n("code",[e._v("secrets")]),e._v(" å£°æ˜å®šä¹‰æˆ–å¼•ç”¨ å¯ä»¥æˆäºˆæ­¤å †æ ˆä¸­çš„æœåŠ¡çš„ "),n("a",{attrs:{href:"https://docs.docker.com/engine/swarm/secrets/",target:"_blank",rel:"noopener noreferrer"}},[e._v("æœºå¯†"),n("OutboundLink")],1),e._v(" ã€‚ ç§˜å¯†çš„æ¥æºæ˜¯ "),n("code",[e._v("file")]),e._v(" æˆ– "),n("code",[e._v("external")]),e._v(" ã€‚")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("file")]),e._v(" ï¼šç§˜å¯†æ˜¯ä½¿ç”¨æŒ‡å®šè·¯å¾„ä¸­çš„æ–‡ä»¶å†…å®¹åˆ›å»ºçš„ã€‚")]),e._v(" "),n("li",[n("code",[e._v("external")]),e._v(" ï¼šå¦‚æœè®¾ç½®ä¸ºtrueï¼Œåˆ™æŒ‡å®šæ­¤ç§˜å¯†å·²ç»åˆ›å»ºã€‚ Dockerä¸ä¼šå°è¯•åˆ›å»ºå®ƒï¼Œå¦‚æœå®ƒä¸å­˜åœ¨ï¼Œ "),n("code",[e._v("secret not found")]),e._v(" åˆ™ä¼šå‘ç”Ÿé”™è¯¯ã€‚")]),e._v(" "),n("li",[n("code",[e._v("name")]),e._v(" ï¼šDockerä¸­ç§˜å¯†å¯¹è±¡çš„åç§°ã€‚ æ­¤å­—æ®µå¯ç”¨äºå¼•ç”¨åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„æœºå¯†ã€‚ è¯¥åç§°æŒ‰åŸæ ·ä½¿ç”¨ï¼Œ "),n("strong",[e._v("ä¸ä¼š")]),e._v(" ä¸å †æ ˆåç§°ä¸€èµ·ä½œç”¨åŸŸã€‚ ä»¥3.5ç‰ˆæ–‡ä»¶æ ¼å¼å¼•å…¥ã€‚")]),e._v(" "),n("li",[n("code",[e._v("template_driver")]),e._v(" ï¼šè¦ä½¿ç”¨çš„æ¨¡æ¿é©±åŠ¨ç¨‹åºçš„åç§°ï¼Œå®ƒæ§åˆ¶æ˜¯å¦ä»¥åŠå¦‚ä½•å°†ç§˜å¯†æœ‰æ•ˆè´Ÿè½½è¯„ä¼°ä¸ºæ¨¡æ¿ã€‚ å¦‚æœæœªè®¾ç½®é©±åŠ¨ç¨‹åºï¼Œåˆ™ä¸ä½¿ç”¨ä»»ä½•æ¨¡æ¿ã€‚ å½“å‰æ”¯æŒçš„å”¯ä¸€é©±åŠ¨ç¨‹åºæ˜¯ "),n("code",[e._v("golang")]),e._v(" ï¼Œå®ƒä½¿ç”¨ "),n("code",[e._v("golang")]),e._v(" ã€‚ ä»¥3.8ç‰ˆæ–‡ä»¶æ ¼å¼å¼•å…¥ï¼Œä»…åœ¨ä½¿ç”¨æ—¶å—æ”¯æŒ "),n("code",[e._v("docker stack")]),e._v(" ã€‚")])]),e._v(" "),n("p",[e._v("åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œ "),n("code",[e._v("my_first_secret")]),e._v(" åˆ›å»º "),n("code",[e._v("<stack_name>_my_first_secret")]),e._v(" æ—¶æ˜¯åœ¨éƒ¨ç½²å †æ ˆæ—¶ åˆ›å»ºçš„ ï¼Œå¹¶ä¸” "),n("code",[e._v("my_second_secret")]),e._v(" å·²ç»å­˜åœ¨äºDockerä¸­ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("secrets:\n  my_first_secret:\n    file: ./secret_data\n  my_second_secret:\n    external: true\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("p",[e._v("å¤–éƒ¨æœºå¯†çš„å¦ä¸€ä¸ªå˜ä½“æ˜¯Dockerä¸­çš„æœºå¯†åç§°ä¸æœåŠ¡ä¸­å­˜åœ¨çš„åç§°ä¸åŒæ—¶ã€‚ ä»¥ä¸‹ç¤ºä¾‹ä¿®æ”¹äº†å‰ä¸€ä¸ªç¤ºä¾‹ï¼Œä»¥ä½¿ç”¨åä¸ºçš„å¤–éƒ¨æœºå¯† "),n("code",[e._v("redis_secret")]),e._v(" ã€‚")]),e._v(" "),n("h3",{attrs:{id:"æ’°å†™æ–‡ä»¶v3-5åŠæ›´é«˜ç‰ˆæœ¬-ğŸ”—"}},[e._v("æ’°å†™æ–‡ä»¶v3.5åŠæ›´é«˜ç‰ˆæœ¬ "),n("a",{attrs:{href:"#compose-file-v35-and-above"}},[e._v("ğŸ”—")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("secrets:\n  my_first_secret:\n    file: ./secret_data\n  my_second_secret:\n    external: true\n    name: redis_secret\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br")])]),n("h3",{attrs:{id:"æ’°å†™æ–‡ä»¶v3-4å’Œ-ğŸ”—ä¸‹"}},[e._v("æ’°å†™æ–‡ä»¶v3.4å’Œ "),n("a",{attrs:{href:"#compose-file-v34-and-under"}},[e._v("ğŸ”—ä¸‹")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("  my_second_secret:\n    external:\n      name: redis_secret\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("p",[e._v("æ‚¨ä»ç„¶éœ€è¦å‘ å †æ ˆä¸­çš„æ¯ä¸ªæœåŠ¡ "),n("a",{attrs:{href:"#secrets"}},[e._v("æˆäºˆå¯¹æœºå¯†çš„è®¿é—®æƒé™")]),e._v(" ã€‚")]),e._v(" "),n("h2",{attrs:{id:"å˜é‡æ›¿ä»£-ğŸ”—"}},[e._v("å˜é‡æ›¿ä»£ "),n("a",{attrs:{href:"#variable-substitution"}},[e._v("ğŸ”—")])]),e._v(" "),n("p",[e._v("æ‚¨çš„é…ç½®é€‰é¡¹å¯ä»¥åŒ…å«ç¯å¢ƒå˜é‡ã€‚ Composeä½¿ç”¨ "),n("code",[e._v("docker-compose")]),e._v(" è¿è¡Œæ—¶æ‰€åœ¨ çš„Shellç¯å¢ƒä¸­çš„å˜é‡å€¼ ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾å¤–å£³åŒ…å« "),n("code",[e._v("POSTGRES_VERSION=9.3")]),e._v(" å¹¶æä¾›ä»¥ä¸‹é…ç½®ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('db:\n  image: "postgres:${POSTGRES_VERSION}"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("p",[e._v("å½“æ‚¨è¿è¡Œ "),n("code",[e._v("docker-compose up")]),e._v(" æ­¤é…ç½®ï¼Œæ’°å†™å¤–è§‚ä¸º "),n("code",[e._v("POSTGRES_VERSION")]),e._v(" åœ¨å¤–å£³å’Œæ›¿ä»£å®ƒçš„ä»·å€¼çš„ç¯å¢ƒå˜é‡ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ’°å†™è§£æ "),n("code",[e._v("image")]),e._v(" åˆ° "),n("code",[e._v("postgres:9.3")]),e._v(" è¿è¡Œé…ç½®ä¹‹å‰ã€‚")]),e._v(" "),n("p",[e._v("å¦‚æœæœªè®¾ç½®ç¯å¢ƒå˜é‡ï¼Œåˆ™Composeæ›¿æ¢ä¸ºç©ºå­—ç¬¦ä¸²ã€‚ åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå¦‚æœ "),n("code",[e._v("POSTGRES_VERSION")]),e._v(" æœªè®¾ç½®ï¼Œåˆ™ "),n("code",[e._v("image")]),e._v(" é€‰é¡¹çš„å€¼ä¸º "),n("code",[e._v("postgres:")]),e._v(" ã€‚")]),e._v(" "),n("p",[e._v("æ‚¨å¯ä»¥ä½¿ç”¨ Composeè‡ªåŠ¨æŸ¥æ‰¾ çš„ "),n("a",{attrs:{href:"https://docs.docker.com/compose/env-file/",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v(".env")]),e._v("æ–‡ä»¶"),n("OutboundLink")],1),e._v(" ä¸ºç¯å¢ƒå˜é‡è®¾ç½®é»˜è®¤å€¼ ã€‚ åœ¨shellç¯å¢ƒä¸­è®¾ç½®çš„å€¼å°†è¦†ç›– "),n("code",[e._v(".env")]),e._v(" æ–‡ä»¶ä¸­ è®¾ç½®çš„å€¼ ã€‚")]),e._v(" "),n("blockquote",[n("p",[e._v("ä½¿ç”¨docker stack deployæ—¶çš„æ³¨æ„äº‹é¡¹")]),e._v(" "),n("p",[e._v("è¯¥ "),n("code",[e._v(".env file")]),e._v(" åŠŸèƒ½ä»…åœ¨ä½¿ç”¨ "),n("code",[e._v("docker-compose up")]),e._v(" å‘½ä»¤æ—¶æœ‰æ•ˆï¼Œè€Œä¸é€‚ç”¨äº "),n("code",[e._v("docker stack deploy")]),e._v(" ã€‚")])]),e._v(" "),n("p",[e._v("è¿™ä¸¤ä¸ª "),n("code",[e._v("$VARIABLE")]),e._v(" å’Œ "),n("code",[e._v("${VARIABLE}")]),e._v(" è¯­æ³•çš„æ”¯æŒã€‚ æ­¤å¤–ï¼Œå½“ä½¿ç”¨ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-21",target:"_blank",rel:"noopener noreferrer"}},[e._v("2.1æ–‡ä»¶æ ¼å¼æ—¶"),n("OutboundLink")],1),e._v(" ï¼Œå¯ä»¥ä½¿ç”¨å…¸å‹çš„shellè¯­æ³•æä¾›å†…è”é»˜è®¤å€¼ï¼š")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("${VARIABLE:-default}")]),e._v(" è®¡ç®—ç¯å¢ƒä¸­ "),n("code",[e._v("default")]),e._v(" æ˜¯å¦ "),n("code",[e._v("VARIABLE")]),e._v(" æœªè®¾ç½®æˆ–ä¸ºç©ºã€‚")]),e._v(" "),n("li",[n("code",[e._v("${VARIABLE-default}")]),e._v(" "),n("code",[e._v("default")]),e._v(" ä»… "),n("code",[e._v("VARIABLE")]),e._v(" åœ¨ç¯å¢ƒä¸­æœªè®¾ç½®æ—¶ è¯„ä¼°ä¸º ã€‚")])]),e._v(" "),n("p",[e._v("åŒæ ·ï¼Œä»¥ä¸‹è¯­æ³•å…è®¸æ‚¨æŒ‡å®šå¿…éœ€å˜é‡ï¼š")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("${VARIABLE:?err}")]),e._v(" é€€å‡ºï¼Œå¹¶æ˜¾ç¤ºä¸€æ¡é”™è¯¯æ¶ˆæ¯ï¼Œå…¶ä¸­åŒ…å« åœ¨ç¯å¢ƒ ä¸­ "),n("code",[e._v("err")]),e._v(" æ˜¯å¦ "),n("code",[e._v("VARIABLE")]),e._v(" è®¾ç½®ä¸º if æˆ–ä¸ºç©ºã€‚")]),e._v(" "),n("li",[n("code",[e._v("${VARIABLE?err}")]),e._v(" é€€å‡ºï¼Œå¹¶æ˜¾ç¤ºä¸€æ¡é”™è¯¯æ¶ˆæ¯ï¼Œå…¶ä¸­åŒ…å« åœ¨ç¯å¢ƒä¸­æœªè®¾ç½®çš„ "),n("code",[e._v("err")]),e._v(" if "),n("code",[e._v("VARIABLE")]),e._v(" ã€‚")])]),e._v(" "),n("p",[n("code",[e._v("${VARIABLE/foo/bar}")]),e._v(" ä¸æ”¯æŒ å…¶ä»–æ‰©å±•çš„Shellæ ·å¼åŠŸèƒ½ï¼Œä¾‹å¦‚ ã€‚")]),e._v(" "),n("p",[n("code",[e._v("$$")]),e._v(" å½“æ‚¨çš„é…ç½®éœ€è¦æ–‡å­—ç¾å…ƒç¬¦å·æ—¶ï¼Œ å¯ä»¥ä½¿ç”¨ ï¼ˆåŒç¾å…ƒç¬¦å·ï¼‰ã€‚ è¿™ä¹Ÿå¯ä»¥é˜²æ­¢Composeæ’å€¼ï¼Œå› æ­¤a "),n("code",[e._v("$$")]),e._v(" å…è®¸æ‚¨å¼•ç”¨æ‚¨ä¸æƒ³ç”±Composeå¤„ç†çš„ç¯å¢ƒå˜é‡ã€‚")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('web:\n  build: .\n  command: "$$VAR_NOT_INTERPOLATED_BY_COMPOSE"\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("p",[e._v("å¦‚æœå¿˜è®°å¹¶ä½¿ç”¨å•ä¸ªç¾å…ƒç¬¦å·ï¼ˆ "),n("code",[e._v("$")]),e._v(" ï¼‰ï¼Œåˆ™Composeä¼šå°†å€¼è§£é‡Šä¸ºç¯å¢ƒå˜é‡ï¼Œå¹¶è­¦å‘Šæ‚¨ï¼š")]),e._v(" "),n("p",[e._v("æœªè®¾ç½®VAR_NOT_INTERPOLATED_BY_COMPOSEã€‚ æ›¿æ¢ä¸ºç©ºå­—ç¬¦ä¸²ã€‚")]),e._v(" "),n("h2",{attrs:{id:"æ‰©å±•å­—æ®µ-ğŸ”—"}},[e._v("æ‰©å±•å­—æ®µ "),n("a",{attrs:{href:"#extension-fields"}},[e._v("ğŸ”—")])]),e._v(" "),n("blockquote",[n("p",[e._v("ä»¥ "),n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/#version-34",target:"_blank",rel:"noopener noreferrer"}},[e._v("3.4ç‰ˆ"),n("OutboundLink")],1),e._v(" æ–‡ä»¶æ ¼å¼ æ·»åŠ  ã€‚")])]),e._v(" "),n("p",[e._v("å¯ä»¥ä½¿ç”¨æ‰©å±•å­—æ®µé‡æ–°ä½¿ç”¨é…ç½®ç‰‡æ®µã€‚ è¿™äº›ç‰¹æ®Šå­—æ®µå¯ä»¥ä½äºä»»æ„æ ¼å¼ï¼Œåªè¦å®ƒä»¬ä½äºComposeæ–‡ä»¶çš„æ ¹ç›®å½•ä¸­å¹¶ä¸”å…¶åç§°ä»¥ "),n("code",[e._v("x-")]),e._v(" å­—ç¬¦åºåˆ— å¼€å¤´å³å¯ ã€‚")]),e._v(" "),n("blockquote",[n("p",[n("strong",[e._v("æ³¨æ„")])]),e._v(" "),n("p",[e._v("ä»3.7æ ¼å¼ï¼ˆå¯¹äº3.xç³»åˆ—ï¼‰å’Œ2.4æ ¼å¼ï¼ˆå¯¹äº2.xç³»åˆ—ï¼‰å¼€å§‹ï¼Œæ‰©å±•å­—æ®µä¹Ÿå¯ä»¥åœ¨æœåŠ¡ï¼Œå·ï¼Œç½‘ç»œï¼Œé…ç½®å’Œå¯†ç å®šä¹‰çš„æ ¹ç›®å½•ä¸­ä½¿ç”¨ã€‚")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("version: '3.4'\nx-custom:\n  items:\n    - a\n    - b\n  options:\n    max-size: '12m'\n  name: \"custom\"\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br")])]),n("p",[e._v("è¿™äº›å­—æ®µçš„å†…å®¹è¢«Composeå¿½ç•¥ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ "),n("a",{attrs:{href:"http://www.yaml.org/spec/1.2/spec.html#id2765878",target:"_blank",rel:"noopener noreferrer"}},[e._v("YAMLé”šç‚¹"),n("OutboundLink")],1),e._v(" å°†å…¶æ’å…¥èµ„æºå®šä¹‰ä¸­ ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨å¸Œæœ›å¤šä¸ªæœåŠ¡ä½¿ç”¨ç›¸åŒçš„æ—¥å¿—è®°å½•é…ç½®ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("logging:\n  options:\n    max-size: '12m'\n    max-file: '5'\n  driver: json-file\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("p",[e._v("æ‚¨å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼ç¼–å†™Composeæ–‡ä»¶ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("version: '3.4'\nx-logging:\n  &default-logging\n  options:\n    max-size: '12m'\n    max-file: '5'\n  driver: json-file\n\nservices:\n  web:\n    image: myapp/web:latest\n    logging: *default-logging\n  db:\n    image: mysql:latest\n    logging: *default-logging\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br")])]),n("p",[e._v("ä¹Ÿå¯ä»¥ä½¿ç”¨ "),n("a",{attrs:{href:"http://yaml.org/type/merge.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("YAMLåˆå¹¶ç±»å‹"),n("OutboundLink")],1),e._v(" éƒ¨åˆ†è¦†ç›–æ‰©å±•å­—æ®µä¸­çš„å€¼ ã€‚ ä¾‹å¦‚ï¼š")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('version: \'3.4\'\nx-volumes:\n  &default-volume\n  driver: foobar-storage\n\nservices:\n  web:\n    image: myapp/web:latest\n    volumes: ["vol1", "vol2", "vol3"]\nvolumes:\n  vol1: *default-volume\n  vol2:\n    << : *default-volume\n    name: volume02\n  vol3:\n    << : *default-volume\n    driver: default\n    name: volume-local\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br")])]),n("h2",{attrs:{id:"æ’°å†™æ–‡æ¡£-ğŸ”—"}},[e._v("æ’°å†™æ–‡æ¡£ "),n("a",{attrs:{href:"#compose-documentation"}},[e._v("ğŸ”—")])]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://docs.docker.com/compose/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç”¨æˆ·æŒ‡å—"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"https://docs.docker.com/compose/install/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å®‰è£…æ’°å†™"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-versioning/",target:"_blank",rel:"noopener noreferrer"}},[e._v("æ’°å†™æ–‡ä»¶ç‰ˆæœ¬å’Œå‡çº§"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"https://docs.docker.com/samples/",target:"_blank",rel:"noopener noreferrer"}},[e._v("æ ·å“"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"https://docs.docker.com/compose/reference/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å‘½ä»¤è¡Œå‚è€ƒ"),n("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=r.exports}}]);