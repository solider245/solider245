(window.webpackJsonp=window.webpackJsonp||[]).push([[162],{362:function(s,t,a){"use strict";a.r(t);var n=a(25),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#dockerfile命令简介"}},[s._v("Dockerfile命令简介")])]),a("li",[a("a",{attrs:{href:"#第1步-在ubuntu-20-04上安装docker"}},[s._v("第1步\\-在Ubuntu 20.04上安装Docker")])]),a("li",[a("a",{attrs:{href:"#第2步-创建dockerfile和其他配置"}},[s._v("第2步\\-创建Dockerfile和其他配置")])]),a("li",[a("a",{attrs:{href:"#第3步-建立新的自定义并运行新的容器"}},[s._v("第3步\\-建立新的自定义并运行新的容器")])]),a("li",[a("a",{attrs:{href:"#步骤4-测试"}},[s._v("步骤4\\-测试")])])])]),s._v("\nDocker是操作系统级虚拟化，主要用于开发人员和系统管理员。 Docker使在隔离环境中创建和部署应用程序变得更加容易。"),a("p"),s._v(" "),a("p",[s._v("Dockerfile是一个脚本，其中包含命令和指令的集合，这些命令和指令将在Docker环境中按顺序自动执行以构建新的Docker映像。")]),s._v(" "),a("p",[s._v("在本教程中，我们将向您展示如何使用Dockerfile创建自己的Docker映像。 我们将解释与Dockerfile相关的详细信息，以使您能够构建自己的Docker映像。")]),s._v(" "),a("p",[a("strong",[s._v("先决条件")])]),s._v(" "),a("p",[s._v("对于本指南，我们将使用具有1GB RAM，25GB可用磁盘空间和2个CPU的Ubuntu 20.04。 另外，我们将使用Ubuntu 20.04作为基础映像来构建自定义Docker映像。")]),s._v(" "),a("h2",{attrs:{id:"dockerfile命令简介"}},[s._v("Dockerfile命令简介")]),s._v(" "),a("p",[s._v("Dockerfile是一个脚本，其中包含用于构建Docker映像的所有命令。 Dockerfile包含将用于通过“ docker build”命令创建Docker映像的所有指令。")]),s._v(" "),a("p",[s._v("在创建第一个Dockerfile之前，您应该熟悉Dockerfile指令。 在您必须知道的一些Dockerfile指令下面。")]),s._v(" "),a("p",[a("strong",[s._v("从")])]),s._v(" "),a("p",[s._v("设置要创建的新图像的基础图像。 FROM指令将初始化新的构建阶段，并且必须位于Dockerfile的顶部。")]),s._v(" "),a("p",[a("strong",[s._v("标签")])]),s._v(" "),a("p",[s._v("通过此指令，您可以添加有关Docker映像的其他信息，例如版本，描述，维护程序等。LABEL指令是一个键值对，可用于添加多个标签和多行值。")]),s._v(" "),a("p",[a("strong",[s._v("跑")])]),s._v(" "),a("p",[s._v("该指令用于在Docker映像的构建过程中执行命令。 您可以安装Docker映像所需的其他软件包。")]),s._v(" "),a("p",[a("strong",[s._v("加")])]),s._v(" "),a("p",[s._v("ADD指令用于将文件，目录或远程文件从URL复制到Docker映像，从“ src”复制到绝对路径“ dest”。 另外，您可以设置文件的默认所有权。")]),s._v(" "),a("p",[a("strong",[s._v("ENV")])]),s._v(" "),a("p",[s._v("ENV指令用于定义一个环境变量，该环境变量可以在构建阶段使用，也可以内联替换。")]),s._v(" "),a("p",[a("strong",[s._v("CMD")])]),s._v(" "),a("p",[s._v("CMD指令用于定义运行容器时要执行的默认命令。 并且Dockerfile只能包含一个CMD指令，如果有多个CMD，则将运行最后一个CMD指令。")]),s._v(" "),a("p",[a("strong",[s._v("暴露")]),s._v("广告")]),s._v(" "),a("p",[s._v("该指令用于在运行时在特定网络端口上公开容器端口。 公开的默认协议为TCP，但您可以指定TCP还是UDP。")]),s._v(" "),a("p",[a("strong",[s._v("ARG")])]),s._v(" "),a("p",[s._v("ARG指令用于定义用户可以在构建时传递的变量。 您可以在构建期间使用'--build-arg variable = value'选项在docker'build command'中使用此指令，并且可以通过Dockerfile进行传递。 另外，您可以在Dockerfile上使用多个ARG。")]),s._v(" "),a("p",[a("strong",[s._v("入口点")])]),s._v(" "),a("p",[s._v("ENTRYPOINT指令用于定义容器运行时将执行的第一个和默认命令。 定义命令以使用ENTRYPOINT指令启动您的应用程序。 广告")]),s._v(" "),a("p",[a("strong",[s._v("工作目录")])]),s._v(" "),a("p",[s._v("WORKDIR指令用于定义Docker映像的默认工作目录。 RUN，CMD，ENTRYPOINT和ADD指令遵循WORKDIR指令。 您可以在Dockerfile上添加多个WORKDIR指令，如果该指令不存在，它将自动创建。")]),s._v(" "),a("p",[a("strong",[s._v("用户")])]),s._v(" "),a("p",[s._v("USER指令用于定义运行映像时的默认用户或gid。 RUN，CMD和ENTRYPOINT遵循Dockerfile中的USER指令。")]),s._v(" "),a("p",[a("strong",[s._v("卷")])]),s._v(" "),a("p",[s._v("VOLUME指令广告，用于启用容器和主机之间的访问/链接目录。")]),s._v(" "),a("p",[s._v("现在，让我们开始创建第一个Dockerfile。")]),s._v(" "),a("h2",{attrs:{id:"第1步-在ubuntu-20-04上安装docker"}},[s._v("第1步-在Ubuntu 20.04上安装Docker")]),s._v(" "),a("p",[s._v("在创建Dockerfile之前，我们将Docker安装到我们的Ubuntu 20.04系统上，该系统默认在Ubuntu FocalFossa存储库中可用。")]),s._v(" "),a("p",[s._v("更新Ubuntu存储库中的所有软件包列表，并使用以下apt命令安装Docker。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo apt updatesudo apt install docker.io\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("完成所有安装后，启动Docker服务并将其添加到系统引导中。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("systemctl start dockersystemctl enable docker\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("现在，使用以下命令检查Docker服务。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("systemctl status docker\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("Docker服务已在Ubuntu 20.04上启动并运行。")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/big/1.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/1.png?ezimgfmt=rs:750x216/rscb1/ng:webp/ngcb1",alt:"启动Docker服务"}}),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("接下来，运行以下docker命令以确保安装正确。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker run hello-world\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("以下是您将获得的结果。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('Hello from Docker!This message shows that your installation appears to be working correctly.To generate this message, Docker took the following steps: 1. The Docker client contacted the Docker daemon. 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.    (amd64) 3. The Docker daemon created a new container from that image which runs the    executable that produces the output you are currently reading. 4. The Docker daemon streamed that output to the Docker client, which sent it    to your terminal.To try something more ambitious, you can run an Ubuntu container with: $ docker run -it ubuntu bashShare images, automate workflows, and more with a free Docker ID: https://hub.docker.com/For more examples and ideas, visit: https://docs.docker.com/get-started/\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("可以看到，您从Docker收到Hello World消息，并且在Ubuntu 20.04上的Docker安装已成功完成。")]),s._v(" "),a("h2",{attrs:{id:"第2步-创建dockerfile和其他配置"}},[s._v("第2步-创建Dockerfile和其他配置")]),s._v(" "),a("p",[s._v("在这一步中，我们将向您展示如何使用Dockerfile为您的应用程序构建自定义Docker映像。 我们将基于Ubuntu 20.04映像为PHP-FPM和Nginx服务创建一个新的自定义Docker映像，然后使用简单的phpinfo脚本运行新容器。")]),s._v(" "),a("p",[s._v("首先，创建一个新的项目目录并创建一个空的Dockerfile。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mkdir -p nginx-image; cd nginx-image/touch Dockerfile\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("现在使用您自己的编辑器编辑“ Dockerfile”脚本（在本示例中，我们使用vim）。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vim Dockerfile\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("在该行的顶部，使用FROM指令添加基本映像Ubuntu 20.04映像，如下所示。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#Download base image ubuntu 20.04\nFROM ubuntu:20.04\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("现在，使用LABEL指令添加有关自定义图像的详细信息。")]),s._v(" "),a("div",{staticClass:"language-docker line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-docker"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# LABEL about the custom image")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v(" maintainer="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin@sysadminjournal.com"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v(" version="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.1"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v(" description="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"This is custom Docker Image for \\\nthe PHP-FPM and Nginx Services."')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("对于apt软件包安装，我们将使用环境变量'DEBIAN_FRONTEND = noninteractive'跳过任何交互式的安装后步骤。")]),s._v(" "),a("div",{staticClass:"language-docker line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-docker"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Disable Prompt During Packages Installation")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ARG")]),s._v(" DEBIAN_FRONTEND=noninteractive\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ARG")]),s._v(" DEBIAN_FRONTEND=noninteractive\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("接下来，在安装任何软件包之前运行“ apt update”命令。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update Ubuntu Software repository")]),s._v("\nRUN "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("现在安装Nginx，PHP-FPM和超级用户软件包。 完成所有安装后，请删除所有程序包缓存以减小自定义映像的大小。")]),s._v(" "),a("div",{staticClass:"language-docker line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-docker"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Install nginx, php-fpm and supervisord from ubuntu repository")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" apt install "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("y nginx php"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("fpm supervisor && \\\n    rm "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("rf /var/lib/apt/lists/* && \\\n    apt clean\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("定义可以在自定义映像上传递的新环境变量。")]),s._v(" "),a("div",{staticClass:"language-docker line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-docker"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Define the ENV variable")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" nginx_vhost /etc/nginx/sites"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("available/default\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" php_conf /etc/php/7.4/fpm/php.ini\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" nginx_conf /etc/nginx/nginx.conf\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" supervisor_conf /etc/supervisor/supervisord.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("现在将Nginx默认配置复制到'nginx_vhost'变量，将php.ini配置文件中的PHP配置'cgi.fix_pathinfo = 1'替换为'cgi.fix_pathinfo = 0'，然后将'daemon off'选项添加到默认的“ nginx_conf”变量。")]),s._v(" "),a("div",{staticClass:"language-docker line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-docker"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Enable PHP-fpm on nginx virtualhost configuration")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" default $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("nginx_vhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" sed "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("i "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("e "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/g'")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("php_conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" && \\\n    echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\ndaemon off;"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("nginx_conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("将定制的监管配置复制到“ supervisor_conf”变量。")]),s._v(" "),a("div",{staticClass:"language-docker line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-docker"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Copy supervisor configuration")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" supervisord.conf $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("supervisor_conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("为PHP-FPM sock文件创建一个新目录，将Web根目录“ / var / www / html”和PHP-FPM目录“ / run / php”的所有权更改为默认用户“ www-data”。")]),s._v(" "),a("div",{staticClass:"language-docker line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-docker"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" mkdir "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("p /run/php && \\\n    chown "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("R www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("data /var/www/html && \\\n    chown "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("R www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("data /run/php\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("定义自定义映像的卷，以便我们可以将所有这些目录挂载到主机上。")]),s._v(" "),a("div",{staticClass:"language-docker line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-docker"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Volume configuration")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VOLUME")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/nginx/sites-enabled"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/nginx/certs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/nginx/conf.d"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/log/nginx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/www/html"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("现在添加“ start.sh”脚本，并使用CMD指令定义默认的容器命令，如下所示。")]),s._v(" "),a("div",{staticClass:"language-docker line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-docker"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Copy start.sh script and define default command for the container")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" start.sh /start.sh\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./start.sh"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("最后，使用EXPOSE指令打开容器上的默认HTTP和HTTPS端口。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# Expose Port for the Application EXPOSE 80 443\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("保存并关闭。 广告")]),s._v(" "),a("p",[s._v("以下是我们刚刚创建的完整Dockerfile脚本。")]),s._v(" "),a("div",{staticClass:"language-docker line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-docker"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Download base image ubuntu 20.04")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" ubuntu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("20.04\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# LABEL about the custom image")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v(" maintainer="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin@sysadminjournal.com"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v(" version="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.1"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v(" description="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"This is custom Docker Image for \\\nthe PHP-FPM and Nginx Services."')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Disable Prompt During Packages Installation")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ARG")]),s._v(" DEBIAN_FRONTEND=noninteractive\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Update Ubuntu Software repository")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" apt update\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Install nginx, php-fpm and supervisord from ubuntu repository")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" apt install "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("y nginx php"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("fpm supervisor && \\\n    rm "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("rf /var/lib/apt/lists/* && \\\n    apt clean\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Define the ENV variable")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" nginx_vhost /etc/nginx/sites"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("available/default\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" php_conf /etc/php/7.4/fpm/php.ini\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" nginx_conf /etc/nginx/nginx.conf\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" supervisor_conf /etc/supervisor/supervisord.conf\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Enable PHP-fpm on nginx virtualhost configuration")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" default $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("nginx_vhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" sed "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("i "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("e "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/g'")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("php_conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" && \\\n    echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\ndaemon off;"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("nginx_conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Copy supervisor configuration")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" supervisord.conf $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("supervisor_conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" mkdir "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("p /run/php && \\\n    chown "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("R www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("data /var/www/html && \\\n    chown "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("R www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("data /run/php\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Volume configuration")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VOLUME")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/nginx/sites-enabled"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/nginx/certs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/nginx/conf.d"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/log/nginx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/www/html"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Copy start.sh script and define default command for the container")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" start.sh /start.sh\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./start.sh"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Expose Port for the Application ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 80 443\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br")])]),a("p",[s._v("接下来，我们将为Nginx，supervisor和start.sh脚本创建一个新的附加配置。")]),s._v(" "),a("p",[s._v("“默认” Nginx虚拟主机配置将包含PHP-FPM的部分。 实际上，您可以使用“自定义”映像运行PHP脚本，而无需进行任何更改。")]),s._v(" "),a("p",[s._v("使用编辑器创建一个新的Nginx“默认”虚拟主机配置。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vim default\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("将以下配置粘贴到其中。")]),s._v(" "),a("div",{staticClass:"language-vim line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vim"}},[a("code",[s._v("server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" default_server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n \n    root "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    index index"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("html index"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("htm index"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("debian"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n \n    server_name _"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n \n    location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        try_files $uri $uri"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n \n    location ~ \\"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("php$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("include")]),s._v(" snippets"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("fastcgi"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("conf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        fastcgi_pass unix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("run"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("php7"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("fpm"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("sock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("保存并关闭。")]),s._v(" "),a("p",[s._v("接下来，我们将创建“ supervisrod.conf”配置，其中包含将自动运行的Nginx和PHP-FPM程序。")]),s._v(" "),a("p",[s._v("使用编辑器创建“ supervisrod.conf”文件。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vim supervisord.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("将以下配置粘贴到其中。")]),s._v(" "),a("div",{staticClass:"language-vim line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vim"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("unix_http_server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("file")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dev"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("shm")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("supervisor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("sock   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("the "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("path")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" the socket "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("supervisord"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nlogfile"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("supervisord"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("log "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main log "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("default $CWD"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("supervisord"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlogfile_maxbytes"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("50MB        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("max main logfile bytes b4 rotation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("default 50MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlogfile_backups"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("           "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num of main logfile rotation backups"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("default "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nloglevel"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("info                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("log level"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("default info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" others"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("debug")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("warn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("trace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\npidfile"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tmp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("supervisord"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("supervisord pidfile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("default supervisord"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("pid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nnodaemon"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false               "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("start "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" foreground "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("default false"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nminfds"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v("                  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("min"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v(" avail startup "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("file")]),s._v(" descriptors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("default "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nminprocs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v("                 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("min"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v(" avail process descriptors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("default "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nuser"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root             "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("rpcinterface"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("supervisor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nsupervisor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("rpcinterface_factory "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" supervisor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("rpcinterface"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("make_main_rpcinterface\n \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("supervisorctl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nserverurl"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("unix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dev"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("shm")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("supervisor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("sock "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" use a unix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" URL  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" a unix socket\n \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("include")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("files")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("supervisor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("conf")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("d")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("conf")]),s._v("\n \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("program"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("fpm7"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ncommand"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("fpm7"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("F\nnumprocs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nautostart"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\nautorestart"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("program"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ncommand"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx\nnumprocs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nautostart"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\nautorestart"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br")])]),a("p",[s._v("保存并关闭。")]),s._v(" "),a("p",[s._v("现在，使用t = your编辑器创建“ start.sh”脚本，该脚本将包含启动的监管命令。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vim start.sh\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("将以下配置粘贴到其中。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n/usr/bin/supervisord -n -c /etc/supervisor/supervisord.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("保存并关闭。")]),s._v(" "),a("p",[s._v("使“ start.sh”脚本可执行。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("chmod +x start.sh\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("结果，已经创建了自定义Docker映像的所有配置，以下是我们创建的所有配置。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("tree .\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("现在，我们准备基于这些配置创建一个新的自定义映像。")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/big/2.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/2.png?ezimgfmt=rs:662x211/rscb1/ng:webp/ngcb1",alt:"检查Docker服务状态"}}),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"第3步-建立新的自定义并运行新的容器"}},[s._v("第3步-建立新的自定义并运行新的容器")]),s._v(" "),a("p",[s._v("要创建Docker自定义映像，请转到项目目录“ nginx-image”，然后运行“ docker build”命令，如下所示。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker build -t nginx-image .\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("该命令将下载基本映像Ubuntu 20.04，并创建一个名为'nginx-image的新自定义映像。")]),s._v(" "),a("p",[s._v("完成所有过程后，使用以下命令检查系统上可用的Docker映像列表。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker image ls\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("以下是您将获得的结果。")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/big/3.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/3.png?ezimgfmt=rs:750x157/rscb1/ng:webp/ngcb1",alt:"检查Docker映像"}}),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("可以看出，已经创建了新的自定义Docker映像'nginx-image'。")]),s._v(" "),a("p",[s._v("接下来，我们将基于'nginx-image'运行新的Docker容器。")]),s._v(" "),a("p",[s._v("在本地计算机上，创建一个名为“ webroot”的新目录，该目录将用于存储所有Web文件。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mkdir -p /webroot\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("现在，使用下面的docker run命令创建一个名为test-container的新容器。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker run -d -v /webroot:/var/www/html -p 8080:80 --name test-container nginx-image\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("注意：")])]),s._v(" "),a("ul",[a("li",[s._v("--name test-container nginx-image =我们基于docker image'nginx-image'创建一个名称为'test-container'的新容器。")]),s._v(" "),a("li",[s._v("-p 8080：80 =在主机上的端口8080上运行的测试容器容器。")]),s._v(" "),a("li",[s._v("-v / webroot：/ var / www / html =主机上的/ webroot目录重写容器上的/ var / www / html目录。")])]),s._v(" "),a("p",[s._v("之后，使用以下命令检查系统上所有正在运行的容器。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker ps\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("以下是您将获得的结果。")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/big/4.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/4.png?ezimgfmt=rs:750x144/rscb1/ng:webp/ngcb1",alt:"检查正在运行的容器"}}),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("结果，基于“ nginx-image”并暴露端口8080的名为“ test-container”的新容器已启动并正在运行。")]),s._v(" "),a("h2",{attrs:{id:"步骤4-测试"}},[s._v("步骤4-测试")]),s._v(" "),a("p",[s._v("为了确保容器正常运行，我们将在主机的'/ webroot'根目录上创建一个新的index.html和phpinfo文件。 因为“ / webroot”目录已装入容器目录“ / var / www / html”。")]),s._v(" "),a("p",[s._v("使用以下命令在“ / webroot”目录上创建index.html文件。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'<h1>Nginx and PHP-FPM 7.4 inside Docker Container with Ubuntu 20.04 Base Image</h1>'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /webroot/index.html\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("现在，使用端口8080上的curl命令测试访问您的容器。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" server-ip:8080\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -I server-ip:8080\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("结果，您将获得我们刚刚创建的默认index.html页面。")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/big/5.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/5.png?ezimgfmt=rs:750x222/rscb1/ng:webp/ngcb1",alt:"创建index.html页面"}}),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("接下来，在“ / webroot”目录上创建一个新的PHP文件“ info.php”，以确保PHP-FPM服务正在运行。")]),s._v(" "),a("p",[s._v("使用以下命令创建“ info.php”文件。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'<?php phpinfo(); ?>'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /webroot/info.php\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("接下来，打开您的Web浏览器并在端口“ 8080”后键入“ info.php”文件的路径，输入服务器IP地址。")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://server-ip:8080/info.php",target:"_blank",rel:"noopener noreferrer"}},[s._v("http：// server-ip：8080 / info.php"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("现在，您将获得如下所示的phpinfo页面。")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/big/6.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/6.png?ezimgfmt=rs:750x436/rscb1/ng:webp/ngcb1",alt:"phpinfo"}}),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("可以看出，“ test-container”已成功加载PHP脚本。")]),s._v(" "),a("p",[s._v("结果，我们成功创建了一个新的自定义Docker映像，并基于该映像运行了任何错误的新容器。")]),s._v(" "),a("p",[a("strong",[s._v("关于穆罕默德·阿鲁尔")])]),s._v(" "),a("p",[s._v("Muhammad Arul是一名自由系统管理员和技术作家。 他在Linux环境领域工作了5年以上，他是一名开源爱好者，并且对Linux安装和故障排除充满了热情。 通常与RedHat / CentOS Linux和Ubuntu / Debian，Nginx和Apache Web服务器，Proxmox，Zimbra管理和网站优化一起使用。 当前正在学习OpenStack和容器技术。")])])}),[],!1,null,null,null);t.default=e.exports}}]);